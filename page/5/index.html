<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="ZeroJi&#39;s Blog">
<meta property="og:url" content="http://yoursite.com/page/5/index.html">
<meta property="og:site_name" content="ZeroJi&#39;s Blog">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ZeroJi&#39;s Blog">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/5/"/>





  <title>ZeroJi's Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ZeroJi's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/03/04/iOS进阶（六）网络请求/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZeroJi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZeroJi's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/03/04/iOS进阶（六）网络请求/" itemprop="url">iOS进阶（六）网络请求</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-03-04T09:30:00+08:00">
                2016-03-04
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-04-28T17:01:40+08:00">
                2018-04-28
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="HTTP和HTTPS协议"><a href="#HTTP和HTTPS协议" class="headerlink" title="HTTP和HTTPS协议"></a>HTTP和HTTPS协议</h2><ul>
<li><code>HTTP</code>协议，超文本传输协议，是用于从<code>www</code>服务器传送超文本到本地浏览器的传输协议。</li>
<li><code>HTTPS</code>协议，安全超文本传输协议，是一个安全通信通道。使用安全套接字层（<code>SSL</code>）进行信息交换，即使用<code>SSL</code>在发送方把<em>原始数据加密</em>，然后由接受方解密。</li>
</ul>
<h2 id="GET和POST请求"><a href="#GET和POST请求" class="headerlink" title="GET和POST请求"></a>GET和POST请求</h2><p>不同点:</p>
<ol>
<li><p>给<em>服务器传输数据</em>的方式不同:</p>
<ul>
<li>GET：通过网址字符串</li>
<li>POST：通过NSData</li>
</ul>
</li>
<li><p>传输<em>数据的大小</em>：</p>
<ul>
<li>GET：地址字符串最多<code>255</code>字节</li>
<li>POST：使用NSData，容量超过1G</li>
</ul>
</li>
<li><p>安全性：</p>
<ul>
<li>GET：所有传输给服务器的数据，现实在网址里面，类似于密码的明文输入，直接可见。</li>
<li>POST：数据被转成NSData（二进制数据），类似于密码的密文输入，无法直接读取。</li>
</ul>
</li>
</ol>
<p>为了使App能接受网络数据，需要修改info.plist文件。</p>
<p>在其中添加<code>App Transport Security Settings</code>字典，在字典中添加<code>Allow Arbitrary Loads</code>,设置值为<code>YES</code>。</p>
<h2 id="同步与异步连接"><a href="#同步与异步连接" class="headerlink" title="同步与异步连接"></a>同步与异步连接</h2><ul>
<li>同步连接：程序容易出现卡死现象。</li>
<li>异步链接：等待数据返回。</li>
<li><p>异步链接有两种实现方式：</p>
<ol>
<li>设置代理，接受数据</li>
<li>实现block</li>
</ol>
</li>
</ul>
<h2 id="同步GET"><a href="#同步GET" class="headerlink" title="同步GET"></a>同步GET</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建网址连接字符串</span></span><br><span class="line"><span class="built_in">NSString</span> *urlStr = <span class="string">@"http://ipad-bjwb.bjd.com.cn/DigitalPublication/publish/Handler/APINewsList.ashx?date=20131129&amp;startRecord=1&amp;len=5&amp;udid=1234567890&amp;terminalType=Iphone&amp;cid=213"</span>;</span><br><span class="line"><span class="comment">// 创建一个保存连接字符串的NSURL对象</span></span><br><span class="line"><span class="built_in">NSURL</span> *url = [<span class="built_in">NSURL</span> URLWithString:urlStr];</span><br><span class="line"><span class="comment">// 创建网络请求对象</span></span><br><span class="line"><span class="built_in">NSURLRequest</span> *request = [[<span class="built_in">NSURLRequest</span> alloc] initWithURL:url cachePolicy: <span class="built_in">NSURLRequestUseProtocolCachePolicy</span> timeoutInterval:<span class="number">10</span>];</span><br><span class="line"><span class="comment">// 网络链接，讲创建好的网络请求发送给服务器</span></span><br><span class="line"><span class="built_in">NSData</span> *urlData = [<span class="built_in">NSURLConnection</span> sendSynchronousRequest:request returnningResponse:<span class="literal">nil</span> error:<span class="literal">nil</span>];</span><br></pre></td></tr></table></figure>
<p><code>urlData</code>就是获取的数据，用<code>NSJSONSerialization</code>就可以解析。</p>
<h2 id="同步POST"><a href="#同步POST" class="headerlink" title="同步POST"></a>同步POST</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个网络连接字符串</span></span><br><span class="line"><span class="built_in">NSString</span> *urlStr = <span class="string">@"http://ipad-bjwb.bjd.com.cn/DigitalPublication/publish/Handler/APINewsList.ashx?date=20131129&amp;startRecord=1&amp;len=5&amp;udid=1234567890&amp;terminalType=Iphone&amp;cid=213"</span>;</span><br><span class="line"><span class="comment">// 创建一个NSURL对象，保存网络连接字符串</span></span><br><span class="line"><span class="built_in">NSURL</span> *url = [<span class="built_in">NSURL</span> URLWithString:urlStr];</span><br><span class="line"><span class="comment">// 创建网络请求</span></span><br><span class="line"><span class="comment">// 因为NSURLRequest这个类，默认请求方式是GET请求，如果需要POST请求，只能使用NSMutableURLRequest来创建POST请求</span></span><br><span class="line"><span class="built_in">NSMutableURLRequest</span> *mRequest = [<span class="built_in">NSMutableURLRequest</span> requestWithURL:url];</span><br><span class="line"><span class="comment">// 指定请求方式</span></span><br><span class="line">[mRequest setHTTPMethod:<span class="string">@"POST"</span>];</span><br><span class="line">[mRequest setHTTPBody:[<span class="string">@"date=20131129&amp;startRecord=1&amp;len=5&amp;udid=1234567890&amp;terminalType=Iphone&amp;cid=213"</span> dataUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>]];</span><br><span class="line"><span class="comment">// 发送请求</span></span><br><span class="line"><span class="built_in">NSData</span> *urlData = [<span class="built_in">NSURLConnection</span> sendSynchronousRequest:mRequest returningResponse:<span class="literal">nil</span> error:<span class="literal">nil</span>];</span><br></pre></td></tr></table></figure>
<p><code>setHTTPBody:</code>方法，设置请求需要的参数。</p>
<h2 id="异步代理GET"><a href="#异步代理GET" class="headerlink" title="异步代理GET"></a>异步代理GET</h2><p>首先，设置代理并和服务端进行连接。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建网址链接字符串</span></span><br><span class="line"><span class="built_in">NSString</span> *urlStr = <span class="string">@"http://ipad-bjwb.bjd.com.cn/DigitalPublication/publish/Handler/APINewsList.ashx?date=20131129&amp;startRecord=1&amp;len=5&amp;udid=1234567890&amp;terminalType=Iphone&amp;cid=213"</span>;</span><br><span class="line"><span class="comment">// 创建一个保存网址链接字符串的NSURL对象</span></span><br><span class="line"><span class="built_in">NSURL</span> *url = [<span class="built_in">NSURL</span> URLWithString:urlStr];</span><br><span class="line"><span class="comment">// 创建网络请求对象</span></span><br><span class="line"><span class="built_in">NSURLRequest</span> *request = [[<span class="built_in">NSURLRequest</span> alloc] initWithURL:url cachePolicy:<span class="built_in">NSURLRequestUseProtocolCachePolicy</span> timeoutInterval:<span class="number">10</span>];</span><br><span class="line"><span class="comment">// 1.异步代理</span></span><br><span class="line">[<span class="built_in">NSURLConnection</span> connectionWithRequest:request delegate:<span class="keyword">self</span>];</span><br><span class="line"><span class="comment">// 2.</span></span><br><span class="line"><span class="comment">//NSURLConnection *connection = [[NSURLConnection alloc] initWithRequest:request delegate:self];</span></span><br><span class="line"><span class="comment">//[connection start];</span></span><br></pre></td></tr></table></figure>
<p>接受代理<code>NSURLConnectionDataDelegate</code>后，执行代理方法。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 服务器接收到请求之后，会给你做出回应，这个方法的执行，代表请求过程开始。</span></span><br><span class="line">- (<span class="keyword">void</span>)connection:(<span class="built_in">NSURLConnection</span> *)connection didReceiveResponse:(<span class="built_in">NSURLResponse</span> *)response</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%s, %d"</span>, __FUNCTION__, __LINE__);</span><br><span class="line">    <span class="comment">// 在接受数据之前，容器一定要进行初始化。</span></span><br><span class="line">    <span class="comment">// 我选择懒加载</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当接受数据时执行</span></span><br><span class="line">- (<span class="keyword">void</span>)connection:(<span class="built_in">NSURLConnection</span> *)connection didReceiveData:(<span class="built_in">NSData</span> *)data</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%s, %d"</span>, __FUNCTION__, __LINE__);</span><br><span class="line">    <span class="comment">// 拼接数据</span></span><br><span class="line">    [<span class="keyword">self</span>.mData appendData:data];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当数据接受完毕时执行</span></span><br><span class="line">- (<span class="keyword">void</span>)connectionDidFinishLoading:(<span class="built_in">NSURLConnection</span> *)connection</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%s, %d"</span>, __FUNCTION__, __LINE__);</span><br><span class="line">    <span class="built_in">NSDictionary</span> *dic = [<span class="built_in">NSJSONSerialization</span> JSONObjectWithData:<span class="keyword">self</span>.mData options:<span class="built_in">NSJSONReadingMutableContainers</span> | <span class="built_in">NSJSONReadingMutableLeaves</span> error:<span class="literal">nil</span>];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, dic);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当出现错误时执行</span></span><br><span class="line">- (<span class="keyword">void</span>)connection:(<span class="built_in">NSURLConnection</span> *)connection didFailWithError:(<span class="built_in">NSError</span> *)error</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="异步Block-POST请求"><a href="#异步Block-POST请求" class="headerlink" title="异步Block POST请求"></a>异步Block POST请求</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个网址链接字符串</span></span><br><span class="line"><span class="built_in">NSString</span> *urlStr = <span class="string">@"http://ipad-bjwb.bjd.com.cn/DigitalPublication/publish/Handler/APINewsList.ashx"</span>;</span><br><span class="line"><span class="comment">// 创建一个NSURL对象，保存网址链接字符串</span></span><br><span class="line"><span class="built_in">NSURL</span> *url = [<span class="built_in">NSURL</span> URLWithString:urlStr];</span><br><span class="line"><span class="comment">// 创建网络请求</span></span><br><span class="line"><span class="comment">// 因为NSURLRequest这个类，默认请求方式是GET请求，如果我们执行请求方式为POST，只能使用NSMutableURLRequest来创建POST请求</span></span><br><span class="line"><span class="built_in">NSMutableURLRequest</span> *mRequest = [<span class="built_in">NSMutableURLRequest</span> requestWithURL:url];</span><br><span class="line"><span class="comment">// 指定请求方式</span></span><br><span class="line">[mRequest setHTTPMethod:<span class="string">@"POST"</span>];</span><br><span class="line">[mRequest setHTTPBody:[<span class="string">@"date=20131129&amp;startRecord=1&amp;len=5&amp;udid=1234567890&amp;terminalType=Iphone&amp;cid=213"</span> dataUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>]];</span><br><span class="line"><span class="comment">// 发送请求</span></span><br><span class="line">[<span class="built_in">NSURLConnection</span> sendAsynchronousRequest:mRequest queue:[<span class="built_in">NSOperationQueue</span> mainQueue]  completionHandler:^(<span class="built_in">NSURLResponse</span> * _Nullable response, <span class="built_in">NSData</span> * _Nullable data, <span class="built_in">NSError</span> * _Nullable connectionError) &#123;</span><br><span class="line"><span class="comment">// 解析</span></span><br><span class="line"><span class="built_in">NSDictionary</span> *dic = [<span class="built_in">NSJSONSerialization</span> JSONObjectWithData:data options:<span class="built_in">NSJSONReadingMutableContainers</span> :call &lt;SNR&gt;<span class="number">118</span>_align()</span><br><span class="line">a <span class="built_in">NSJSONReadingMutableLeaves</span> error:<span class="literal">nil</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, dic);</span><br></pre></td></tr></table></figure>
<blockquote>
<p>以上的方法在iOS9.0之后被废弃，转用NSURLSession类。<code>NSURLSession</code>是高度异步的，所以不存在同步请求。</p>
</blockquote>
<h2 id="NSURLSession-Block异步请求"><a href="#NSURLSession-Block异步请求" class="headerlink" title="NSURLSession Block异步请求"></a>NSURLSession Block异步请求</h2><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个NSURLSession对象</span></span><br><span class="line"><span class="built_in">NSURLSession</span> *session = [<span class="built_in">NSURLSession</span> sharedSession];</span><br><span class="line"><span class="comment">// 创建一个NSURL对象</span></span><br><span class="line"><span class="built_in">NSURL</span> *url = [<span class="built_in">NSURL</span> URLWithString:<span class="string">@"http://ipad-bjwb.bjd.com.cn/DigitalPublication/publish/Handler/APINewsList.ashx?date=20131129&amp;startRecord=1&amp;len=5&amp;udid=1234567890&amp;terminalType=Iphone&amp;cid=213"</span>];</span><br><span class="line"><span class="comment">// NSURLSessionDownloadTask 下载任务</span></span><br><span class="line"><span class="comment">// NSURLSessionUploadTask 上传任务</span></span><br><span class="line"><span class="comment">// NSURLSessionDataTask 获取数据</span></span><br><span class="line"><span class="built_in">NSURLSessionDataTask</span> *dataTask = [session dataTaskWithURL:url completionHandler:^(<span class="built_in">NSData</span> * _Nullable data, <span class="built_in">NSURLResponse</span> * _Nullable response, <span class="built_in">NSError</span> * _Nullable error) &#123;</span><br><span class="line"><span class="comment">// 解析</span></span><br><span class="line">    <span class="built_in">NSDictionary</span> *dic = [<span class="built_in">NSJSONSerialization</span> JSONObjectWithData:data options:<span class="built_in">NSJSONReadingMutableContainers</span> | <span class="built_in">NSJSONReadingMutableLeaves</span> error:<span class="literal">nil</span>];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, dic);</span><br><span class="line">&#125;];</span><br><span class="line"><span class="comment">// 不管什么任务，创建之后，需要执行开始操作。</span></span><br><span class="line">[dataTask resume];</span><br></pre></td></tr></table></figure>
<h2 id="NSURLSession-代理异步请求"><a href="#NSURLSession-代理异步请求" class="headerlink" title="NSURLSession 代理异步请求"></a>NSURLSession 代理异步请求</h2><p>首先，接受代理并且执行请求。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSURLSession</span> *session = [<span class="built_in">NSURLSession</span> sessionWithConfiguration:[<span class="built_in">NSURLSessionConfiguration</span> defaultSessionConfiguration] delegate:<span class="keyword">self</span> delegateQueue:[<span class="built_in">NSOperationQueue</span> mainQueue]];</span><br><span class="line"><span class="built_in">NSURLSessionDataTask</span> *dataTast = [session dataTaskWithURL:[<span class="built_in">NSURL</span> URLWithString:<span class="string">@"http://ipad-bjwb.bjd.com.cn/DigitalPublication/publish/Handler/APINewsList.ashx?date=20131129&amp;startRecord=1&amp;len=5&amp;udid=1234567890&amp;terminalType=Iphone&amp;cid=213"</span>]];</span><br><span class="line">[dataTast resume];</span><br></pre></td></tr></table></figure>
<p>然后接受<code>NSURLSessionDataDelegate</code>代理并且执行方法。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 响应开始，服务器接收到请求之后执行这个方法。</span></span><br><span class="line">- (<span class="keyword">void</span>)URLSession:(<span class="built_in">NSURLSession</span> *)session dataTask:(<span class="built_in">NSURLSessionDataTask</span> *)dataTask didReceiveResponse:(<span class="built_in">NSURLResponse</span> *)response completionHandler:(<span class="keyword">void</span> (^)(<span class="built_in">NSURLSessionResponseDisposition</span>))completionHandler</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%s %d"</span>, __FUNCTION__, __LINE__);</span><br><span class="line">    completionHandler(<span class="built_in">NSURLSessionResponseAllow</span>);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 接收数据的方法</span></span><br><span class="line">- (<span class="keyword">void</span>)URLSession:(<span class="built_in">NSURLSession</span> *)session dataTask:(<span class="built_in">NSURLSessionDataTask</span> *)dataTask didReceiveData:(<span class="built_in">NSData</span> *)data</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%s %d"</span>, __FUNCTION__, __LINE__);</span><br><span class="line">    [<span class="keyword">self</span>.mData appendData:data];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 请求结束，数据获取完毕的方法。</span></span><br><span class="line">- (<span class="keyword">void</span>)URLSession:(<span class="built_in">NSURLSession</span> *)session task:(<span class="built_in">NSURLSessionTask</span> *)task didCompleteWithError:(<span class="built_in">NSError</span> *)error</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%s %d"</span>, __FUNCTION__, __LINE__);</span><br><span class="line">    <span class="built_in">NSDictionary</span> *dic = [<span class="built_in">NSJSONSerialization</span> JSONObjectWithData:<span class="keyword">self</span>.mData options:<span class="built_in">NSJSONReadingMutableContainers</span> :call &lt;SNR&gt;<span class="number">118</span>_align()</span><br><span class="line">    a <span class="built_in">NSJSONReadingMutableLeaves</span> error:<span class="literal">nil</span>];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, dic);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/03/03/Swift（四）控制流/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZeroJi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZeroJi's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/03/03/Swift（四）控制流/" itemprop="url">Switf（四）控制流</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-03-03T13:00:00+08:00">
                2016-03-03
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-04-28T17:03:20+08:00">
                2018-04-28
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="for-in-循环"><a href="#for-in-循环" class="headerlink" title="for-in 循环"></a>for-in 循环</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> <span class="number">1</span>...<span class="number">5</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"\(index) times 5 is \(index * 5)"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> base = <span class="number">3</span></span><br><span class="line"><span class="keyword">let</span> power = <span class="number">10</span></span><br><span class="line"><span class="keyword">var</span> answer = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> <span class="number">_</span> <span class="keyword">in</span> <span class="number">1</span>...power &#123;</span><br><span class="line">    answer *= base</span><br><span class="line">    <span class="built_in">print</span>(answer)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> names = [<span class="string">"Anna"</span>, <span class="string">"Alex"</span>, <span class="string">"Brian"</span>, <span class="string">"Jack"</span>]</span><br><span class="line"><span class="keyword">for</span> name <span class="keyword">in</span> names &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Hello, \(name)"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> numberOfLegs = [<span class="string">"spider"</span>: <span class="number">8</span>, <span class="string">"ant"</span>: <span class="number">6</span>, <span class="string">"cat"</span>: <span class="number">4</span>]</span><br><span class="line"><span class="keyword">for</span> (animalName, legCount) <span class="keyword">in</span> numberOfLegs &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"\(animalName)s have \(legCount) legs"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="for-循环"><a href="#for-循环" class="headerlink" title="for 循环"></a>for 循环</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="keyword">var</span> index = <span class="number">0</span>; index &lt; <span class="number">3</span>; index++ &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"index is \(index)"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="while-循环"><a href="#while-循环" class="headerlink" title="while 循环"></a>while 循环</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="built_in">max</span> = <span class="number">10</span></span><br><span class="line"><span class="keyword">var</span> value1 = <span class="number">1</span></span><br><span class="line"><span class="keyword">while</span> value1 &lt; <span class="built_in">max</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(value1)</span><br><span class="line">    value1++</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Repeat-While"><a href="#Repeat-While" class="headerlink" title="Repeat-While"></a>Repeat-While</h2><p>先执行一次while中的语句，再判断。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> value2 = <span class="number">1</span></span><br><span class="line"><span class="keyword">repeat</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(value2)</span><br><span class="line">    value2++</span><br><span class="line">&#125; <span class="keyword">while</span> value2 &lt; <span class="built_in">max</span></span><br></pre></td></tr></table></figure>
<h2 id="if"><a href="#if" class="headerlink" title="if"></a>if</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> value3 = <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> value3 &lt; <span class="number">2</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"\(value3) &lt; 2"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="switch"><a href="#switch" class="headerlink" title="switch"></a>switch</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> someCharacter: <span class="type">Character</span> = <span class="string">"e"</span></span><br><span class="line"><span class="keyword">switch</span> someCharacter &#123; <span class="comment">// case 后的语句执行完成后不必要执行break来跳出，程序会自动跳出。</span></span><br><span class="line"><span class="keyword">case</span> <span class="string">"a"</span>, <span class="string">"e"</span>, <span class="string">"i"</span>, <span class="string">"o"</span>, <span class="string">"u"</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"\(someCharacter) is a vowel"</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="string">"b"</span>, <span class="string">"c"</span>, <span class="string">"d"</span>, <span class="string">"f"</span>, <span class="string">"g"</span>, <span class="string">"h"</span>, <span class="string">"j"</span>, <span class="string">"k"</span>, <span class="string">"l"</span>, <span class="string">"m"</span>,</span><br><span class="line"><span class="string">"n"</span>, <span class="string">"p"</span>, <span class="string">"q"</span>, <span class="string">"r"</span>, <span class="string">"s"</span>, <span class="string">"t"</span>, <span class="string">"v"</span>, <span class="string">"w"</span>, <span class="string">"x"</span>, <span class="string">"y"</span>, <span class="string">"z"</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"\(someCharacter) is a consonant"</span>)</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"\(someCharacter) is not a vowel or a consonant"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 区间匹配</span></span><br><span class="line"><span class="keyword">let</span> approximateCount = <span class="number">62</span></span><br><span class="line"><span class="keyword">let</span> countedThings = <span class="string">"moons orbiting Saturn"</span></span><br><span class="line"><span class="keyword">var</span> naturalCount: <span class="type">String</span></span><br><span class="line"><span class="keyword">switch</span> approximateCount &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">    naturalCount = <span class="string">"no"</span></span><br><span class="line"><span class="keyword">case</span> <span class="number">1</span>..&lt;<span class="number">5</span>:</span><br><span class="line">    naturalCount = <span class="string">"a few"</span></span><br><span class="line"><span class="keyword">case</span> <span class="number">5</span>..&lt;<span class="number">12</span>:</span><br><span class="line">    naturalCount = <span class="string">"several"</span></span><br><span class="line"><span class="keyword">case</span> <span class="number">12</span>..&lt;<span class="number">100</span>:</span><br><span class="line">    naturalCount = <span class="string">"dozens of"</span></span><br><span class="line"><span class="keyword">case</span> <span class="number">100</span>..&lt;<span class="number">1000</span>:</span><br><span class="line">    naturalCount = <span class="string">"hundreds of"</span></span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">    naturalCount = <span class="string">"many"</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用_来匹配所有可能的值</span></span><br><span class="line"><span class="keyword">let</span> somePoint = (<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line"><span class="keyword">switch</span> somePoint &#123;</span><br><span class="line"><span class="keyword">case</span> (<span class="number">0</span>, <span class="number">0</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"(0, 0) is at the origin"</span>)</span><br><span class="line"><span class="keyword">case</span> (<span class="number">_</span>, <span class="number">0</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"(\(somePoint.0), 0) is on the x-axis"</span>)</span><br><span class="line"><span class="keyword">case</span> (<span class="number">0</span>, <span class="number">_</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"(0, \(somePoint.1)) is on the y-axis"</span>)</span><br><span class="line"><span class="keyword">case</span> (-<span class="number">2</span>...<span class="number">2</span>, -<span class="number">2</span>...<span class="number">2</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"(\(somePoint.0), \(somePoint.1)) is inside the box"</span>)</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"(\(somePoint.0), \(somePoint.1)) is outside of the box"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 在一个元组中使用值来绑定</span></span><br><span class="line"><span class="keyword">let</span> anotherPoint = (<span class="number">2</span>, <span class="number">0</span>)</span><br><span class="line"><span class="keyword">switch</span> anotherPoint &#123;</span><br><span class="line"><span class="keyword">case</span> (<span class="keyword">let</span> x, <span class="number">0</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"on the x-axis with an x value of \(x)"</span>)</span><br><span class="line"><span class="keyword">case</span> (<span class="number">0</span>, <span class="keyword">let</span> y):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"on the y-axis with a y value of \(y)"</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">let</span> (x, y):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"somewhere else at (\(x), \(y))"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用where语句来判断额外条件</span></span><br><span class="line"><span class="keyword">let</span> yetAnotherPoint = (<span class="number">1</span>, -<span class="number">1</span>)</span><br><span class="line"><span class="keyword">switch</span> yetAnotherPoint &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">let</span> (x, y) <span class="keyword">where</span> x == y:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"(\(x), \(y)) is on the line x == y"</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">let</span> (x, y) <span class="keyword">where</span> x == -y:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"(\(x), \(y)) is on the line x == -y"</span>)</span><br><span class="line"><span class="keyword">case</span> <span class="keyword">let</span> (x, y):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"(\(x), \(y)) is just some arbitrary point"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// fallthrough 在执行完当前case中的语句后继续执行下个case或者default中的语句</span></span><br><span class="line"><span class="keyword">let</span> integerToDescribe = <span class="number">5</span></span><br><span class="line"><span class="keyword">var</span> description = <span class="string">"The number \(integerToDescribe) is"</span></span><br><span class="line"><span class="keyword">switch</span> integerToDescribe &#123;</span><br><span class="line"><span class="keyword">case</span> <span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">11</span>, <span class="number">13</span>, <span class="number">17</span>, <span class="number">19</span>:</span><br><span class="line">    description += <span class="string">" a prime number, and also"</span></span><br><span class="line">    <span class="keyword">fallthrough</span></span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">    description += <span class="string">" an integer."</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(description)</span><br></pre></td></tr></table></figure>
<h2 id="给while指定一个标签"><a href="#给while指定一个标签" class="headerlink" title="给while指定一个标签"></a>给while指定一个标签</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> value = <span class="number">1</span></span><br><span class="line">game: <span class="keyword">while</span> <span class="number">1</span> &lt; <span class="number">2</span> &#123;</span><br><span class="line">    <span class="keyword">switch</span> value&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>:</span><br><span class="line">        value++</span><br><span class="line">        <span class="built_in">print</span>(value)</span><br><span class="line">        <span class="keyword">continue</span> game</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">        <span class="keyword">break</span> game</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果不指定标签，break就不能结束while循环，会形成死循环。</p>
<h2 id="guard"><a href="#guard" class="headerlink" title="guard"></a>guard</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">unc greet(person: [<span class="type">String</span>: <span class="type">String</span>]) &#123;</span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> name = person[<span class="string">"name"</span>] <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Hello \(name)!"</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> location = person[<span class="string">"location"</span>] <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"I hope the weather is nice near you."</span>)</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"I hope the weather is nice in \(location)."</span>)</span><br><span class="line">&#125;</span><br><span class="line">greet([<span class="string">"name"</span>: <span class="string">"John"</span>])</span><br><span class="line">greet([<span class="string">"name"</span>: <span class="string">"Jane"</span>, <span class="string">"location"</span>: <span class="string">"Cupertino"</span>])</span><br></pre></td></tr></table></figure>
<blockquote>
<ul>
<li>guard充当了警卫员一职，保证条件满足情况下，才能继续执行下面的代码，否则只能else返回。切记else中一定需要有返回的语句，比如return、continue、break、throw这种提早退出的关键字！！！</li>
<li>let定义的name不再是局部变量，而是全局变量。</li>
</ul>
</blockquote>
<h2 id="检查API可用性"><a href="#检查API可用性" class="headerlink" title="检查API可用性"></a>检查API可用性</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> #available(iOS <span class="number">9</span>, <span class="type">OSX</span> <span class="number">10.10</span>, *) &#123;</span><br><span class="line">    <span class="comment">// 在 iOS 使用 iOS 9 的 API, 在 OS X 使用 OS X v10.10 的 API</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">// 使用先前版本的 iOS 和 OS X 的 API</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/03/03/iOS进阶（五）网络数据解析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZeroJi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZeroJi's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/03/03/iOS进阶（五）网络数据解析/" itemprop="url">iOS进阶（五）网络数据解析</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-03-03T09:30:00+08:00">
                2016-03-03
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-04-28T17:01:36+08:00">
                2018-04-28
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="解析的基本概念"><a href="#解析的基本概念" class="headerlink" title="解析的基本概念"></a>解析的基本概念</h2><p>解析：从事先规定好的格式中提取数据。</p>
<p>iOS开发常见的解析:<code>XML</code>解析，<code>JSON</code>解析。</p>
<h2 id="XML示例"><a href="#XML示例" class="headerlink" title="XML示例"></a>XML示例</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version = "1.0" encoding = "UTF-8"?&gt;</span><br><span class="line"><span class="tag">&lt;<span class="name">Teachers</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Teacher</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>污源<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">gender</span>&gt;</span>男<span class="tag">&lt;/<span class="name">gender</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">height</span>&gt;</span>187<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">hobby</span>&gt;</span>LOL<span class="tag">&lt;/<span class="name">hobby</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Teacher</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Teacher</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>瘪犊子<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">gender</span>&gt;</span>男<span class="tag">&lt;/<span class="name">gender</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">height</span>&gt;</span>173<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">hobby</span>&gt;</span>修行<span class="tag">&lt;/<span class="name">hobby</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Teacher</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Teacher</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">name</span>&gt;</span>新闻<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">gender</span>&gt;</span>女<span class="tag">&lt;/<span class="name">gender</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">height</span>&gt;</span>160<span class="tag">&lt;/<span class="name">height</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">hobby</span>&gt;</span>健身<span class="tag">&lt;/<span class="name">hobby</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Teacher</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Teachers</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>解释：在本xml文件中有一个根节点<code>&lt;Teachers&gt;&lt;/Teacher&gt;</code>，其中包含4个叶节点<code>&lt;teacher&gt;&lt;/teacher&gt;</code>。</p>
<h2 id="使用DOM工具解析XML"><a href="#使用DOM工具解析XML" class="headerlink" title="使用DOM工具解析XML"></a>使用DOM工具解析XML</h2><p>DOM工作原理：以栈的方式读入整个XML文档。</p>
<p>工具：<code>GDataXMLNode</code></p>
<p>使用方法</p>
<ul>
<li>获取<code>GDagaXMLNode.h/m</code>文件，将<code>GDataXMLNode.h/m</code>文件添加到工程中。</li>
<li>向工程中添加<code>libxml2.dylib</code>动态库。</li>
<li>在工程的<code>Build Settings</code>页面中找到<code>Header Search Path</code>项，添加<code>/usr/include/libxml2</code>。</li>
<li>导入<code>GDataXMLNode.h</code>文件到头文件中，如工程能编译通过，则说明添加成功。</li>
</ul>
<p>首先对XML文件进行解析</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取文件路径</span></span><br><span class="line">    <span class="built_in">NSString</span> *path = [[<span class="built_in">NSBundle</span> mainBundle] pathForResource:<span class="string">@"Teacher"</span> ofType:<span class="string">@".xml"</span>];</span><br><span class="line">    <span class="comment">// 从文件路径中获取NSData类型的参数</span></span><br><span class="line">    <span class="built_in">NSData</span> *data = [<span class="built_in">NSData</span> dataWithContentsOfFile:path];</span><br><span class="line">    <span class="comment">// 这行代码执行之后，我们对XML文档的解析已经成功了。在Document中保存的是XML文档的 版本号 编码格式 根节点 叶节点 等所有文档信息。如果我们想要数据，只需要对Document进行处理就可以拿到。</span></span><br><span class="line">    GDataXMLDocument *document = [[GDataXMLDocument alloc] initWithData:data options:<span class="number">0</span> error:<span class="literal">nil</span>];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, document);</span><br></pre></td></tr></table></figure>
<p>获取根节点下所有子节点的对象。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在Document中找到根节点对象</span></span><br><span class="line">   GDataXMLElement *root = document.rootElement;</span><br><span class="line">   <span class="comment">// 获取根节点下的所有子节点对象</span></span><br><span class="line">   <span class="built_in">NSArray</span> *arr = root.children;</span><br></pre></td></tr></table></figure>
<p>获取其中的数据有2种方法</p>
<p>一、通过属性找到数据。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GDataXMLElement *root = document.rootElement;</span><br><span class="line">   <span class="built_in">NSArray</span> *arr = [root elementsForName:<span class="string">@"Teacher"</span>];</span><br><span class="line">   GDataXMLElement *name = [[arr[<span class="number">0</span>] elementsForName:<span class="string">@"name"</span>] lastObject];</span><br><span class="line">   <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, [name stringValue]);</span><br></pre></td></tr></table></figure>
<p>二、使用方法找到数据。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 从Document出发，绝对路径</span></span><br><span class="line">   GDataXMLElement *name = [[document nodesForXPath:<span class="string">@"Teachers/Teacher/name"</span> error:<span class="literal">nil</span>] objectAtIndex:<span class="number">0</span>];</span><br><span class="line">   <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, [name stringValue]);</span><br><span class="line">   </span><br><span class="line">   <span class="comment">// 从根节点出发，绝对路径</span></span><br><span class="line">   GDataXMLElement *wuyuan = [[document.rootElement nodesForXPath:<span class="string">@"Teacher/name"</span> error:<span class="literal">nil</span>] objectAtIndex:<span class="number">0</span>];</span><br><span class="line">   <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, [wuyuan stringValue]);</span><br><span class="line">   </span><br><span class="line">   <span class="comment">// 相对路径</span></span><br><span class="line">   GDataXMLElement *name1 = [[document nodesForXPath:<span class="string">@"//name"</span> error:<span class="literal">nil</span>] objectAtIndex:<span class="number">0</span>];</span><br><span class="line">   <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, [name1 stringValue]);</span><br></pre></td></tr></table></figure>
<h2 id="JSON示例"><a href="#JSON示例" class="headerlink" title="JSON示例"></a>JSON示例</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line"> &#123;<span class="attr">"name"</span>:<span class="string">"洪荒"</span>, <span class="attr">"gender"</span>:<span class="string">"女"</span>, <span class="attr">"age"</span>:<span class="string">"1"</span>&#125;,</span><br><span class="line"> &#123;<span class="attr">"name"</span>:<span class="string">"中二"</span>, <span class="attr">"gender"</span>:<span class="string">"男"</span>, <span class="attr">"age"</span>:<span class="string">"2"</span>&#125;,</span><br><span class="line"> &#123;<span class="attr">"name"</span>:<span class="string">"66"</span>, <span class="attr">"gender"</span>:<span class="string">"女"</span>, <span class="attr">"age"</span>:<span class="string">"18"</span>&#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>解释：一个数组中包含3个字典。</p>
<h2 id="使用Foundation进行JSON解析"><a href="#使用Foundation进行JSON解析" class="headerlink" title="使用Foundation进行JSON解析"></a>使用Foundation进行JSON解析</h2><p>只需2步即可</p>
<p>一、获取JSON文件路径。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *filePath = [[<span class="built_in">NSBundle</span> mainBundle] pathForResource:<span class="string">@"Student"</span> ofType:<span class="string">@"json"</span>];</span><br><span class="line"><span class="built_in">NSData</span> *data = [<span class="built_in">NSData</span> dataWithContentsOfFile:filePath];</span><br></pre></td></tr></table></figure>
<p>二、解析JSON数据，使用系统方法JSONObjectWithData:option:error:。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSArray</span> *arr = [<span class="built_in">NSJSONSerialization</span> JSONObjectWithData:data options:<span class="built_in">NSJSONReadingMutableContainers</span> | <span class="built_in">NSJSONReadingMutableLeaves</span> error:<span class="literal">nil</span>];</span><br></pre></td></tr></table></figure>
<h2 id="XML优缺点"><a href="#XML优缺点" class="headerlink" title="XML优缺点"></a>XML优缺点</h2><p>优点</p>
<ol>
<li>格式统一，符合标准。</li>
<li>容易与其他系统进行远程交互，数据共享比较方便。</li>
</ol>
<p>缺点</p>
<ol>
<li>XML格式文件庞大，格式复杂，传输占用带宽。</li>
<li>服务器端和客户端需要花费大量代码来解析XML。</li>
<li>客户端不同浏览器之间解析XML的方式不一致。</li>
<li>服务器端和客户端解析XML花费资源和时间。</li>
</ol>
<h2 id="JSON优缺点"><a href="#JSON优缺点" class="headerlink" title="JSON优缺点"></a>JSON优缺点</h2><p>优点</p>
<ol>
<li>数据格式比较简单，易于读写，格式都是压缩的，占用带宽小。</li>
<li>易于解析这种语言。</li>
<li>支持多种语言，便于服务器端解析。</li>
<li>JSON格式能够直接为服务器端代码使用，大大简化了服务器端和客户端的代码开发量，但是完成的任务不变，且易于维护。</li>
</ol>
<p>缺点</p>
<ol>
<li>没有XML格式的使用广泛，没有XMl的通用性。</li>
<li>JSON格式目前在Web Service中推广还属于初级阶段。</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/03/01/Swift（三）集合类型/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZeroJi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZeroJi's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/03/01/Swift（三）集合类型/" itemprop="url">Switf（三）集合类型</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-03-01T12:40:00+08:00">
                2016-03-01
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-04-28T17:03:17+08:00">
                2018-04-28
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="集合的可变性"><a href="#集合的可变性" class="headerlink" title="集合的可变性"></a>集合的可变性</h2><p>声明为<code>let</code>类型的为不可变集合，声明为<code>var</code>类型的为可变集合。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> mArr = [<span class="string">"1"</span>, <span class="string">"2"</span>] <span class="comment">// 可变集合</span></span><br><span class="line"><span class="keyword">let</span> arr = [<span class="string">"1"</span>, <span class="string">"2"</span>] <span class="comment">// 不可变集合</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意，数组有序，集合与字典无序。</p>
</blockquote>
<h2 id="创建空数组"><a href="#创建空数组" class="headerlink" title="创建空数组"></a>创建空数组</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> someInts = [<span class="type">Int</span>]() <span class="comment">// 创建一个元素类型是Int的数组</span></span><br><span class="line"><span class="built_in">print</span>(someInts)</span><br><span class="line">someInts.append(<span class="number">3</span>) <span class="comment">// 在数组最后一个元素后面添加一个元素，值为3</span></span><br><span class="line"><span class="built_in">print</span>(someInts)</span><br><span class="line">someInts = [] <span class="comment">// someInts类型依然是[Int]类型，但是数组内没有元素</span></span><br><span class="line"><span class="built_in">print</span>(someInts)</span><br></pre></td></tr></table></figure>
<h2 id="创建带有默认值的数组"><a href="#创建带有默认值的数组" class="headerlink" title="创建带有默认值的数组"></a>创建带有默认值的数组</h2><p><code>Double(count:repeatedValue:)</code>创建一个内部元素个数是<code>count</code>，且默认值是<code>repeatedValue</code>的数组。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> threeDboules = [<span class="type">Double</span>](<span class="built_in">count</span>:<span class="number">3</span>, repeatedValue:<span class="number">0.0</span>)</span><br><span class="line"><span class="built_in">print</span>(threeDoubles)</span><br></pre></td></tr></table></figure>
<h2 id="通过两个数组相加创建一个数组"><a href="#通过两个数组相加创建一个数组" class="headerlink" title="通过两个数组相加创建一个数组"></a>通过两个数组相加创建一个数组</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> anotherThreeDoubles = <span class="type">Array</span>(<span class="built_in">count</span>:<span class="number">3</span>, repeatedValue:<span class="number">2.5</span>) <span class="comment">// anotherThreeDoubles 被推断为[Double]类型</span></span><br><span class="line"><span class="keyword">var</span> sixDoubles = threeDoubles + anotherThreeDoubles</span><br><span class="line"><span class="built_in">print</span>(sixDoubles)</span><br></pre></td></tr></table></figure>
<h2 id="通过字面量创建数组"><a href="#通过字面量创建数组" class="headerlink" title="通过字面量创建数组"></a>通过字面量创建数组</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> shoppingList = [<span class="string">"Eggs"</span>, <span class="string">"Milk"</span>] <span class="comment">// 被自动推断为[String]类型</span></span><br><span class="line"><span class="built_in">print</span>(shoppingList)</span><br></pre></td></tr></table></figure>
<h2 id="访问和修改数组"><a href="#访问和修改数组" class="headerlink" title="访问和修改数组"></a>访问和修改数组</h2><p><code>count</code>属性，获取数组中元素的个数。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(shoppingList.<span class="built_in">count</span>)</span><br></pre></td></tr></table></figure>
<p><code>isEmpty</code>属性，如果数组为空则返回<code>true</code>，反之返回<code>false</code>。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> shoppingList.isEmpty &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"is Empty"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"not Empty"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>append(_)</code>在数组最后一个元素后添加一个元素。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shoppingList.append(<span class="string">"Flour"</span>)</span><br><span class="line"><span class="built_in">print</span>(shoppingList)</span><br></pre></td></tr></table></figure>
<p><code>+</code>，添加一个数组到最后一个元素后。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">shoppingList += [<span class="string">"Baking Powder"</span>]</span><br><span class="line"><span class="built_in">print</span>(shoppingList)</span><br></pre></td></tr></table></figure>
<p>以下标获取或者修改对应元素。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> firstItem = shoppingList[<span class="number">0</span>] </span><br><span class="line"><span class="built_in">print</span>(firstItem)</span><br><span class="line"></span><br><span class="line">shoppingList[<span class="number">0</span>] = <span class="string">"Six eggs"</span> </span><br><span class="line"><span class="built_in">print</span>(shoppingList)</span><br><span class="line"></span><br><span class="line">shoppingList[<span class="number">1</span>...<span class="number">3</span>] = [<span class="string">"Bananas"</span>, <span class="string">"Apples"</span>] <span class="comment">// 替换下标从1到3的元素</span></span><br></pre></td></tr></table></figure>
<ul>
<li><code>insert(_, atIndex:)</code>在下标为<code>_</code>的元素前添加一个元素。</li>
<li><code>removeAtIndex(_)</code>移除下标为<code>_</code>的元素。</li>
<li><code>removeLast()</code>移除最后一个元素。</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">shoppingList.insert(<span class="string">"Maple Syrup"</span>, atIndex: <span class="number">0</span>) </span><br><span class="line"><span class="built_in">print</span>(shoppingList)</span><br><span class="line"></span><br><span class="line">shoppingList.removeAtIndex(<span class="number">0</span>) </span><br><span class="line"><span class="built_in">print</span>(shoppingList)</span><br><span class="line"></span><br><span class="line">shoppingList.removeLast() </span><br><span class="line"><span class="built_in">print</span>(shoppingList)</span><br></pre></td></tr></table></figure>
<h2 id="数组遍历"><a href="#数组遍历" class="headerlink" title="数组遍历"></a>数组遍历</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> shoppingList &#123;</span><br><span class="line">    <span class="built_in">print</span>(item)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>enumerate()</code>返回(index, value)元组。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (index, value) <span class="keyword">in</span> shoppingList.<span class="built_in">enumerate</span>() &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"item \(String(index + 1)) : \(value)"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="创建和构造一个空集合"><a href="#创建和构造一个空集合" class="headerlink" title="创建和构造一个空集合"></a>创建和构造一个空集合</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> letters = <span class="type">Set</span>&lt;<span class="type">Character</span>&gt;()</span><br><span class="line">letters.insert(<span class="string">"a"</span>)</span><br><span class="line">letters = []</span><br></pre></td></tr></table></figure>
<h2 id="字面量创建集合"><a href="#字面量创建集合" class="headerlink" title="字面量创建集合"></a>字面量创建集合</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 用字面量创建集合</span></span><br><span class="line"><span class="comment">//var favoriteGenres: Set&lt;String&gt; = ["Rock", "Classical", "Hip hop"]</span></span><br><span class="line"><span class="keyword">var</span> favoriteGenres: <span class="type">Set</span> = [<span class="string">"Rock"</span>, <span class="string">"Classical"</span>, <span class="string">"Hip hop"</span>]; <span class="comment">// 上面语句的简化</span></span><br></pre></td></tr></table></figure>
<h2 id="访问和修改一个集合"><a href="#访问和修改一个集合" class="headerlink" title="访问和修改一个集合"></a>访问和修改一个集合</h2><p><code>count</code>属性，返回集合中的元素个数。<br><code>insert(_)</code>插入一个元素。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(favoriteGenres.<span class="built_in">count</span>) <span class="comment">// 输出元素个数</span></span><br><span class="line"><span class="keyword">if</span> favoriteGenres.isEmpty &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"is Empty"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"not Empty"</span>)</span><br><span class="line">&#125;</span><br><span class="line">favoriteGenres.insert(<span class="string">"Jazz"</span>)</span><br><span class="line"><span class="built_in">print</span>(favoriteGenres)</span><br></pre></td></tr></table></figure>
<h2 id="遍历一个集合"><a href="#遍历一个集合" class="headerlink" title="遍历一个集合"></a>遍历一个集合</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> genre <span class="keyword">in</span> favoriteGenres &#123;</span><br><span class="line">    <span class="built_in">print</span>(genre)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> genre <span class="keyword">in</span> favoriteGenres.<span class="built_in">sort</span>() &#123; <span class="comment">// sort()方法，将集合排序</span></span><br><span class="line">    <span class="built_in">print</span>(genre)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="集合操作"><a href="#集合操作" class="headerlink" title="集合操作"></a>集合操作</h2><ul>
<li>使用<code>intersect(_:)</code>方法根据两个集合中都包含的值创建的一个新的集合。</li>
<li>使用<code>exclusiveOr(_:)</code>方法根据在一个集合中但不在两个集合中的值创建一个新的集合。</li>
<li>使用<code>union(_:)</code>方法根据两个集合的值创建一个新的集合。</li>
<li>使用<code>subtract(_:)</code>方法根据不在该集合中的值创建一个新的集合。</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> oddDigits: <span class="type">Set</span> = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line"><span class="keyword">let</span> evenDigits: <span class="type">Set</span> = [<span class="number">0</span>, <span class="number">2</span>, <span class="number">4</span>, <span class="number">6</span>, <span class="number">8</span>]</span><br><span class="line"><span class="keyword">let</span> singleDigitPrimeNumbers: <span class="type">Set</span> = [<span class="number">2</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(oddDigits.union(evenDigits).<span class="built_in">sort</span>())</span><br><span class="line"><span class="built_in">print</span>(oddDigits.intersect(evenDigits).<span class="built_in">sort</span>())</span><br><span class="line"><span class="built_in">print</span>(oddDigits.subtract(singleDigitPrimeNumbers).<span class="built_in">sort</span>())</span><br><span class="line"><span class="built_in">print</span>(oddDigits.exclusiveOr(singleDigitPrimeNumbers).<span class="built_in">sort</span>())</span><br></pre></td></tr></table></figure>
<ul>
<li>使用“是否相等”运算符(<code>==</code>)来判断两个集合是否包含全部相同的值。</li>
<li>使用<code>isSubsetOf(_:)</code>方法来判断一个集合中的值是否也被包含在另外一个集合中。</li>
<li>使用<code>isSupersetOf(_:)</code>方法来判断一个集合中包含另一个集合中所有的值。</li>
<li>使用<code>isStrictSubsetOf(_:)</code>或者isStrictSupersetOf(_:)方法来判断一个集合是否是另外一个集合的子集合或者父集合并且两个集合并不相等。</li>
<li>使用<code>isDisjointWith(_:)</code>方法来判断两个集合是否不含有相同的值(是否没有交集)。</li>
</ul>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> houseAnimals: <span class="type">Set</span> = [<span class="string">"🐶"</span>, <span class="string">"🐱"</span>]</span><br><span class="line"><span class="keyword">let</span> farmAnimals: <span class="type">Set</span> = [<span class="string">"🐮"</span>, <span class="string">"🐔"</span>, <span class="string">"🐑"</span>, <span class="string">"🐶"</span>, <span class="string">"🐱"</span>]</span><br><span class="line"><span class="keyword">let</span> cityAnimals: <span class="type">Set</span> = [<span class="string">"🐦"</span>, <span class="string">"🐭"</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(houseAnimals == cityAnimals)</span><br><span class="line"><span class="built_in">print</span>(houseAnimals.isSubsetOf(farmAnimals))</span><br><span class="line"><span class="built_in">print</span>(farmAnimals.isSupersetOf(houseAnimals))</span><br><span class="line"><span class="built_in">print</span>(farmAnimals.isDisjointWith(cityAnimals))</span><br><span class="line"><span class="built_in">print</span>(houseAnimals.isDisjointWith(cityAnimals))</span><br></pre></td></tr></table></figure>
<h2 id="创建一个空字典"><a href="#创建一个空字典" class="headerlink" title="创建一个空字典"></a>创建一个空字典</h2><p><code>[Int: String]()</code>创建一个键为Int类型，值为String类型的字典。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> namesOfIntegers = [<span class="type">Int</span>: <span class="type">String</span>]()</span><br><span class="line">namesOfIntegers[<span class="number">16</span>] = <span class="string">"sixteen"</span>;</span><br><span class="line"><span class="built_in">print</span>(namesOfIntegers)</span><br><span class="line">namesOfIntegers = [:] <span class="comment">// 空字典</span></span><br><span class="line"><span class="built_in">print</span>(namesOfIntegers)</span><br></pre></td></tr></table></figure>
<h2 id="字面量创建字典"><a href="#字面量创建字典" class="headerlink" title="字面量创建字典"></a>字面量创建字典</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//var airports: [String: String] = ["YYZ": "Toronto Pearson", "DUB": "Dublin"]</span></span><br><span class="line"><span class="keyword">var</span> airports = [<span class="string">"YYZ"</span>: <span class="string">"Toronto Pearson"</span>, <span class="string">"DUB"</span>: <span class="string">"Dublin"</span>] <span class="comment">// 简化后的语句</span></span><br><span class="line"><span class="built_in">print</span>(airports)</span><br></pre></td></tr></table></figure>
<h2 id="访问和修改字典"><a href="#访问和修改字典" class="headerlink" title="访问和修改字典"></a>访问和修改字典</h2><p><code>count</code>属性，获取字典的键值对个数。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(airports.<span class="built_in">count</span>)</span><br><span class="line"><span class="keyword">if</span> airports.isEmpty &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"is Empty"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"not Empty"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">airports[<span class="string">"LHR"</span>] = <span class="string">"London"</span> <span class="comment">// 添加一个健为"LHR"，值为"London"的键值对</span></span><br><span class="line">airports[<span class="string">"LHR"</span>] = <span class="string">"London Heathrow"</span> <span class="comment">// 修改一个键为"LHR"的键值对的值为"London Heathrow"</span></span><br></pre></td></tr></table></figure>
<p><code>updateValue(_:forKey:)</code> 返回一个旧值，如果没有值存在于更新前，返回nil，返回的值为<em>可选类型</em>，需要<em>解析</em>。</p>
<p><code>removeValueForKey(_)</code>返回一个已经被删除的可选类型或者nil。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> oldValue = airports.updateValue(<span class="string">"Dublin Airport"</span>, forKey: <span class="string">"DUB"</span>) &#123; </span><br><span class="line">    <span class="built_in">print</span>(oldValue)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> airportName = airports[<span class="string">"DUB"</span>] &#123; <span class="comment">// airports["DUB"] 返回值为可选类型。</span></span><br><span class="line">    <span class="built_in">print</span>(airportName)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"not has any value"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> removeValue = airports.removeValueForKey(<span class="string">"DUB"</span>) &#123; </span><br><span class="line">    <span class="built_in">print</span>(removeValue)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"not has any value"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">airports[<span class="string">"APL"</span>] = <span class="string">"Apple Internation"</span></span><br><span class="line">airports[<span class="string">"APL"</span>] = <span class="literal">nil</span> <span class="comment">// 移除键为"APL"的键值对</span></span><br></pre></td></tr></table></figure>
<h2 id="遍历字典"><a href="#遍历字典" class="headerlink" title="遍历字典"></a>遍历字典</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (airportCode, airportName) <span class="keyword">in</span> airports &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"\(airportCode) : \(airportName)"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>keys</code>属性，当前字典的所有键。<br><code>values</code>属性，当前字典的所有值。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> airportsCode <span class="keyword">in</span> airports.keys &#123; <span class="comment">// keys属性，获取当前字典的所有键</span></span><br><span class="line">    <span class="built_in">print</span>(airportsCode)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> airportName <span class="keyword">in</span> airports.values &#123; <span class="comment">// values属性，获取当前字典的所有值</span></span><br><span class="line">    <span class="built_in">print</span>(airportName)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>keys</code>和<code>values</code>必须使用<code>[String]()</code>才可读，否侧无法以字符串使用。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> airportCodes = [<span class="type">String</span>](airports.keys)</span><br><span class="line"><span class="built_in">print</span>(airportCodes)</span><br><span class="line"><span class="keyword">let</span> airportNames = [<span class="type">String</span>](airports.values)</span><br><span class="line"><span class="built_in">print</span>(airportNames)</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/03/01/Swift（二）字符串与字符/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZeroJi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZeroJi's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/03/01/Swift（二）字符串与字符/" itemprop="url">Switf（二）字符串与字符</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-03-01T12:40:00+08:00">
                2016-03-01
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-04-28T17:03:12+08:00">
                2018-04-28
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="初始化空字符串"><a href="#初始化空字符串" class="headerlink" title="初始化空字符串"></a>初始化空字符串</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> emptyString = <span class="string">""</span> <span class="comment">// 空字符串字面量</span></span><br><span class="line"><span class="keyword">var</span> anotherEmptyString = <span class="type">String</span>() <span class="comment">// 空字符串初始化方法</span></span><br></pre></td></tr></table></figure>
<p>判断字符串是否为空</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> emptyString.isEmpty &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Nothing to see here"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="字符串拼接"><a href="#字符串拼接" class="headerlink" title="字符串拼接"></a>字符串拼接</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> variableString = <span class="string">"Horse"</span></span><br><span class="line">variableString += <span class="string">" and carriage"</span> <span class="comment">// 可以直接用 + 拼接字符串</span></span><br><span class="line"><span class="built_in">print</span>(variableString)</span><br></pre></td></tr></table></figure>
<p>字符串逐个字符输出</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> character <span class="keyword">in</span> <span class="string">"Dog!"</span>.character &#123; <span class="comment">// character 获取字符串中所有字符</span></span><br><span class="line">    <span class="built_in">print</span>(character)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="字符数组转字符串"><a href="#字符数组转字符串" class="headerlink" title="字符数组转字符串"></a>字符数组转字符串</h2><p>首先创建一个字符数组并赋值</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> catCharacter: [<span class="type">Character</span>] = [<span class="string">"C"</span>, <span class="string">"a"</span>, <span class="string">"t"</span>, <span class="string">"!"</span>];</span><br></pre></td></tr></table></figure>
<p>将字符数组转换为字符串并输出</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> catString = <span class="type">String</span>(catCharacter)</span><br><span class="line"><span class="built_in">print</span>(catString)</span><br></pre></td></tr></table></figure>
<h2 id="append-函数的使用"><a href="#append-函数的使用" class="headerlink" title="append()函数的使用"></a>append()函数的使用</h2><p><code>append()</code> 是将一个字符附加到一个字符串的尾部</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> welcome = <span class="string">"welcome"</span></span><br><span class="line"><span class="keyword">let</span> exclamationMark: <span class="type">Character</span> = <span class="string">"!"</span></span><br><span class="line">welcome.append(exclamationMark)</span><br><span class="line"><span class="comment">//welcome += exclamationMark // 无法直接拼接字符</span></span><br><span class="line"><span class="built_in">print</span>(welcome)</span><br></pre></td></tr></table></figure>
<h2 id="字符串插值"><a href="#字符串插值" class="headerlink" title="字符串插值"></a>字符串插值</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> multiplier = <span class="number">3</span></span><br><span class="line"><span class="keyword">let</span> message = <span class="string">"\(multiplier) times 2.5 is \(Double(multiplier)) * 2.5 "</span></span><br><span class="line"><span class="built_in">print</span>(message)</span><br></pre></td></tr></table></figure>
<h2 id="转移字符"><a href="#转移字符" class="headerlink" title="转移字符"></a>转移字符</h2><p>转义字符<code>\0</code>(空字符)、<code>\\</code>(反斜线)、<code>\t</code>(水平制表符)、<code>\n</code>(换行符)、<code>\r</code>(回车符)、<code>\&quot;</code>(双引号)、<code>\&#39;</code>(单引号)</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> wiseWords = <span class="string">"\"Imagination is more important than knowledge\" - Einstein"</span></span><br><span class="line"><span class="built_in">print</span>(wiseWords)</span><br></pre></td></tr></table></figure>
<h2 id="获取字符串中所有字符的数量"><a href="#获取字符串中所有字符的数量" class="headerlink" title="获取字符串中所有字符的数量"></a>获取字符串中所有字符的数量</h2><p><code>count</code>属性，获取所有字符的数量</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> unusualMenagerie = <span class="string">"Koala, Snail, Penguin, Dromedary"</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"\(unusualMenagerie.characters.count) characters"</span>)</span><br></pre></td></tr></table></figure>
<h2 id="字符串索引"><a href="#字符串索引" class="headerlink" title="字符串索引"></a>字符串索引</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> greeting = <span class="string">"Guten Tag!"</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"startIndex is \(greeting[greeting.startIndex])"</span>) <span class="comment">// .startIndex 获取第一个Character的索引</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"endIndex is \(greeting[greeting.endIndex.predecessor()])"</span>) <span class="comment">// .endIndex.predecessor() 获取最后一个Character的前一个索引</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"startIndex.successor() is \(greeting[greeting.start.Index.successor()])"</span>) <span class="comment">// .startIndex.successor() 获取第一个索引后面一个索引</span></span><br><span class="line"><span class="keyword">let</span> index = greeting.startIndex.advancedBy(<span class="number">7</span>) <span class="comment">// .startIndex.advancedBy(7) 获取第一个索引后的第七个索引</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"\(greeting[index])"</span>) <span class="comment">// greeting[index] 获取greeting的第index个索引处的Character</span></span><br></pre></td></tr></table></figure>
<h2 id="所有索引"><a href="#所有索引" class="headerlink" title="所有索引"></a>所有索引</h2><p><code>indices</code>获取所有索引，返回一个<code>Range</code>类型的值</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> index <span class="keyword">in</span> greeting.characters.<span class="built_in">indices</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"\(greeting[index]) "</span>, terminator: <span class="string">""</span>) <span class="comment">// terminator: "" 不换行</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">""</span>) <span class="comment">// 换行</span></span><br></pre></td></tr></table></figure>
<h2 id="插入和删除"><a href="#插入和删除" class="headerlink" title="插入和删除"></a>插入和删除</h2><blockquote>
<p>注意：插入和删除方法只能在OS X 10.11及之后的版本中生效!!!!</p>
</blockquote>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> welcome_String = <span class="string">"hello"</span></span><br><span class="line">welcome.insert(<span class="string">"!"</span>, atIndex: welcome.endIndex.predecessor()) <span class="comment">// 在指定位置插入一个字符</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"welcome_String is \(welcome_String)"</span>)</span><br><span class="line"></span><br><span class="line">welcome.insertContentsOf(<span class="string">" there"</span>.characters, at: welcome.endIndex.predecessor()) <span class="comment">// 在一个字符串的指定索引插入一个字符串</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"welcome_String is \(welcome_String)"</span>)</span><br><span class="line"></span><br><span class="line">welcome.removeAtIndex(welcome.endIndex.predecessor())</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"welcome_String is \(welcome_String)"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> range = welcome.endIndex.advancedBy(-<span class="number">6</span>)..&lt;welcome.endIndex <span class="comment">// 从最后一个索引前6个索引到最后一个索引前一个索引的范围</span></span><br><span class="line">welcome.removeRange(range)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"welcome_String is \(welcome_String)"</span>)</span><br></pre></td></tr></table></figure>
<h3 id="前缀-后缀相等"><a href="#前缀-后缀相等" class="headerlink" title="前缀/后缀相等"></a>前缀/后缀相等</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> romeoAndJuliet = [</span><br><span class="line">    <span class="string">"Act 1 Scene 1: Verona, A public place"</span>,</span><br><span class="line">    <span class="string">"Act 1 Scene 2: Capulet's mansion"</span>,</span><br><span class="line">    <span class="string">"Act 1 Scene 3: A room in Capulet's mansion"</span>,</span><br><span class="line">    <span class="string">"Act 1 Scene 4: A street outside Capulet's mansion"</span>,</span><br><span class="line">    <span class="string">"Act 1 Scene 5: The Great Hall in Capulet's mansion"</span>,</span><br><span class="line">    <span class="string">"Act 2 Scene 1: Outside Capulet's mansion"</span>,</span><br><span class="line">    <span class="string">"Act 2 Scene 2: Capulet's orchard"</span>,</span><br><span class="line">    <span class="string">"Act 2 Scene 3: Outside Friar Lawrence's cell"</span>,</span><br><span class="line">    <span class="string">"Act 2 Scene 4: A street in Verona"</span>,</span><br><span class="line">    <span class="string">"Act 2 Scene 5: Capulet's mansion"</span>,</span><br><span class="line">    <span class="string">"Act 2 Scene 6: Friar Lawrence's cell"</span></span><br><span class="line">]</span><br><span class="line"><span class="keyword">var</span> act1SceneCount = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> scene <span class="keyword">in</span> romeoAndJuliet &#123;</span><br><span class="line">    <span class="keyword">if</span> scene.hasPrefix(<span class="string">"Act 1"</span>) &#123; <span class="comment">// .hasPrefix 判断是否包含括号中的前缀，返回布尔值</span></span><br><span class="line">        ++act1SceneCount</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"\(act1SceneCount) scenes in Act 1"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> mansionCount = <span class="number">0</span></span><br><span class="line"><span class="keyword">var</span> cellCount = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> scene <span class="keyword">in</span> romeoAndJuliet &#123;</span><br><span class="line">    <span class="keyword">if</span> scene.hasSuffix(<span class="string">"Capulet's mansion"</span>) &#123;</span><br><span class="line">        ++mansionCount</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        ++cellCount</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"\(mansionCount) mansion scenes; \(cellCount) cell scenes"</span>)</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/03/01/iOS进阶（三）CoreData/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZeroJi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZeroJi's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/03/01/iOS进阶（三）CoreData/" itemprop="url">iOS进阶（三）CoreData</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-03-01T09:00:00+08:00">
                2016-03-01
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-04-28T17:01:33+08:00">
                2018-04-28
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="CoreData与SQLite"><a href="#CoreData与SQLite" class="headerlink" title="CoreData与SQLite"></a>CoreData与SQLite</h2><p>SQlite</p>
<ol>
<li>基于C借口，需要使用sql语句，代码繁琐。</li>
<li>在处理大量数据时，表关系更直观。</li>
<li>在OC中不是可视化。</li>
</ol>
<p>CoreData</p>
<ol>
<li>可视化，有undo/redo能力。</li>
<li>可以实现多种文件格式NSSQLiteStoreType、NSBinaryStoreType、NSInMemoryStoreType、NSXMLStoreType。</li>
<li>苹果官方API支持，与iOS结合紧密。</li>
</ol>
<p>对于不同的情况可以选用以上两种数据库。</p>
<h2 id="CoreData核心类的关系"><a href="#CoreData核心类的关系" class="headerlink" title="CoreData核心类的关系"></a>CoreData核心类的关系</h2><ul>
<li>实体管理类：<code>NSManagedObject</code></li>
<li>实体描述类：<code>NSEntityDescription</code></li>
<li>数据管理器类：<code>NSManagedObjectContext</code></li>
<li>数据连接器类：<code>NSPersistentStoreCoordinator</code></li>
<li>数据模型类：<code>NSManagedObjectModel</code></li>
</ul>
<p>下图清楚的展示了各类的关系</p>
<p><img src="https://raw.githubusercontent.com/qq1216137037/qq1216137037.github.com/master/_postsImage/CoreData%E6%A0%B8%E5%BF%83%E5%AF%B9%E8%B1%A1.jpg" alt="关系图"></p>
<h2 id="CoreData的简单操作"><a href="#CoreData的简单操作" class="headerlink" title="CoreData的简单操作"></a>CoreData的简单操作</h2><p>首先创建一个项目，在创建的时候勾选<code>Use Core Data</code></p>
<p><img src="https://raw.githubusercontent.com/qq1216137037/qq1216137037.github.com/master/_postsImage/%E5%8B%BE%E9%80%89UseCoreData.png" alt="勾选"></p>
<p>你会发现在项目列表下出现了一个<code>CoreData.xcdatamodeld</code>文件，在<code>AppDelegate.h</code>文件中多出了许多代码。选中<code>CoreData.xcdatamodeld</code>文件，点击Add Enitity按钮，将实体重命名为<code>Student</code>，然后添加3条属性。</p>
<p><img src="https://raw.githubusercontent.com/qq1216137037/qq1216137037.github.com/master/_postsImage/%E6%B7%BB%E5%8A%A0%E5%AE%9E%E4%BD%93%E4%B8%8E%E5%B1%9E%E6%80%A7.png" alt="添加实体与属性"></p>
<p>选择菜单栏的Editor-&gt;Create NSManagedObject SubClass…-&gt;选中CoreData-&gt;选中Student-&gt;Next-&gt;Next-&gt;Create</p>
<p>封装一个插入学生的方法</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 封装一个插入学生的方法</span></span><br><span class="line">- (<span class="keyword">void</span>)insertStudentWithName:(<span class="built_in">NSString</span> *)name gender:(<span class="built_in">NSString</span> *)gender age:(<span class="built_in">NSNumber</span> *)age</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 创建一个模型</span></span><br><span class="line">    Student *stu1 = [<span class="built_in">NSEntityDescription</span> insertNewObjectForEntityForName:<span class="string">@"Student"</span> inManagedObjectContext:<span class="keyword">self</span>.managedObjectContext]; <span class="comment">// 在临时数据库中，按照实体Student，加载出一个视图管理对象(数据模型)</span></span><br><span class="line">    <span class="comment">// 模型赋值有两种方式，KVC赋值可以，属性赋值也可以。</span></span><br><span class="line">    stu1.name = name;</span><br><span class="line">    [stu1 setValue:gender forKey:<span class="string">@"gender"</span>];</span><br><span class="line">    stu1.age = age;</span><br><span class="line">    <span class="comment">// 数据管理类执行同步操作，将数据写入数据库。</span></span><br><span class="line">    [<span class="keyword">self</span>.managedObjectContext save:<span class="literal">nil</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在<code>- (BOOL)application:(UIApplication *)application didFinishLaunchingWithOptions:(NSDictionary *)launchOptions</code>方法中书写以下代码。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application didFinishLaunchingWithOptions:(<span class="built_in">NSDictionary</span> *)launchOptions &#123;</span><br><span class="line">    <span class="comment">// coreData 完成增删改查</span></span><br><span class="line">    <span class="comment">// 1.插入数据</span></span><br><span class="line">    [<span class="keyword">self</span> insertStudentWithName:<span class="string">@"巴达"</span> gender:<span class="string">@"雄"</span> age:@<span class="number">21</span>];</span><br><span class="line">    [<span class="keyword">self</span> insertStudentWithName:<span class="string">@"大宝"</span> gender:<span class="string">@"女"</span> age:@<span class="number">31</span>];</span><br><span class="line">    [<span class="keyword">self</span> insertStudentWithName:<span class="string">@"秋香"</span> gender:<span class="string">@"女"</span> age:@<span class="number">18</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 2.查询数据</span></span><br><span class="line">    <span class="comment">// 查询需要先创建查询请求对象</span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    NSFetchRequest *request = [[NSFetchRequest alloc] initWithEntityName:@"Student"]; // 请求对象如果这样创建，得到的信息是数据库中所有的记录。</span></span><br><span class="line"><span class="comment">    // 让数据管理对象执行请求</span></span><br><span class="line"><span class="comment">    NSArray *arr = [self.managedObjectContext executeFetchRequest:request error:nil];</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    // 为了更加方便的完成查询操作，查询请求可以添加谓词和排序。</span></span><br><span class="line"><span class="comment">    NSFetchRequest *request = [[NSFetchRequest alloc] init];</span></span><br><span class="line"><span class="comment">    // 得到一个实体描述</span></span><br><span class="line"><span class="comment">    NSEntityDescription *entity = [NSEntityDescription entityForName:@"Student" inManagedObjectContext:self.managedObjectContext];</span></span><br><span class="line"><span class="comment">    request.entity = entity;</span></span><br><span class="line"><span class="comment">    // 添加谓词</span></span><br><span class="line"><span class="comment">    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"name = %@ and gender = %@", @"秋香", @"女"];</span></span><br><span class="line"><span class="comment">    request.predicate = predicate;</span></span><br><span class="line"><span class="comment">    // 添加排序</span></span><br><span class="line"><span class="comment">    NSSortDescriptor *descriptor = [[NSSortDescriptor alloc] initWithKey:@"age" ascending:YES]; // 创建按照年龄升序排列的排序条件</span></span><br><span class="line"><span class="comment">    request.sortDescriptors = @[descriptor];</span></span><br><span class="line"><span class="comment">    // 执行查询</span></span><br><span class="line"><span class="comment">    NSArray *arr = [self.managedObjectContext executeFetchRequest:request error:nil];</span></span><br><span class="line"><span class="comment">    // 循环打印查询到的数组</span></span><br><span class="line"><span class="comment">    for (Student *stu in arr) &#123;</span></span><br><span class="line"><span class="comment">        NSLog(@"name is %@, gender is %@, age is %@", stu.name, stu.gender, stu.age);</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    // 3.修改数据</span></span><br><span class="line"><span class="comment">    // 修改数据，首先找到需要修改的数据，修改完成之后，同步到数据库。</span></span><br><span class="line"><span class="comment">    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"name = %@", @"中二"];</span></span><br><span class="line"><span class="comment">    request.predicate = predicate;</span></span><br><span class="line"><span class="comment">    NSArray *arr = [self.managedObjectContext executeFetchRequest:request error:nil];</span></span><br><span class="line"><span class="comment">    Student *stu = [arr lastObject];</span></span><br><span class="line"><span class="comment">    stu.name = @"中大二";</span></span><br><span class="line"><span class="comment">    stu.gender = @"妖";</span></span><br><span class="line"><span class="comment">    // 修改完成之后进行save操作</span></span><br><span class="line"><span class="comment">    [self.managedObjectContext save:nil];</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    // 4.删除数据</span></span><br><span class="line"><span class="comment">    // 找到你要删除的数据，然后让数据管理器对象执行delete方法。</span></span><br><span class="line"><span class="comment">    NSPredicate *predicate = [NSPredicate predicateWithFormat:@"name = %@", @"巴达"];</span></span><br><span class="line"><span class="comment">    request.predicate = predicate;</span></span><br><span class="line"><span class="comment">    NSArray *arr = [self.managedObjectContext executeFetchRequest:request error:nil];</span></span><br><span class="line"><span class="comment">    Student *stu = [arr lastObject];// 取到要删除的对象</span></span><br><span class="line"><span class="comment">    // 删除临时数据库中某个对象的方法</span></span><br><span class="line"><span class="comment">    [self.managedObjectContext deleteObject:stu];</span></span><br><span class="line"><span class="comment">    [self.managedObjectContext save:nil];</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//[self.managedObjectContext save:nil];</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, [<span class="keyword">self</span> applicationDocumentsDirectory]);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>以上代码包含了所有对数据库的增删改查，去掉注释符号即可使用。</p>
<blockquote>
<p>注意：每次添加删除修改数据以后都必须执行同步数据库操作，即执行<code>[self.managedObjectContext save:nil];</code></p>
</blockquote>
<h2 id="数据迁移"><a href="#数据迁移" class="headerlink" title="数据迁移"></a>数据迁移</h2><p>一. 设置coreData的配置为可迁移<br>在<code>Appdelegate.m</code>中的<code>- (NSPersistentStoreCoordinator *)persistentStoreCoordinator</code>方法中创建一个字典并且修改<code>_persistentStoreCoordinator</code>的<code>addPersistentStoreWithType: cafiguration: URL: options: error:</code>方法中的<code>option</code>参数设置为字典。</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSDictionary</span> *dict = @&#123; <span class="built_in">NSMigratePersistentStoresAutomaticallyOption</span>:@YES, <span class="built_in">NSInferMappingModelAutomaticallyOption</span>:@YES&#125;; <span class="comment">// 支持版本迁移，支持数据迁移。</span></span><br><span class="line"><span class="keyword">if</span> (![_persistentStoreCoordinator addPersistentStoreWithType:<span class="built_in">NSSQLiteStoreType</span> configuration:<span class="literal">nil</span> URL:storeURL options:dict error:&amp;error]) &#123;</span><br><span class="line">...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>二. 添加一个新的集合版本</p>
<p>选中<code>CoreData.xcdatamodeld</code>，菜单栏-&gt;Editor-&gt;Add Model Version…-&gt;Finish。<code>CoreData.xcdatamodeld</code>出现了下下拉选项，点击小三角，出现了一个<code>CoreData2.xcdatamodel</code>。</p>
<p>三. 在新的版本里给表添加新的字段（2、3的顺序不可以错）</p>
<p>点击<code>CoreData2.xcdatamodel</code>，添加一条属性。</p>
<p>四. 选择使用新的版本</p>
<p><code>alt</code> + <code>commond</code> + <code>0</code>，找到Model Version，将Current中的数值改为CoreData2。</p>
<p>五. 桥接两个版本，把老数据库的数据桥接到新数据库</p>
<p><code>shift</code> + <code>commond</code> + <code>n</code>选择Mapping Model-&gt;Next-&gt;选中CoreData.xcdatamodel-&gt;Next-&gt;选中CoreData2.xcdatamodel-&gt;将Targets中的CoreData打勾-&gt;Create。</p>
<p>六. 生成新的model类</p>
<p>删除之前创建的Student类，选择<code>CoreData2.xcdatamodel</code>再创建一次。</p>
<blockquote>
<p>注意：当执行完以上步骤后，需要重新同步数据库，否则应用程序中的数据库不会改变。</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/02/29/iOS进阶（二）数据库/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZeroJi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZeroJi's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/02/29/iOS进阶（二）数据库/" itemprop="url">iOS进阶（二）数据库</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-02-29T10:00:02+08:00">
                2016-02-29
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-04-28T17:01:29+08:00">
                2018-04-28
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>在学习之前，首先要初步掌握SQL语言增删改查的使用。本文学习使用的数据库是SQLite。</p>
</blockquote>
<p>Linux系统级的SQLite技术实现框架</p>
<ul>
<li><code>Xcode6</code>中使用 <code>libsqlite3.0.dylib</code></li>
<li><code>Xcode7</code>中使用 <code>libsqlite3.0.tbd</code></li>
</ul>
<h2 id="一、添加sqlite-3-0-tbd"><a href="#一、添加sqlite-3-0-tbd" class="headerlink" title="一、添加sqlite.3.0.tbd"></a>一、添加sqlite.3.0.tbd</h2><ol>
<li>选中SQL工程</li>
<li>选中TARGETS中的SQL</li>
<li>选中General标签</li>
<li>将Lined Frameworks and Libraries前的小三角点开</li>
<li>点击加号</li>
<li>在搜索栏中输入sql</li>
<li>选中libsqlite3.0.tbd(libsqlites3.0.dylib)添加</li>
</ol>
<h2 id="二、打开关闭数据库"><a href="#二、打开关闭数据库" class="headerlink" title="二、打开关闭数据库"></a>二、打开关闭数据库</h2><p>首先创建一个DB类，继承自NSObject。</p>
<p>在.h文件中添加两个类方法</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 打开数据库</span></span><br><span class="line">+ (sqlite3 *)open;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 关闭数据库</span></span><br><span class="line">+ (<span class="keyword">void</span>)close;</span><br></pre></td></tr></table></figure>
<p>在.m文件中创建一个数据库指针</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个数据库指针</span></span><br><span class="line"><span class="keyword">static</span> sqlite3 *db = <span class="literal">nil</span>;</span><br></pre></td></tr></table></figure>
<p>实现打开数据库的方法</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 打开数据库</span></span><br><span class="line">+ (sqlite3 *)open</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 此方法的主要作用是打开数据库，准确的说是连接数据库</span></span><br><span class="line">    <span class="comment">// 返回值是一个数据库指针</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 防止多次打开数据库</span></span><br><span class="line">    <span class="keyword">if</span> (db != <span class="literal">nil</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> db;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 获取Documents路径</span></span><br><span class="line">    <span class="built_in">NSString</span> *docPath = [<span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSDocumentDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>) firstObject];</span><br><span class="line">    <span class="comment">// 获取数据库文件在沙盒中的路径</span></span><br><span class="line">    <span class="built_in">NSString</span> *sqlPath = [docPath stringByAppendingPathComponent:<span class="string">@"StuDB.sqlite"</span>];</span><br><span class="line">    <span class="comment">// 获取数据库文件在包中的路径</span></span><br><span class="line">    <span class="built_in">NSString</span> *filePath = [[<span class="built_in">NSBundle</span> mainBundle] pathForResource:<span class="string">@"StuDB.sqlite"</span> ofType:<span class="literal">nil</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 获取数据库管理类</span></span><br><span class="line">    <span class="comment">//NSFileManager *fileManager = [NSFileManager defaultManager];</span></span><br><span class="line">    <span class="comment">// 从包中将数据库拷贝到沙盒中</span></span><br><span class="line">    <span class="comment">//[fileManager copyItemAtPath:filePath toPath:sqlPath error:nil];</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 如果数据库已经存在则打开数据库，如果数据库不存在，就创建一个数据库。</span></span><br><span class="line">    <span class="comment">// 第一个参数是数据库路径</span></span><br><span class="line">    <span class="comment">// 第二个参数是指向数据库指针的指针</span></span><br><span class="line">    <span class="keyword">int</span> result = sqlite3_open(sqlPath.UTF8String, &amp;db);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (result == SQLITE_OK) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"数据库打开成功"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"数据库打开失败"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> db;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后实现关闭数据库方法</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 关闭数据库</span></span><br><span class="line">+ (<span class="keyword">void</span>)close</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 关闭数据库方法</span></span><br><span class="line">    sqlite3_close(db);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 置空数据库指针</span></span><br><span class="line">    db = <span class="literal">nil</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意，在关闭数据库时，一定要将数据库指针置空，否则下次就无法打开数据库。</p>
</blockquote>
<h2 id="三、创建表"><a href="#三、创建表" class="headerlink" title="三、创建表"></a>三、创建表</h2><p>新建一个Student类，继承自NSObject。</p>
<p>在头文件中引入DB.h</p>
<p>在.h文件中声明属性、初始化方法、构造器、创建表的类方法</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Student</span> : <span class="title">NSObject</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="keyword">int</span> ID;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">copy</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *name;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">copy</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *gender;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">instancetype</span>)initWithID:(<span class="keyword">int</span>)ID name:(<span class="built_in">NSString</span> *)name gender:(<span class="built_in">NSString</span> *)gender;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">instancetype</span>)studentWithID:(<span class="keyword">int</span>)ID name:(<span class="built_in">NSString</span> *)name gender:(<span class="built_in">NSString</span> *)gender;</span><br><span class="line"></span><br><span class="line">+ (<span class="keyword">void</span>)createTable;</span><br></pre></td></tr></table></figure>
<p>实现创建表方法</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)createTable</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 准备sql语句</span></span><br><span class="line">    <span class="built_in">NSString</span> *sqlString = <span class="string">@"create table if not exists stu (ID integer primary key, name text not null, gender text default "</span>男<span class="string">");</span></span><br><span class="line"><span class="string">    // 打开数据库</span></span><br><span class="line"><span class="string">    sqlite3 *db = [DB open];</span></span><br><span class="line"><span class="string">    // 执行sql语句</span></span><br><span class="line"><span class="string">    int result = sqlite3_exec(db,sqlString.UTF8String, NULL, NULL, NULL);</span></span><br><span class="line"><span class="string">   </span></span><br><span class="line"><span class="string">    if (result == SQLITE_OK) &#123;</span></span><br><span class="line"><span class="string">        NSLog(@"</span>建表成功<span class="string">");</span></span><br><span class="line"><span class="string">    &#125; else &#123;</span></span><br><span class="line"><span class="string">        NSLog(@"</span>建表失败<span class="string">");</span></span><br><span class="line"><span class="string">    &#125;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    // 关闭数据库</span></span><br><span class="line"><span class="string">    [DB close];</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意，在这里一定要打开数据库，然后等执行完毕后要关闭数据库。</p>
</blockquote>
<h2 id="四、增删改查"><a href="#四、增删改查" class="headerlink" title="四、增删改查"></a>四、增删改查</h2><p>在Student.h文件中添加类方法的声明</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取所有Student数据</span></span><br><span class="line">+ (<span class="built_in">NSArray</span> *)allStudents;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据指定ID，查找学生</span></span><br><span class="line">+ (Student *)findStudentByID:(<span class="keyword">int</span>)ID;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 插入一条ID</span></span><br><span class="line">+ (<span class="keyword">void</span>)insertStudentWithID:(<span class="keyword">int</span>)ID name:(<span class="built_in">NSString</span> *)name gender:(<span class="built_in">NSString</span> *)gender;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 更新指定ID下的姓名和性别</span></span><br><span class="line">+ (<span class="keyword">void</span>)updateStudentName:(<span class="built_in">NSString</span> *)name gender:(<span class="built_in">NSString</span> *)gender forID:(<span class="keyword">int</span>)ID;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据ID删除学生</span></span><br><span class="line">+ (<span class="keyword">void</span>)deleteStudentByID:(<span class="keyword">int</span>)ID;</span><br></pre></td></tr></table></figure>
<p>在.m文件中实现方法</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取所有Student数据</span></span><br><span class="line">+ (<span class="built_in">NSArray</span> *)allStudents</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 查询需要select语句</span></span><br><span class="line">    <span class="comment">// 不管对数据库进行什么操作，都需要连接数据库</span></span><br><span class="line">    sqlite3 *db = [DB open];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 创建需要执行的sql语句</span></span><br><span class="line">    <span class="built_in">NSString</span> *sqlString = <span class="string">@"select * from Students"</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 创建一个语句对象</span></span><br><span class="line">    sqlite3_stmt *stmt = <span class="literal">nil</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 此函数的作用是 生成一个语句对象，此时sql语句并没有执行，创建的语句对象保存了关联的数据库，执行的sql，语句的长度，这些信息。</span></span><br><span class="line">    <span class="comment">// 这是一个准备执行的语句</span></span><br><span class="line">    <span class="keyword">int</span> result = sqlite3_prepare_v2(db, sqlString.UTF8String, <span class="number">-1</span>, &amp;stmt, <span class="literal">nil</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 创建一个可变数组储存模型</span></span><br><span class="line">    <span class="built_in">NSMutableArray</span> *mArr = <span class="literal">nil</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (result == SQLITE_OK) &#123;</span><br><span class="line">        <span class="comment">// 可变数组开辟空间</span></span><br><span class="line">        mArr = [[<span class="built_in">NSMutableArray</span> alloc] initWithCapacity:<span class="number">0</span>];</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// SQLITE_ROW 仅用于查询语句，sqlite3_step() 函数执行后的结果如果是SQLITE_ROW，说明结果集里面还有数据，会自动跳转到下一条结果。如果已经是最后一条数据，再次执行sqlite3_step()，会返回SQLITE_DONE，结束整个查询过程。</span></span><br><span class="line">        <span class="keyword">while</span> (sqlite3_step(stmt) == SQLITE_ROW) &#123;</span><br><span class="line">            <span class="comment">// 获取记录中的字段值</span></span><br><span class="line">            <span class="comment">// 第一个参数 是语句对象，第二个参数 是字段下标，从0开始。</span></span><br><span class="line">            <span class="keyword">int</span> ID = sqlite3_column_int(stmt, <span class="number">0</span>);</span><br><span class="line">            <span class="built_in">NSString</span> *name = [<span class="built_in">NSString</span> stringWithUTF8String: (<span class="keyword">const</span> <span class="keyword">char</span> *)sqlite3_column_text(stmt, <span class="number">1</span>)];</span><br><span class="line">            <span class="built_in">NSString</span> *gender = [<span class="built_in">NSString</span> stringWithUTF8String: (<span class="keyword">const</span> <span class="keyword">char</span> *)sqlite3_column_text(stmt, <span class="number">2</span>)];</span><br><span class="line">            </span><br><span class="line">            Student *student = [Student studentWithID:ID name:name gender:gender];</span><br><span class="line">            [mArr addObject:student];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"查询所有数据成功"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"查询所有数据失败"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 不管语句对象执行与否，释放语句对象</span></span><br><span class="line">    sqlite3_finalize(stmt);</span><br><span class="line"></span><br><span class="line">    [DB close];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> mArr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据指定ID，查找学生</span></span><br><span class="line">+ (Student *)findStudentByID:(<span class="keyword">int</span>)ID</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 打开数据库</span></span><br><span class="line">    sqlite3 *db = [DB open];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSString</span> *sqlString = <span class="string">@"select * from Students where ID = ?"</span>;</span><br><span class="line">    </span><br><span class="line">    sqlite3_stmt *stmt = <span class="literal">nil</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> result = sqlite3_prepare_v2(db, sqlString.UTF8String, <span class="number">-1</span>, &amp;stmt, <span class="literal">nil</span>);</span><br><span class="line">    </span><br><span class="line">    Student *stu = <span class="literal">nil</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (result == SQLITE_OK) &#123;</span><br><span class="line">        <span class="comment">// 如果查询语句或者其他sql语句有条件，在准备语句对象的函数内部，sql语句中用？来代替条件，那么在语句执行之前，一定要绑定。</span></span><br><span class="line">        <span class="comment">// 1代表sql语句中第一个问号，问号的下标是从1开始</span></span><br><span class="line">        sqlite3_bind_int(stmt, <span class="number">1</span>, ID);</span><br><span class="line">        <span class="keyword">while</span> (sqlite3_step(stmt) == SQLITE_ROW) &#123;</span><br><span class="line">            <span class="comment">// 获取记录中的字段信息</span></span><br><span class="line">            <span class="built_in">NSString</span> *name = [<span class="built_in">NSString</span> stringWithUTF8String:(<span class="keyword">const</span> <span class="keyword">char</span> *)sqlite3_column_text(stmt, <span class="number">1</span>)];</span><br><span class="line">            <span class="built_in">NSString</span> *gender = [<span class="built_in">NSString</span> stringWithUTF8String:(<span class="keyword">const</span> <span class="keyword">char</span> *)sqlite3_column_text(stmt, <span class="number">2</span>)];</span><br><span class="line">            </span><br><span class="line">            stu = [Student studentWithID:ID name:name gender:gender];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"获取成功"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"获取失败"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 先释放语句对象</span></span><br><span class="line">    sqlite3_finalize(stmt);</span><br><span class="line"></span><br><span class="line">    [DB close];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> stu;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 插入一条ID</span></span><br><span class="line">+ (<span class="keyword">void</span>)insertStudentWithID:(<span class="keyword">int</span>)ID name:(<span class="built_in">NSString</span> *)name gender:(<span class="built_in">NSString</span> *)gender</span><br><span class="line">&#123;</span><br><span class="line">    sqlite3 *db = [DB open];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSString</span> *sqlString = <span class="string">@"insert into Students values (?, ?, ?)"</span>;</span><br><span class="line">    </span><br><span class="line">    sqlite3_stmt *stmt = <span class="literal">nil</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> result = sqlite3_prepare(db, sqlString.UTF8String, <span class="number">-1</span>, &amp;stmt, <span class="literal">nil</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (result == SQLITE_OK) &#123;</span><br><span class="line">        <span class="comment">// 绑定</span></span><br><span class="line">        sqlite3_bind_int(stmt, <span class="number">1</span>, ID);</span><br><span class="line">        sqlite3_bind_text(stmt, <span class="number">2</span>, name.UTF8String, <span class="number">-1</span>, <span class="literal">nil</span>);</span><br><span class="line">        sqlite3_bind_text(stmt, <span class="number">3</span>, gender.UTF8String, <span class="number">-1</span>, <span class="literal">nil</span>);</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// 执行语句</span></span><br><span class="line">        sqlite3_step(stmt);</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"插入成功"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"插入失败"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 释放语句对象</span></span><br><span class="line">    sqlite3_finalize(stmt);</span><br><span class="line"></span><br><span class="line">    [DB close];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 更新指定ID下的姓名和性别</span></span><br><span class="line">+ (<span class="keyword">void</span>)updateStudentName:(<span class="built_in">NSString</span> *)name gender:(<span class="built_in">NSString</span> *)gender forID:(<span class="keyword">int</span>)ID</span><br><span class="line">&#123;</span><br><span class="line">    sqlite3 *db = [DB open];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSString</span> *sqlString = <span class="string">@"update Students set name = ?, gender = ? where ID = ?"</span>;</span><br><span class="line">    </span><br><span class="line">    sqlite3_stmt *stmt = <span class="literal">nil</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> result = sqlite3_prepare(db, sqlString.UTF8String, <span class="number">-1</span>, &amp;stmt, <span class="literal">nil</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (result == SQLITE_OK) &#123;</span><br><span class="line">        <span class="comment">// 绑定</span></span><br><span class="line">        sqlite3_bind_text(stmt, <span class="number">1</span>, name.UTF8String, <span class="number">-1</span>, <span class="literal">nil</span>);</span><br><span class="line">        sqlite3_bind_text(stmt, <span class="number">2</span>, gender.UTF8String, <span class="number">-1</span>, <span class="literal">nil</span>);</span><br><span class="line">        sqlite3_bind_int(stmt, <span class="number">3</span>, ID);</span><br><span class="line">        </span><br><span class="line">        sqlite3_step(stmt);</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"更新成功"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"更新失败"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    sqlite3_finalize(stmt);</span><br><span class="line"></span><br><span class="line">    [DB close];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 根据ID删除学生</span></span><br><span class="line">+ (<span class="keyword">void</span>)deleteStudentByID:(<span class="keyword">int</span>)ID</span><br><span class="line">&#123;</span><br><span class="line">    sqlite3 *db = [DB open];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSString</span> *sqlString = <span class="string">@"delete from Students where ID = ?"</span>;</span><br><span class="line">    </span><br><span class="line">    sqlite3_stmt *stmt = <span class="literal">nil</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> result = sqlite3_prepare(db, sqlString.UTF8String, <span class="number">-1</span>, &amp;stmt, <span class="literal">nil</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (result == SQLITE_OK) &#123;</span><br><span class="line">        <span class="comment">// 绑定</span></span><br><span class="line">        sqlite3_bind_int(stmt, <span class="number">1</span>, ID);</span><br><span class="line">        </span><br><span class="line">        sqlite3_step(stmt);</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"删除成功"</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"删除失败"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    sqlite3_finalize(stmt);</span><br><span class="line"></span><br><span class="line">    [DB close];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/02/26/Swift（一）基础部分 /">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZeroJi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZeroJi's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/02/26/Swift（一）基础部分 /" itemprop="url">Switf（一）基础部分</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-02-26T15:00:23+08:00">
                2016-02-26
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-04-28T17:01:18+08:00">
                2018-04-28
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="常量和变量"><a href="#常量和变量" class="headerlink" title="常量和变量"></a>常量和变量</h2><p>常量用let来声明，变量用var来声明</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> maximumNumberOfLoginAttempts = <span class="number">10</span></span><br><span class="line"><span class="keyword">var</span> currentLoginAttempt = <span class="number">0</span></span><br></pre></td></tr></table></figure>
<p>可以在一行中声明多个常量或者多个变量，用逗号隔开</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> x = <span class="number">0.0</span>, y = <span class="number">0.0</span>, z = <span class="number">0.0</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果你的代码中有不需要改变的值，请使用<code>let</code>关键字将它声明为常量。只将需要改变的值声明为变量。</p>
</blockquote>
<h2 id="类型标注"><a href="#类型标注" class="headerlink" title="类型标注"></a>类型标注</h2><p>声明常量或者变量的时候可以加上类型标注，说明常量或者变量中要储存的值的类型。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> welcomeMessage: <span class="type">String</span> <span class="comment">// String是类型名称</span></span><br></pre></td></tr></table></figure>
<p><code>welcomeMessage</code>变量现在可以被设置成任意字符串</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">welcomeMessage = <span class="string">"Hello"</span></span><br></pre></td></tr></table></figure>
<p>同理，也可以在一行中定义多个同样类型的变量，用逗号分割，病在最后一个变量名之后添加类型标注</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> red, green, blue: <span class="type">Double</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>一般我们很少给常量或者变量加类型标注。Swift会根据在初始值推断变量或者常量的类型。</p>
</blockquote>
<h2 id="常量和变量的命名"><a href="#常量和变量的命名" class="headerlink" title="常量和变量的命名"></a>常量和变量的命名</h2><p>可以使用任何字符作为常量和变量名</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> π = <span class="number">3.14159</span></span><br><span class="line"><span class="keyword">let</span> 你好 = <span class="string">"你好世界"</span></span><br><span class="line"><span class="keyword">let</span> 🐶🐮 = <span class="string">"dogcow"</span></span><br></pre></td></tr></table></figure>
<p>命名不能以数字开头，且不能包含数学符号，箭头，保留的Unicode码位，连线与制表符。</p>
<blockquote>
<p>如果要以与Swift保留关键字相同的名称命名，可以使用反引号(`)将关键字包围的方式。除非别无选择，否则不应该以系统保留关键字命名。</p>
</blockquote>
<h2 id="输出常量和变量"><a href="#输出常量和变量" class="headerlink" title="输出常量和变量"></a>输出常量和变量</h2><p>可以使用<code>print()</code>来输出</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(welcomeMessage)</span><br></pre></td></tr></table></figure>
<p>也可以把<code>welcomeMessage</code>的值输出</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">"welcomeMessage = \(welcomeMessage)"</span>)</span><br></pre></td></tr></table></figure>
<p>在这里提一个不方便的地方，就是当在<code>print()</code>中使用变量值的时候，代码不能自动补全。</p>
<h2 id="分号"><a href="#分号" class="headerlink" title="分号"></a>分号</h2><p>Swift不强制使用分号结尾，使用分号可以，不使用也可以，视个人习惯而定。有一种情况例外，就是当一行中有多个独立语句的时候，需要用分号隔开</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> cat = <span class="string">"cat"</span>;<span class="built_in">print</span>(cat)</span><br></pre></td></tr></table></figure>
<h2 id="整数"><a href="#整数" class="headerlink" title="整数"></a>整数</h2><p>Swift提供了很多范围不同的整数，如<code>Int8</code>，<code>Int16</code>，<code>Int32</code>，<code>Int64</code>等。如果在整数类型前面加<code>U</code>，意味这此整数类型为无符号整型，如<code>UInt8</code>。</p>
<p>Swift中提供了获取整数最大值和最小值的函数</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> minValue = <span class="type">UInt8</span>.<span class="built_in">min</span></span><br><span class="line">ket maxValue = <span class="type">Uint8</span>.<span class="built_in">max</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>一般来说，不需要专门指定整数的长度。Swift提供了两个特殊的整数类型<code>Int</code>、<code>UInt</code>，长度与当前平台的原生字长相同。为了代码的可读性和可重复性考虑，统一使用<code>Int</code>较好。</p>
</blockquote>
<h2 id="浮点数"><a href="#浮点数" class="headerlink" title="浮点数"></a>浮点数</h2><p>Swift提供了两个有符号的浮点数类型</p>
<ul>
<li><code>Double</code>表示64位浮点数。</li>
<li><code>Float</code>表示32位浮点数。</li>
</ul>
<blockquote>
<p><code>Double</code>精度很高，可以精确到小数点后15位数字。<code>Float</code>只有6位数字。</p>
</blockquote>
<h2 id="类型安全和类型推断"><a href="#类型安全和类型推断" class="headerlink" title="类型安全和类型推断"></a>类型安全和类型推断</h2><p>Swift是一个<em>类型安全的语言</em>。类型安全的语言可以让你清楚地知道代码要处理的值的类型。<br>由于Swift是类型安全的，所以它会在编译你的代码时进行<em>类型检查</em>，并把不匹配的类型标记为错误。<br>当要处理不同类型的值时，类型检查可以帮助避免错误。然而，并不是说每次声明常量和变量的时候都需要显式指定类型。如果没有显式指定类型，Swift会使用<em>类型推断</em>来选择合适的类型。有了类型推断，编译器可以在编译代码的时候自动推断出表达式的类型。原理很简单，只要检查赋的值即可。<br>声明常量或者变量并赋初值的时候类型推断非常有用。当在声明常量或者变量的时候赋给它们一个字面量，即可出发类型推断。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> meaningOfLife = <span class="number">42</span> <span class="comment">// meaningOfLife 会被推断为Int类型</span></span><br><span class="line"><span class="keyword">let</span> pi = <span class="number">3.14159</span> <span class="comment">// pi 会被推测为Double类型</span></span><br><span class="line"><span class="keyword">let</span> anotherPi = <span class="number">3</span> + <span class="number">0.14159</span> <span class="comment">// anotherPi 会被推测为Double类型</span></span><br></pre></td></tr></table></figure>
<p>原始值<code>3</code>没有显式声明类型，而表达式中出现了一个浮点字面量，所以表达式会被推断为<code>Double</code>类型。</p>
<h2 id="数值型字面量"><a href="#数值型字面量" class="headerlink" title="数值型字面量"></a>数值型字面量</h2><p>整数字面量可以被写作</p>
<ul>
<li>一个<em>十进制数</em>，没有前缀</li>
<li>一个<em>二进制数</em>，前缀是<code>0b</code></li>
<li>一个<em>八进制数</em>，前缀是<code>0o</code></li>
<li>一个<em>十六进制数</em>，前缀是<code>0x</code></li>
</ul>
<p>下面的所有整数字面量的十进制值都是<code>17</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> decimalInteger = <span class="number">17</span></span><br><span class="line"><span class="keyword">let</span> binaryInteger = <span class="number">0b1001</span> <span class="comment">// 二进制</span></span><br><span class="line"><span class="keyword">let</span> octalInteger = <span class="number">0o21</span> <span class="comment">// 八进制</span></span><br><span class="line"><span class="keyword">let</span> hexadecimalInteger = <span class="number">0x11</span> <span class="comment">// 十六进制</span></span><br></pre></td></tr></table></figure>
<p>浮点字面量可以是十进制（没有前缀）或者是十六进制（前缀是<code>0x</code>）。小数点两边必须有至少一个十进制数字（或者是十六进制的数字）。十进制浮点数也可以有一个可选的指数（exponent)，通过大写或者小写的<code>e</code>来指定；十六进制浮点数必须有一个指数，通过大写或者小写的<code>p</code>来指定。</p>
<p>如果一个十进制数的指数为<code>exp</code>，那这个数相当于基数和10^exp的乘积：</p>
<ul>
<li><code>1.25e2</code> 表示 1.25 × 10^2，等于 125.0。</li>
<li><code>1.25e-2</code> 表示 1.25 × 10^-2，等于 0.0125。</li>
</ul>
<p>如果一个十六进制数的指数为<code>exp</code>，那这个数相当于基数和2^exp的乘积：</p>
<ul>
<li><code>0xFp2</code> 表示 15 × 2^2，等于 60.0。</li>
<li><code>0xFp-2</code> 表示 15 × 2^-2，等于 3.75。</li>
</ul>
<p>下面的所有浮点字面量都等于十进制的<code>12.1875</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> decimalDouble = <span class="number">12.1875</span></span><br><span class="line"><span class="keyword">let</span> exponentDouble = <span class="number">1.21875e1</span></span><br><span class="line"><span class="keyword">let</span> hexadecimalDouble = <span class="number">0xC.3p0</span></span><br></pre></td></tr></table></figure>
<p>数值类字面量可以包括额外的格式来增强可读性。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> paddedDboule = <span class="number">000123.456</span></span><br><span class="line"><span class="keyword">let</span> oneMillion = <span class="number">1_000_000</span></span><br><span class="line"><span class="keyword">let</span> justOverOneMillion = <span class="number">1_000_000.000_000_1</span></span><br></pre></td></tr></table></figure>
<h2 id="整数转换"><a href="#整数转换" class="headerlink" title="整数转换"></a>整数转换</h2><p>要将一种数字类型转换成另一种，你要用当前值来初始化一个期望类型的新数字，这个数字的类型就是你的目标类型。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> twoThousand: <span class="type">UInt16</span> = <span class="number">2_000</span></span><br><span class="line"><span class="keyword">let</span> one: <span class="type">UInt8</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">let</span> twoThousandAndOne = twoThousand + <span class="type">UInt16</span>(one)</span><br></pre></td></tr></table></figure>
<p>现在两个类型都为<code>UInt16</code>，可以进行相加。目标常量<code>twoThousandAndOne</code>的类型被推断为<code>UInt16</code>。</p>
<p><code>SomeType(ofInitialValue)</code>是调用Swift构造器并传入一个初始值的默认方法。</p>
<h2 id="整数和浮点数转换"><a href="#整数和浮点数转换" class="headerlink" title="整数和浮点数转换"></a>整数和浮点数转换</h2><p>整数和浮点数的转换必须显式指定类型</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> three = <span class="number">3</span></span><br><span class="line"><span class="keyword">let</span> pointOneFourOneFiveNine = <span class="number">0.14159</span></span><br><span class="line"><span class="keyword">let</span> newPi = <span class="type">Double</span>(three) + pointOneFourOneFiveNine <span class="comment">// newPi 等于 3.14159，所以被推测为 Double 类型</span></span><br></pre></td></tr></table></figure>
<p>浮点数到整数的反向转换同样行，整数类型可以用<code>Double</code>或者<code>Float</code>类型来初始化</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> integerPi = <span class="type">Int</span>(newPi) <span class="comment">// integerPi 等于3，所以被推测为 Int 类型</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>字面量<code>3</code>可以直接和字面量<code>0.14159</code>相加，因为数字字面量本身没有明确的类型。</p>
</blockquote>
<h2 id="类型别名"><a href="#类型别名" class="headerlink" title="类型别名"></a>类型别名</h2><p>类型别名就是给现有类型定义另一个名字。可以使用<code>typealias</code>关键字来定义类型别名。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typealias</span> <span class="type">AudioSample</span> = <span class="type">UInt16</span></span><br></pre></td></tr></table></figure>
<p>定义了一个类型别名之后，你可以在任何使用原始名的地方使用别名</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> maxAmplitudeFound = <span class="type">AudioSample</span>.<span class="built_in">min</span> <span class="comment">// AudioSample.min 等同于 UInt16.min</span></span><br></pre></td></tr></table></figure>
<h2 id="布尔值"><a href="#布尔值" class="headerlink" title="布尔值"></a>布尔值</h2><p>Swift有一个基本布尔类型，交错<code>Bool</code>。布尔值只能是真或假（<code>true</code>和<code>false</code>）</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> orangesAreOrange = <span class="literal">true</span></span><br><span class="line"><span class="keyword">let</span> turnipsAreDelicious = <span class="literal">false</span></span><br></pre></td></tr></table></figure>
<p><code>orangesAreOrange</code>和<code>turnipsAreDelicious</code>的类型会被推断为Bool。</p>
<p>当便携条件语句，比如<code>if</code>语句的时候，布尔值很有用</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> turnipsAreDelicious &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Mmm, tasty turnips!"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Eww, turnips are horrible."</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果在需要使用<code>Bool</code>类型的地方使用了非布尔值，Swift就会报错</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> i = <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> i &#123;</span><br><span class="line">    <span class="comment">// 这个例子不会通过编译，会报错</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然而下面这个语句是合法的</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> i == <span class="number">1</span> &#123;</span><br><span class="line">    <span class="comment">//这个例子会编译成功</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>i == 1</code>的返回类型为布尔值，所以编译能成功。</p>
<h2 id="元组"><a href="#元组" class="headerlink" title="元组"></a>元组</h2><p><em>元组</em>把多个值合成一个复合值。元组内可以是任意类型，并且可以不同。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> http404Error = (<span class="number">404</span>, <span class="string">"Not Found"</span>) <span class="comment">// http404Error 的类型是 (Int, String)，值是 (404, "Not Found")</span></span><br></pre></td></tr></table></figure>
<p><code>(404, &quot;Not Fount&quot;)</code>把一个<code>Int</code>值和一个<code>String</code>值组合起来表示HTTP状态码的两个部分：一个数字和一个可读的描述。</p>
<p>可以把一个元组的内容分解成单独的常量和变量</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> (statusCode, statusMessage) = http404Error <span class="comment">// 分解元组</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"The status code is \(statusCode)"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"The status message is \(statusMessage)"</span>)</span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">如果只需要一部分元组值，分解的时候可以把要忽略的部分用下划线(`<span class="number">_</span>`)标记</span><br><span class="line"></span><br><span class="line">```swift</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"The status code is \(statusCode)"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"The status message is \(statusMessage)"</span>)</span><br></pre></td></tr></table></figure>
<p>还可以通过下标来访问元组中的元素</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">printprint(<span class="string">"The status code is \(http404Error.0)"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"The status message is \(http404Error.1)"</span>)</span><br></pre></td></tr></table></figure>
<p>可以在定义元组的时候给元素命名，之后可以通过名字来获取元素</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> http200Status = (statusCode: <span class="number">200</span>, description: <span class="string">"OK"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"The status code is \(http200Status.statusCode)"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"The status message is \(http200Status.description)"</span>)</span><br></pre></td></tr></table></figure>
<p>作为函数返回值时，元组很有用。</p>
<blockquote>
<p>元组在临时组织值的时候很有用，但是不太适合创建复杂的数据结构。</p>
</blockquote>
<h2 id="可选类型"><a href="#可选类型" class="headerlink" title="可选类型"></a>可选类型</h2><p>使用<em>可选类型</em>来处理值可能缺失的情况。可选类型有两种情况</p>
<ul>
<li>有值，等于某个值</li>
<li>无值，等于nil</li>
</ul>
<p>Swift有一种构造器，多用是将一个<code>String</code>值转换为一个<code>Int</code>值。并不是所有字符串都可以转换为整数。字符串<code>&quot;123&quot;</code>可以被转换为整数<code>123</code>，<code>&quot;zero&quot;</code>不行。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> possibleNumber = <span class="string">"123"</span></span><br><span class="line"><span class="keyword">let</span> convertedNumber = <span class="type">Int</span>(possibleNumber) <span class="comment">// convertedNumber 被推测为类型"Int?"，或者类型"optional Int"</span></span><br></pre></td></tr></table></figure>
<p>因为该构造器可能会失败，所以它返回一个<em>可选类型</em><code>Int</code>，而不是<code>Int</code></p>
<p><code>nil</code>类型只能用于给<code>type?</code>类型的常量或者变量赋值</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> serverResponseCode: <span class="type">Int</span>? = <span class="number">404</span></span><br><span class="line">serverResponseCode = <span class="literal">nil</span></span><br></pre></td></tr></table></figure>
<p>如果声明了一个可选常量或者变量但是没有赋值，它们会自动被设置为<code>nil</code></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> survetAnswer: <span class="type">String</span>?<span class="comment">// surveyAnswer 被自动设置为 nil</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>在OC中，<code>nil</code>是一个指向不存在对象的指针。在Swift中，<code>nil</code>不是指针，它是一个确定的值，用来表示值缺失。任何类型的可选状态都可以被设置为<code>nil</code>，不只是对象类型。</p>
</blockquote>
<h2 id="if语句以及强行解析"><a href="#if语句以及强行解析" class="headerlink" title="if语句以及强行解析"></a>if语句以及强行解析</h2><p>你可以使用<code>if</code>语句和<code>nil</code>语句来判断一个可选值是否包含值。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> convertedNumber != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"convertedNumber contains some integer value."</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>当确定可选类型确实包含值之后，可以在可选的名字后面加一个感叹号(<code>!</code>)来获取值。感叹号代表”我知道这个可选类型的值有值，请使用它“，这被称为可选值的<em>强制解析</em></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> convertedNumber != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"convertedNumber has an integer value of \(convertedNumber!)."</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="可选绑定"><a href="#可选绑定" class="headerlink" title="可选绑定"></a>可选绑定</h2><p>使用<em>可选绑定</em>来判断可选类型是否包含值，如果包含就把值赋给一个临时常量或者变量。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> actualNumber = <span class="type">Int</span>(possibleNumber) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"\'\(possibleNumber)\' has an integer value of \(actualNumber)"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"\'\(possibleNumber)\' could not be converted to an integer"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以包含多个可选绑定在<code>if</code>语句中，并使用<code>where</code>子句做布尔值判断。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> firstNumber = <span class="type">Int</span>(<span class="string">"4"</span>), secondNumber = <span class="type">Int</span>(<span class="string">"42"</span>) <span class="keyword">where</span> firstNumber &lt; secondNumber &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"\(firstNumber) &lt; \(secondNumber)"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="隐形可选类型"><a href="#隐形可选类型" class="headerlink" title="隐形可选类型"></a>隐形可选类型</h2><p>有时候在程序架构中，第一次被赋值之后，可以确定一个可选类型_总会_有值。在这种情况下，每次都要判断和解析可选值是非常低效的，因为可以确定它总会有值。</p>
<p>这种类型的可选状态被定义为隐式解析可选类型。把想要用作可选的类型的后面的问号(<code>String?</code>)改成感叹号(<code>String!</code>)来声明一个隐式解析可选类型。</p>
<p>一个隐式解析可选类型其实就是一个普通的可选类型，但是可以被当作非可选类型来使用，并不需要每次都使用解析来获取可选值。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> possibleString: <span class="type">String</span>? = <span class="string">"An optional string."</span></span><br><span class="line"><span class="keyword">let</span> forcedString: <span class="type">String</span> = possibleString! <span class="comment">// 需要惊叹号来获取值</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> assumedString: <span class="type">String</span>! = <span class="string">"An implicitly unwrapped optional string."</span></span><br><span class="line"><span class="keyword">let</span> implicitString: <span class="type">String</span> = assumedString  <span class="comment">// 不需要感叹号</span></span><br></pre></td></tr></table></figure>
<p>可以把隐式解析可选类型当做一个可以自动解析的可选类型。你要做的只是声明的时候把感叹号放到类型的结尾，而不是每次取值的可选名字的结尾。</p>
<blockquote>
<p>如果在隐式可选类型没有值的时候尝试取值，会触发运行错误。</p>
</blockquote>
<p>可以把隐式解析可选类型当作普通可选类型来判断它是否包含值，也可以在可选绑定中使用它来检查并解析它的值。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> assumedString != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(assumedString)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> definiteString = assumedString &#123;</span><br><span class="line">    <span class="built_in">print</span>(definiteString)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>如果一个变量之后可能变成<code>nil</code>的话请不要使用隐式解析可选类型。</p>
</blockquote>
<h2 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h2><p>可以使用<em>错误处理</em>来应对程序执行中可能会遇到的错误条件。</p>
<p>一个函数可以通过在声明中添加<code>throws</code>关键词来抛出错误消息。当抛出错误消息时，应该在表达式中前置<code>try</code>关键词</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">canThrowAnError</span><span class="params">()</span></span> <span class="keyword">throws</span> &#123;</span><br><span class="line">    <span class="comment">// 这个函数可能抛出错误</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">do</span> &#123;</span><br><span class="line">    <span class="keyword">try</span> canThrowAnError() <span class="comment">// 没有错误信息抛出</span></span><br><span class="line">&#125; <span class="keyword">catch</span> &#123;</span><br><span class="line">    <span class="comment">// 有一个错误信息抛出</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>一个<code>do</code>语句创建了一个新的包含作用域，使得错误能被传播到一个或者多个<code>catch</code>从句。</p>
<h2 id="断言"><a href="#断言" class="headerlink" title="断言"></a>断言</h2><p>可选类型可以判断值是否存在，可以在代码中处理值缺失的情况。然而，在某些情况下，如果值缺失或者值并不满足特定的条件，代码可能没办法继续执行。这时，可以在代码中触发一个<em>断言</em>来结束代码运行并通过调试来找到值的缺失的原因。</p>
<p>断言会在运行时判断一个逻辑条件是否为<code>true</code>。如果为<code>true</code>继续进行代码，如果为<code>false</code>，代码执行结束，应用终止。</p>
<p>使用全局`assert(_:_file:line:)函数来写一个断言。</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> age = -<span class="number">3</span></span><br><span class="line"><span class="built_in">assert</span>(age &gt;= <span class="number">0</span>, <span class="string">"A person's age connot be less than zero"</span>) <span class="comment">// 因为 age &lt; 0，所以断言会触发</span></span><br></pre></td></tr></table></figure>
<p>如果不需要断言信息，可以省略</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">assert</span>(age &gt;= <span class="number">0</span>)</span><br></pre></td></tr></table></figure>
<blockquote>
<p>当代码使用优化编译的时候，断言将会被禁用，例如在 Xcode 中，使用默认的 target Release 配置选项来 build 时，断言会被禁用。</p>
</blockquote>
<hr>
<p>本次学习全程参考<a href="http://wiki.jikexueyuan.com/project/swift/chapter2/01_The_Basics.html" target="_blank" rel="noopener">Swift教程</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/02/26/iOS进阶（一）数据处理之文件读写/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZeroJi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZeroJi's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/02/26/iOS进阶（一）数据处理之文件读写/" itemprop="url">iOS进阶（一）数据处理之文件读写</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-02-26T15:00:23+08:00">
                2016-02-26
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-04-28T17:01:01+08:00">
                2018-04-28
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="一、沙盒机制"><a href="#一、沙盒机制" class="headerlink" title="一、沙盒机制"></a>一、沙盒机制</h1><h3 id="沙盒机制"><a href="#沙盒机制" class="headerlink" title="沙盒机制"></a>沙盒机制</h3><ul>
<li>每一个应用程序都会拥有一个应用程序沙盒</li>
<li>应用程序沙盒就是一个文件系统目录</li>
</ul>
<h3 id="iOS中的沙盒机制"><a href="#iOS中的沙盒机制" class="headerlink" title="iOS中的沙盒机制"></a>iOS中的沙盒机制</h3><ul>
<li>沙盒是一种<em>安全体系</em></li>
<li>TA规定了应用程序只能在为该程序创建的文件夹（沙盒）内访问文件，不可以访问其他沙盒内的内容（iOS8已经部分开放访问）</li>
<li>所有的非代码文件都保存在这个地方，比如图片、音乐、属性列表（plist）、sqlite数据库和文本文件等</li>
</ul>
<h3 id="沙盒机制的特点"><a href="#沙盒机制的特点" class="headerlink" title="沙盒机制的特点"></a>沙盒机制的特点</h3><ul>
<li>每个应用程序的活动范围都限定在自己的沙盒里面</li>
<li>不能随意跨越自己的沙盒去访问别的应用程序沙盒中的内容（iOS已经部分开放访问）</li>
<li>应用程序向外请求或接受数据都需要经过权限认证</li>
</ul>
<h3 id="前往沙盒路径方法"><a href="#前往沙盒路径方法" class="headerlink" title="前往沙盒路径方法"></a>前往沙盒路径方法</h3><ul>
<li>选中要前往的路径，右键</li>
<li>选中Services选项</li>
<li>点击Reveal in Finder</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/1520415-6476cd9dd6e71e4a.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="前往沙盒路径.png"></p>
<h3 id="沙盒中的文件夹"><a href="#沙盒中的文件夹" class="headerlink" title="沙盒中的文件夹"></a>沙盒中的文件夹</h3><ul>
<li>Documents：保存应用运行时生成的需要持久化的数据，iTunes会自动备份该目录</li>
<li>Library：存储程序的默认设置和其他状态信息，iTunes会自动备份该目录。<ul>
<li>Library/Caches：存放缓存文件，iTunes不会备份此目录，次目录下文件不会在应用退出删除。</li>
<li>Library/Preferences：保存应用的所有偏好设置，iOS的Settings（设置）应用会在该目录中查找应用的设置信息，iTunes会自动备份该目录。注意：<em>你不会直接创建偏好设置文件，二十应该使用NSUserDefaults类来获得和设置应用程序的偏好</em></li>
</ul>
</li>
<li>tmp：保存应用运行时所需的临时数据，使用完毕后再将相应的文件从该目录删除。应用没有运行时，系统也有可能会清楚该目录下的文件，iTunes不会同步该目录。iphone重启时，该目录下的文件会被删除</li>
</ul>
<p>获取Documents目录</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *docPath = [<span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSDocumentsDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>) firstObject];</span><br></pre></td></tr></table></figure>
<p>获取tmp目录</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *tmpPath  = <span class="built_in">NSTemporaryDirectory</span>();</span><br></pre></td></tr></table></figure>
<p>获取Library目录</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *libPath = [<span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSLibraryDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>) firstObject];</span><br></pre></td></tr></table></figure>
<p>获取Library/Caches目录</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *cachePath = [[<span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSCachesDirectory</span>,<span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>) firstObject];</span><br></pre></td></tr></table></figure>
<p>获取Library/Preferences目录</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *libPath = [[<span class="built_in">NSSeachForPathDirectoriesInDomains</span>(<span class="built_in">NSLibraryDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>) firstObject];</span><br><span class="line"><span class="built_in">NSString</span> *prePath = [libPath stringByAppendingPathComponent:<span class="string">@"Preferences"</span>];</span><br></pre></td></tr></table></figure>
<p>应用程序包所在位置</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *path = [<span class="built_in">NSBundle</span> mainBundle].resourcePth;</span><br></pre></td></tr></table></figure>
<h1 id="二、简单对象的读写（I-O）操作"><a href="#二、简单对象的读写（I-O）操作" class="headerlink" title="二、简单对象的读写（I/O）操作"></a>二、简单对象的读写（I/O）操作</h1><p>iOS中提供4种类型可以直接进行文件存取:<br><em>NSString、NSArray、NSDictionary、NSData</em>，<br><em>以上类型包含子类</em></p>
<p>字符串写入沙盒</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在Documents下面创建一个文本路径，假设文本名称为bada.txt</span></span><br><span class="line"><span class="built_in">NSString</span> *txtPath = [docPath stringByAppendingPathComponent:<span class="string">@"bada.txt"</span>];<span class="comment">// 此时仅存在路径，文件并没有真实存在</span></span><br><span class="line"><span class="built_in">NSString</span> *string = <span class="string">@"中二洪荒巴达之力"</span>;</span><br><span class="line">[string writeToFile:txtPath atomically:<span class="literal">YES</span> encoding:<span class="built_in">NSUTF8StringEncoding</span> error:<span class="literal">nil</span>];<span class="comment">// 字符串写入时执行的代码</span></span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, txtPath);</span><br></pre></td></tr></table></figure>
<p>从文件中读取字符串的方法</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *resultString = [<span class="built_in">NSString</span> stringWithContentsOfFile:txtPath encoding:<span class="built_in">NSUTF8StringEncoding</span> error:<span class="literal">nil</span>];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, resultString);</span><br></pre></td></tr></table></figure>
<p>数组写入文件</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个存储数组的文件路径</span></span><br><span class="line"><span class="built_in">NSString</span> *filePath = [docPath stringByAppendingPathComponent:<span class="string">@"girl.txt"</span>];</span><br><span class="line"><span class="built_in">NSArray</span> *arr = @[<span class="string">@"妈"</span>, <span class="string">@"的"</span>, <span class="string">@"智"</span>, <span class="string">@"障"</span>];</span><br><span class="line">[arr writeToFile:filePath atomically:<span class="literal">YES</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, filePath);</span><br></pre></td></tr></table></figure>
<p>从文件中读取数组的方法</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSArray</span> *resultArr = [<span class="built_in">NSArray</span> arrayWithContentsOfFile:filePath];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, resultArr);</span><br></pre></td></tr></table></figure>
<p>字典写入文件</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *dicPath = [docPath stringByAppendingString:<span class="string">@"dic.txt"</span>];</span><br><span class="line"><span class="built_in">NSDictionary</span> *dic = @&#123;<span class="string">@"你"</span> : <span class="string">@"智障"</span>, <span class="string">@"我"</span> : <span class="string">@"机智"</span>&#125;;</span><br><span class="line">[dic writeToFile:dicPath atomically:<span class="literal">YES</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, dicPath);</span><br></pre></td></tr></table></figure>
<p>从文件中读取字典</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSDictionary</span> *resultDic = [<span class="built_in">NSDictionary</span> dictionaryWithContentsOfFile:dicPath];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, resultDic);</span><br></pre></td></tr></table></figure>
<p>NSData写入文件</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSString</span> *dataPath = [docPath stringByAppendingPathComponent:<span class="string">@"icon"</span>];</span><br><span class="line"><span class="comment">// 得到一个UIImage对象</span></span><br><span class="line"><span class="built_in">UIImage</span> *image = [<span class="built_in">UIImage</span> imageNamed:<span class="string">@"icon.jpg"</span>];</span><br><span class="line"><span class="comment">// 将UIImage对象转换成NSData对象</span></span><br><span class="line"><span class="built_in">NSData</span> *data = <span class="built_in">UIImageJPEGRepresentation</span>(image, <span class="number">1.0</span>);</span><br><span class="line">[data writeToFile:dataPath atomically:<span class="literal">YES</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, dataPath);</span><br></pre></td></tr></table></figure>
<p>从文件中读取NSData文件</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSData</span> *resultData = [<span class="built_in">NSData</span> dataWithContentsOfFile:dataPath];</span><br><span class="line"><span class="comment">// 将得到的NSData数据转换为原有的图片对象</span></span><br><span class="line"><span class="built_in">UIImage</span> *resultImage = [<span class="built_in">UIImage</span> imageWithData:resultData];</span><br><span class="line"><span class="comment">// 显示图片</span></span><br><span class="line"><span class="built_in">UIImageView</span> *imageView = [[<span class="built_in">UIImageView</span> alloc ] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="keyword">self</span>.view.frame.size.width, <span class="keyword">self</span>.view.frame.size.height)];</span><br><span class="line">imageView.image = resultImage;</span><br><span class="line">[<span class="keyword">self</span>.view addSubview:imageView];</span><br></pre></td></tr></table></figure>
<p>以上的运行结果都可以从沙盒路径中的文件夹中看到</p>
<h1 id="三、文件管理器与文件对接器"><a href="#三、文件管理器与文件对接器" class="headerlink" title="三、文件管理器与文件对接器"></a>三、文件管理器与文件对接器</h1><ul>
<li>文件管理器（NSFileManager)：此类主要是对文件进行的操作（<em>创建/从删除/改名</em>等）以及文件<em>信息的获取</em></li>
<li>文件连接器（NSFileHandle）：此类主要是对内容进行<em>读取和写入操作</em></li>
</ul>
<h3 id="文件管理器的使用"><a href="#文件管理器的使用" class="headerlink" title="文件管理器的使用"></a>文件管理器的使用</h3><p>创建文件夹</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">IBAction</span>)createDirectory:(<span class="built_in">UIButton</span> *)sender</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 1.找到Caches的路径</span></span><br><span class="line">    <span class="built_in">NSString</span> *cachePath = [<span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSCachesDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>) firstObject];</span><br><span class="line">    <span class="comment">// 2.获取创建的文件夹的路径</span></span><br><span class="line">    <span class="built_in">NSString</span> *directoryPath = [cachePath stringByAppendingPathComponent:<span class="string">@"downloadImages"</span>];</span><br><span class="line">    <span class="comment">// 3.创建文件夹需要一个文件管理对象(单例)</span></span><br><span class="line">    <span class="built_in">NSFileManager</span> *fileManager = [<span class="built_in">NSFileManager</span> defaultManager];</span><br><span class="line">    <span class="comment">// 4.创建文件夹</span></span><br><span class="line">    [fileManager createDirectoryAtPath:directoryPath withIntermediateDirectories:<span class="literal">YES</span> attributes:<span class="literal">nil</span> error:<span class="literal">nil</span>];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, directoryPath);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>创建文件以及获取文件信息</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">IBAction</span>)createFile:(<span class="built_in">UIButton</span> *)sender</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 1.得到Documents的路径</span></span><br><span class="line">    <span class="built_in">NSString</span> *docPath = [<span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSDocumentDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>) firstObject];</span><br><span class="line">    <span class="comment">// 2.创建一个文件路径</span></span><br><span class="line">    <span class="built_in">NSString</span> *filePath = [docPath stringByAppendingPathComponent:<span class="string">@"qiuxiang.txt"</span>];</span><br><span class="line">    <span class="comment">// 3.创建文件首先需要一个文件管理对象</span></span><br><span class="line">    <span class="built_in">NSFileManager</span> *fileManager = [<span class="built_in">NSFileManager</span> defaultManager];</span><br><span class="line">    <span class="comment">// 4.创建文件</span></span><br><span class="line">    [fileManager createFileAtPath:filePath contents:[<span class="string">@"badaas;ldkjf;alskdjf;akjdsf;lakjsdflakjsd;flkajsdlfkjasdlfkjasldfkja;lsdfkjasldkjf;asldkfj;asfjas;ldkfjasldkfjasldkfja;lsdkfjasl;dkjfs;ladkfja;sdkfjalsdkfjalsdfkja;sdfkja;dfkja;slfkdjsalkfja;slfkja;slkdfj"</span> dataUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>] attributes:<span class="literal">nil</span>];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, filePath);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取默认文件或者某个文件夹的大小</span></span><br><span class="line">    <span class="built_in">NSDictionary</span> *dic = [fileManager attributesOfItemAtPath:filePath error:<span class="literal">nil</span>];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, dic);</span><br><span class="line">    <span class="built_in">NSNumber</span> *number = [dic objectForKey:<span class="built_in">NSFileSize</span>];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, number);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>文件移动</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    在Documents文件夹下,创建一个文件夹(path),在该文件夹下创建一个文件(test.txt),将一个图片对象存入到该文件中,然后在Caches文件夹下创建一个文件夹名为"testDirectroy",将test.txt文件移动到这个文件夹下.</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建文件夹</span></span><br><span class="line"><span class="built_in">NSString</span> *docPath = [<span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSDocumentDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>) firstObject];</span><br><span class="line"><span class="built_in">NSString</span> *dirPath = [docPath stringByAppendingPathComponent:<span class="string">@"path"</span>];</span><br><span class="line"><span class="built_in">NSFileManager</span> *fileManager = [<span class="built_in">NSFileManager</span> defaultManager];</span><br><span class="line">[fileManager createDirectoryAtPath:dirPath withIntermediateDirectories:<span class="literal">YES</span> attributes:<span class="literal">nil</span> error:<span class="literal">nil</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建文件</span></span><br><span class="line"><span class="built_in">NSString</span> *filePath = [dirPath stringByAppendingPathComponent:<span class="string">@"test.txt"</span>];</span><br><span class="line">[fileManager createFileAtPath:filePath contents:<span class="literal">nil</span> attributes:<span class="literal">nil</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将图片对象存入到该文件中</span></span><br><span class="line"><span class="built_in">UIImage</span> *image = [<span class="built_in">UIImage</span> imageNamed:<span class="string">@"icon.jpg"</span>];</span><br><span class="line"><span class="built_in">NSData</span> *data = <span class="built_in">UIImageJPEGRepresentation</span>(image, <span class="number">1.0</span>);</span><br><span class="line">[data writeToFile:filePath atomically:<span class="literal">YES</span>];</span><br><span class="line"><span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, filePath);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 移动文件</span></span><br><span class="line"><span class="built_in">NSString</span> *desPath = [docPath stringByAppendingPathComponent:<span class="string">@"test.txt"</span>];</span><br><span class="line">[fileManager moveItemAtPath:filePath toPath:desPath error:<span class="literal">nil</span>];</span><br></pre></td></tr></table></figure>
<h3 id="文件对接器的使用"><a href="#文件对接器的使用" class="headerlink" title="文件对接器的使用"></a>文件对接器的使用</h3><figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     练习要求：从一个文件中指定的位置开始追加内容</span></span><br><span class="line"><span class="comment">     提示:</span></span><br><span class="line"><span class="comment">     1、在documents目录下创建一个test.txt文件,文件中的内容为"abcdefg"</span></span><br><span class="line"><span class="comment">     2、从文件偏移量为3那个位置开始追加内容"1234"</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)change</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 1.获取Documents路径</span></span><br><span class="line">    <span class="built_in">NSString</span> *docPath = [<span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSDocumentDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>) lastObject];</span><br><span class="line">    <span class="comment">// 2.创建文件路径</span></span><br><span class="line">    <span class="built_in">NSString</span> *filePath = [docPath stringByAppendingPathComponent:<span class="string">@"text.txt"</span>];</span><br><span class="line">    <span class="comment">// 3.使用文件管理对象创建文件</span></span><br><span class="line">    <span class="built_in">NSFileManager</span> *fileManager = [<span class="built_in">NSFileManager</span> defaultManager];</span><br><span class="line">    [fileManager createFileAtPath:filePath contents:[<span class="string">@"abcdefg"</span> dataUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>] attributes:<span class="literal">nil</span>];</span><br><span class="line">    <span class="comment">// 4.创建文件对接对象</span></span><br><span class="line">    <span class="built_in">NSFileHandle</span> *handle = [<span class="built_in">NSFileHandle</span> fileHandleForUpdatingAtPath:filePath];<span class="comment">// 文件对象此时针对文件，可读可写</span></span><br><span class="line">    <span class="comment">// 5.将偏移量移动到3的位置</span></span><br><span class="line">    [handle seekToFileOffset:<span class="number">3</span>];</span><br><span class="line">    <span class="comment">// 6.写入数据</span></span><br><span class="line">    [handle writeData:[<span class="string">@"1234"</span> dataUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>]];</span><br><span class="line">    <span class="comment">// 7.执行完操作后，关闭文件</span></span><br><span class="line">    [handle closeFile];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, filePath);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>PS：这个题目有点坑爹，说是追加，其实是把defg替换成1234.</p>
<h1 id="四、复杂对象的读写（I-O）操作"><a href="#四、复杂对象的读写（I-O）操作" class="headerlink" title="四、复杂对象的读写（I/O）操作"></a>四、复杂对象的读写（I/O）操作</h1><p>复杂对象：在Foundation框架内<em>不存在的数据类</em>，如自定义的Person类无法在程序内通过writeToFile：这个方法写入到文件内</p>
<ul>
<li>如何将复杂对象写入文件<ul>
<li>归档：只能通过将复杂对象转换为NSData，然后写入文件。</li>
</ul>
</li>
<li>如何从文件中读取复杂对象<ul>
<li>反归档（又称解档）：将NSData转换为复杂对象</li>
</ul>
</li>
</ul>
<p>①.复杂对象写入文件的过程：复杂对象-&gt;归档-&gt;NSData-&gt;writeToFile<br>②.从文件中读取出复杂对象过程：读取文件-&gt;NSData-&gt;反归档-&gt;复杂对象</p>
<h3 id="归档与反归档"><a href="#归档与反归档" class="headerlink" title="归档与反归档"></a>归档与反归档</h3><p>首先，复杂对象所属的类要遵守<nscoding>协议</nscoding></p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">Person</span> : <span class="title">NSObject</span> &lt;<span class="title">NSCoding</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">copy</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *name;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">copy</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *age;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">copy</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *gender;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">instancetype</span>)initWithName:(<span class="built_in">NSString</span> *)name age:(<span class="built_in">NSString</span> *)age gender:(<span class="built_in">NSString</span> *)gender;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>然后实现其中的两个方法</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// NSCoder是iOS中的编码解码类</span></span><br><span class="line"><span class="comment">// 归档时调用</span></span><br><span class="line">- (<span class="keyword">void</span>)encodeWithCoder:(<span class="built_in">NSCoder</span> *)aCoder</span><br><span class="line">&#123;</span><br><span class="line">    [aCoder encodeObject:<span class="keyword">self</span>.name forKey:<span class="string">@"name"</span>];</span><br><span class="line">    [aCoder encodeObject:<span class="keyword">self</span>.age forKey:<span class="string">@"age"</span>];</span><br><span class="line">    [aCoder encodeObject:<span class="keyword">self</span>.gender forKey:<span class="string">@"gender"</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 解档时调用</span></span><br><span class="line">- (<span class="keyword">id</span>)initWithCoder:(<span class="built_in">NSCoder</span> *)aDecoder</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">NSString</span> *name = [aDecoder decodeObjectForKey:<span class="string">@"name"</span>];</span><br><span class="line">    <span class="built_in">NSString</span> *age = [aDecoder decodeObjectForKey:<span class="string">@"age"</span>];</span><br><span class="line">    <span class="built_in">NSString</span> *gender = [aDecoder decodeObjectForKey:<span class="string">@"gender"</span>];</span><br><span class="line">    <span class="keyword">return</span> [<span class="keyword">self</span> initWithName:name age:age gender:gender];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>进行归档或者反归档</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 归档</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)archiver:(<span class="keyword">id</span>)sender &#123;</span><br><span class="line">	<span class="comment">// 创建两个人</span></span><br><span class="line">	Person *bada = [[Person alloc] initWithName:<span class="string">@"bada"</span> age:<span class="string">@"18"</span> gender:<span class="string">@"男"</span>];</span><br><span class="line">	Person *qiuxiang = [[Person alloc] initWithName:<span class="string">@"qiuxiang"</span> age:<span class="string">@"18"</span> gender:<span class="string">@"女"</span>];</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 获取到Documents路径</span></span><br><span class="line">	<span class="built_in">NSString</span> *docPath = [<span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSDocumentDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>) firstObject];</span><br><span class="line"></span><br><span class="line">	<span class="comment">// iOS中的归档类是NSKeyeArchiver，作用是：将复杂对象转换为NSData对象</span></span><br><span class="line">	<span class="comment">// 创建一个可变数据对象</span></span><br><span class="line"><span class="built_in">NSMutableData</span> *mData = [<span class="built_in">NSMutableData</span> data];</span><br><span class="line"><span class="built_in">NSKeyedArchiver</span> *archiver = [[<span class="built_in">NSKeyedArchiver</span> alloc] initForWritingWithMutableData:mData];</span><br><span class="line">	<span class="comment">// 归档时要给归档对象添加标记</span></span><br><span class="line">[archiver encodeObject:bada forKey:<span class="string">@"bada"</span>];</span><br><span class="line">[archiver encodeObject:qiuxiang forKey:<span class="string">@"qiuxiang"</span>];</span><br><span class="line">	<span class="comment">// 结束归档，不管还有多少未归档的对象，都不会执行归档操作</span></span><br><span class="line">[archiver finishEncoding];</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 将数据写入文件</span></span><br><span class="line">	<span class="comment">// 创建文件路径</span></span><br><span class="line">	<span class="built_in">NSString</span> *filePath = [docPath stringByAppendingPathComponent:<span class="string">@"bada.qiuxiang"</span>];</span><br><span class="line">	[mData writeToFile:filePath atomically:<span class="literal">YES</span>];</span><br><span class="line"></span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"归档"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 反归档</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)unarchiver:(<span class="keyword">id</span>)sender &#123;</span><br><span class="line">    <span class="comment">// 获取存放数据的路径</span></span><br><span class="line">    <span class="built_in">NSString</span> *docPath = [<span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSDocumentDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>) firstObject];</span><br><span class="line">    <span class="built_in">NSString</span> *filePath = [docPath stringByAppendingPathComponent:<span class="string">@"bada.qiuxiang"</span>];</span><br><span class="line">    <span class="comment">// 从路径中获取NSData对象</span></span><br><span class="line">    <span class="built_in">NSData</span> *data = [<span class="built_in">NSData</span> dataWithContentsOfFile:filePath];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// iOS中的解档类是NSKeyedUnarchiver，作用是：将NSData对象还原成原本的复杂对象</span></span><br><span class="line">    <span class="built_in">NSKeyedUnarchiver</span> *unarchiver = [[<span class="built_in">NSKeyedUnarchiver</span> alloc] initForReadingWithData:data];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 解档</span></span><br><span class="line">    Person *bada = [unarchiver decodeObjectForKey:<span class="string">@"bada"</span>];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"name is %@, age is %@, gender is %@ 解档成功"</span>, bada.name, bada.age, bada.gender);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/4/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><span class="page-number current">5</span>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/icon.jpg"
                alt="ZeroJi" />
            
              <p class="site-author-name" itemprop="name">ZeroJi</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">49</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ZeroJi</span>

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=5.1.4"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.4"></script>


  

</body>
</html>
