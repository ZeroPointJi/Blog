<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="ZeroJi&#39;s Blog">
<meta property="og:url" content="http://yoursite.com/page/3/index.html">
<meta property="og:site_name" content="ZeroJi&#39;s Blog">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ZeroJi&#39;s Blog">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/3/"/>





  <title>ZeroJi's Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">ZeroJi's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/03/20/Swift_十六_可选链式调用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZeroJi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZeroJi's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/03/20/Swift_十六_可选链式调用/" itemprop="url">Swift (十六) 可选链式调用</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-03-20T08:15:00+08:00">
                2016-03-20
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-04-28T17:06:09+08:00">
                2018-04-28
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="使用可选链式调用代替强制展开"><a href="#使用可选链式调用代替强制展开" class="headerlink" title="使用可选链式调用代替强制展开"></a>使用可选链式调用代替强制展开</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> residence: <span class="type">Residence</span>?</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Residence</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> numberOfRooms = <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> john = <span class="type">Person</span>()</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> roomCount = john.residence?.numberOfRooms &#123; <span class="comment">// 可选链式</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"John's residence has \(roomCount) room(s)"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Unable to retrieve the number of rooms."</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">john.residence = <span class="type">Residence</span>()</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> roomCount = john.residence?.numberOfRooms &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"John's residence has \(roomCount) room(s)"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Unable to retrieve the number of rooms."</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="为可选链式调用定义模型类"><a href="#为可选链式调用定义模型类" class="headerlink" title="为可选链式调用定义模型类"></a>为可选链式调用定义模型类</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> residence: <span class="type">Residence</span>?</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Residence</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> rooms = [<span class="type">Room</span>]()</span><br><span class="line">    <span class="keyword">var</span> numberOfRooms: <span class="type">Int</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> rooms.<span class="built_in">count</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">subscript</span>(i: <span class="type">Int</span>) -&gt; <span class="type">Room</span> &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> rooms[i]</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123;</span><br><span class="line">           rooms[i] = newValue</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">printNumberOfRooms</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"The nubmer of rooms is \(numberOfRooms)"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> address: <span class="type">Address</span>?</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Room</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">init</span>(name: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.name = name</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Address</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> buildingName: <span class="type">String</span>?</span><br><span class="line">    <span class="keyword">var</span> buildingNumber: <span class="type">String</span>?</span><br><span class="line">    <span class="keyword">var</span> street: <span class="type">String</span>?</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">buildingIdentifier</span><span class="params">()</span></span> -&gt; <span class="type">String</span>? &#123;</span><br><span class="line">        <span class="keyword">if</span> buildingName != <span class="literal">nil</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> buildingName</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> buildingNumber != <span class="literal">nil</span> &amp;&amp; street != <span class="literal">nil</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"\(buildingNumber) \(street)"</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line">                    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="通过可选链式调用访问属性"><a href="#通过可选链式调用访问属性" class="headerlink" title="通过可选链式调用访问属性"></a>通过可选链式调用访问属性</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> john = <span class="type">Person</span>()</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> roomCount = john.residence?.numberOfRooms &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"John's residence has \(roomCount) room(s)"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Unable to retrieve the number of rooms."</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> someAddress = <span class="type">Address</span>()</span><br><span class="line">someAddress.buildingNumber = <span class="string">"29"</span></span><br><span class="line">someAddress.street = <span class="string">"Acacia Road"</span></span><br><span class="line">john.residence?.address = someAddress</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">createAddress</span><span class="params">()</span></span> -&gt; <span class="type">Address</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Function was called."</span>)</span><br><span class="line">    <span class="keyword">let</span> someAddress = <span class="type">Address</span>()</span><br><span class="line">    someAddress.buildingNumber = <span class="string">"29"</span></span><br><span class="line">    someAddress.street = <span class="string">"Acacia Road"</span></span><br><span class="line">    <span class="keyword">return</span> someAddress</span><br><span class="line">&#125;</span><br><span class="line">john.residence?.address = createAddress()</span><br></pre></td></tr></table></figure>
<h2 id="通过可选链式调用-调用方法"><a href="#通过可选链式调用-调用方法" class="headerlink" title="通过可选链式调用 调用方法"></a>通过可选链式调用 调用方法</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> john.residence?.printNumberOfRooms() != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"It was possible to print the number of rooms."</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"It was not possible to print the number of rooms"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (john.residence?.address = someAddress) != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"It was possible to set the address."</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"It was not possible to set the address."</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="通过可选链式调用访问下标"><a href="#通过可选链式调用访问下标" class="headerlink" title="通过可选链式调用访问下标"></a>通过可选链式调用访问下标</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> firstRoomName = john.residence?[<span class="number">0</span>].name &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"The first room name is \(firstRoomName)"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Unable to retrieve the first room name"</span>)</span><br><span class="line">&#125;</span><br><span class="line">john.residence?[<span class="number">0</span>] = <span class="type">Room</span>(name: <span class="string">"Bathroom"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> johnsHouse = <span class="type">Residence</span>()</span><br><span class="line">johnsHouse.rooms.append(<span class="type">Room</span>(name: <span class="string">"Living Room"</span>))</span><br><span class="line">johnsHouse.rooms.append(<span class="type">Room</span>(name: <span class="string">"Kitchen"</span>))</span><br><span class="line">john.residence = johnsHouse</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> firstRoomName = john.residence?[<span class="number">0</span>].name &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"The first room name is \(firstRoomName)"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Unable to retrieve the first room name"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="访问可选类型的下标"><a href="#访问可选类型的下标" class="headerlink" title="访问可选类型的下标"></a>访问可选类型的下标</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> testScores = [<span class="string">"Dave"</span>: [<span class="number">86</span>, <span class="number">82</span>,<span class="number">84</span>], <span class="string">"Bev"</span>: [<span class="number">79</span>, <span class="number">94</span>, <span class="number">81</span>]]</span><br><span class="line">testScores[<span class="string">"Dave"</span>]?[<span class="number">0</span>] = <span class="number">91</span></span><br><span class="line">testScores[<span class="string">"Bev"</span>]?[<span class="number">0</span>]++</span><br><span class="line">testScores[<span class="string">"Brian"</span>]?[<span class="number">0</span>] = <span class="number">72</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 连接多层可选链式调用</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> johnsStreet = john.residence?.address?.street &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"John's street name is \(johnsStreet)"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Unable to retrieve the address."</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> johnsAddress = <span class="type">Address</span>()</span><br><span class="line">johnsAddress.buildingName = <span class="string">"The Larches"</span></span><br><span class="line">johnsAddress.street = <span class="string">"Laurel Street"</span></span><br><span class="line">john.residence?.address = johnsAddress</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> johnsStreet = john.residence?.address?.street &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"John's street name is \(johnsStreet)"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Unable to retrieve the address."</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="在方法的可选返回值上进行可选链式调用"><a href="#在方法的可选返回值上进行可选链式调用" class="headerlink" title="在方法的可选返回值上进行可选链式调用"></a>在方法的可选返回值上进行可选链式调用</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> buildingIdentifier = john.residence?.address?.buildingIdentifier() &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"John's building identifier is \(buildingIdentifier)"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> beginsWithThe = john.residence?.address?.buildingIdentifier()?.hasPrefix(<span class="string">"The"</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> beginsWithThe &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"John's building identifier begins with \"The\"."</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"John's building identifier does not begin with \"The\"."</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/03/19/iOS_十五_多媒体/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZeroJi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZeroJi's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/03/19/iOS_十五_多媒体/" itemprop="url">iOS进阶（十五）多媒体</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-03-19T01:50:00+08:00">
                2016-03-19
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-04-28T17:02:20+08:00">
                2018-04-28
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="音频"><a href="#音频" class="headerlink" title="音频"></a>音频</h2><ol>
<li><code>System Sound Services</code> (系统声音服务)</li>
<li><code>OpenAL</code> (跨平台的太远的音频处理接口)</li>
<li><code>Audio Queue Services</code> (播放和录制音频服务)</li>
<li><code>AVAudioPlayer</code> (高级音频播放器)</li>
</ol>
<h2 id="System-Sound-Services"><a href="#System-Sound-Services" class="headerlink" title="System Sound Services"></a>System Sound Services</h2><p><code>System Sound Services</code> 是最底层也是最简单的音乐播放服务, 通过调用 <code>AudioServicesPlaySystemSound</code> 这个函数就可以播放一些简单的音频文件. 适合比方一些很小的提示或者警告音.</p>
<p>局限性:</p>
<ol>
<li>声音长度要小于 <code>30</code> 秒.</li>
<li>音频文件格式需要: <code>IMA4</code>.</li>
<li>不能控制播放的进度.</li>
<li>调用方法后立即播放声音.</li>
<li>没有循环播放和立体声音播放.</li>
</ol>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">CFBundleRef</span> mainBundle;</span><br><span class="line">SystemSoundID soundFileObject;</span><br><span class="line">mainBundle = <span class="built_in">CGBundleGetMainBundle</span>();</span><br><span class="line"><span class="built_in">CGURLRef</span> soudFileURLRef = <span class="built_in">CGBundleCopyResourceURL</span>(mainBundle, <span class="built_in">CGSTR</span>(<span class="string">"duang"</span>), <span class="built_in">CGSTR</span>(<span class="string">"wac"</span>), <span class="literal">NULL</span>);</span><br><span class="line">AudioServicesCreateSystemSoundID(soundFileURLRef, &amp;soundFileObject);</span><br><span class="line">AudioServicesPlaySystemSound(soundFileObject);</span><br></pre></td></tr></table></figure>
<h2 id="OpenAL"><a href="#OpenAL" class="headerlink" title="OpenAL"></a>OpenAL</h2><p><code>OpenAL</code> 是一套跨平台的开源的音频处理借口, 最适合开发游戏的音频.</p>
<h2 id="Audio-Queue-Services"><a href="#Audio-Queue-Services" class="headerlink" title="Audio Queue Services"></a>Audio Queue Services</h2><p><code>Audio Queue Services</code> 主要用来实现录制音频, 为了简化音频文件的处理, 通常还需要使用 <code>AudioFileServices</code>.</p>
<h2 id="AVAudioPlayer"><a href="#AVAudioPlayer" class="headerlink" title="AVAudioPlayer"></a>AVAudioPlayer</h2><p>我们可以把 <code>AVAudioPlayer</code> 看做是一个高级播放器, 它支持广泛的音频格式.</p>
<p><code>AVAudioPlayer</code> 的优势:</p>
<ol>
<li>支持更多的格式</li>
<li>可以播放任意长度的音频文件</li>
<li>支持循环播放</li>
<li>可以同步播放多个音频文件</li>
<li>控制播放进度以及从音频的任意一点开始播放</li>
</ol>
<h2 id="AVAudioPlayer-的使用"><a href="#AVAudioPlayer-的使用" class="headerlink" title="AVAudioPlayer 的使用"></a>AVAudioPlayer 的使用</h2><p><code>AVAudioplayer</code> 包含在 <code>AVFoundation</code> 框架中, 所以开发的时候需要先导入音频的框架 <code>AVFoundation.framework</code>.</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取音乐地址</span></span><br><span class="line"><span class="built_in">NSString</span> *path = [[<span class="built_in">NSBundle</span> mainBundle] pathForResource:<span class="keyword">self</span>.musicName ofType:<span class="string">@"mp3"</span>];</span><br><span class="line"><span class="built_in">NSURL</span> *url = [<span class="built_in">NSURL</span> fileURLWithPath: path];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始化播放器</span></span><br><span class="line"><span class="keyword">self</span>.player = [[<span class="built_in">AVAudioPlayer</span> alloc] initWithContentsOfURL:url error:<span class="literal">nil</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 开始播放</span></span><br><span class="line"><span class="keyword">self</span>.player play];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 指定进度条最大值为歌曲总时间</span></span><br><span class="line"><span class="keyword">self</span>.progressSlider.maximumValue = [<span class="keyword">self</span>.player duration];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 定义一个计时器来获取播放时间</span></span><br><span class="line">[<span class="built_in">NSTimer</span> scheduledTimerWithTimeInterval:<span class="number">1.0</span> target:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(updateProgress) userInfo:<span class="literal">nil</span> repeats:<span class="literal">YES</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 开始播放时, 指定一个音量初始值</span></span><br><span class="line"><span class="keyword">self</span>.player.volume = <span class="keyword">self</span>.volumnSlider.value;</span><br></pre></td></tr></table></figure>
<p>实现定时器方法</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 更新进度</span></span><br><span class="line">- (<span class="keyword">void</span>)updateProgress</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span>.progressSlider.value = [<span class="keyword">self</span>.player currentTime];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>实现调节音量大小方法</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 音量大小</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)changeVolumn:(<span class="built_in">UISlider</span> *)sender &#123;</span><br><span class="line">    <span class="keyword">self</span>.player.volume = sender.value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>实现播放和暂停, 在播放暂停时实现切换按钮图片.</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 播放和暂停</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)playAndStop:(<span class="built_in">UIButton</span> *)sender &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.player.playing) &#123;</span><br><span class="line">        [sender setImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"player_play"</span>] forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">        [sender setImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"player_play_hl"</span>] forState:<span class="built_in">UIControlStateHighlighted</span>];</span><br><span class="line">        [<span class="keyword">self</span>.player pause];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        [sender setImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"player_pause"</span>] forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">        [sender setImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"player_pause_hl"</span>] forState:<span class="built_in">UIControlStateHighlighted</span>];</span><br><span class="line">        [<span class="keyword">self</span>.player play];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>实现拖动进度条方法</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 拖动进度条方法</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)changeProgress:(<span class="built_in">UISlider</span> *)sender &#123;</span><br><span class="line">    [<span class="keyword">self</span> playAndStop:<span class="literal">nil</span>];</span><br><span class="line">    <span class="keyword">self</span>.player.currentTime = sender.value;</span><br><span class="line">    [<span class="keyword">self</span> playAndStop:<span class="literal">nil</span>];</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>实现快进和快退方法</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 快退</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)rew:(<span class="built_in">UIButton</span> *)sender &#123;</span><br><span class="line">    <span class="keyword">self</span>.player.currentTime -= <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">self</span>.progressSlider.value = <span class="keyword">self</span>.player.currentTime;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 快进</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)speed:(<span class="built_in">UIButton</span> *)sender &#123;</span><br><span class="line">    <span class="keyword">self</span>.player.currentTime += <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">self</span>.progressSlider.value = <span class="keyword">self</span>.player.currentTime;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="AVPlayer"><a href="#AVPlayer" class="headerlink" title="AVPlayer"></a>AVPlayer</h2><p><code>AVPlayer</code> 既能播放视频也能播放音频, 属性和 <code>AVAudioPlayer</code> 差不多, 只是时间用 <code>CMTime</code> 类来表示.</p>
<p><code>AVPlayer</code> 实现音频播放</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  MusicViewController.m</span></span><br><span class="line"><span class="comment">//  AVPlayerMusic</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by zero on 16/3/18.</span></span><br><span class="line"><span class="comment">//  Copyright © 2016年 zero. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#import <span class="meta-string">"MusicViewController.h"</span></span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"MusicManager.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MusicViewController</span> ()</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIImageView</span> *iconImageView;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UILabel</span> *musicNameLabel;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UILabel</span> *currentTimeLabel;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UISlider</span> *progressBarSlider;</span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">weak</span>, <span class="keyword">nonatomic</span>) <span class="keyword">IBOutlet</span> <span class="built_in">UIButton</span> *playAndStopButton;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>) <span class="built_in">NSInteger</span> playIndex;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">MusicViewController</span></span></span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setPlayIndex:(<span class="built_in">NSInteger</span>)playIndex</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (playIndex == <span class="keyword">self</span>.dataArr.count) &#123;</span><br><span class="line">        _playIndex = <span class="number">0</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (playIndex == <span class="number">-1</span>) &#123;</span><br><span class="line">        _playIndex = <span class="keyword">self</span>.dataArr.count - <span class="number">1</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        _playIndex = playIndex;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)viewDidLoad &#123;</span><br><span class="line">    [<span class="keyword">super</span> viewDidLoad];</span><br><span class="line">         </span><br><span class="line">    <span class="built_in">AVPlayerItem</span> *item = [<span class="keyword">self</span> createAVPlayerItem];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">self</span>.player = [[<span class="built_in">AVPlayer</span> alloc] initWithPlayerItem:item];</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span>.player play];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">self</span>.progressBarSlider.value = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//设置图片为圆形</span></span><br><span class="line">    <span class="keyword">self</span>.iconImageView.layer.cornerRadius = <span class="number">120</span>;</span><br><span class="line">    <span class="comment">// 裁剪图层以外的内容</span></span><br><span class="line">    <span class="keyword">self</span>.iconImageView.layer.masksToBounds = <span class="literal">YES</span>;</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span>.playAndStopButton setImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"player_pause"</span>] forState:<span class="built_in">UIControlStateNormal</span>];</span><br><span class="line">    [<span class="keyword">self</span>.playAndStopButton setImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"player_pause_hl"</span>] forState:<span class="built_in">UIControlStateHighlighted</span>];</span><br><span class="line">    [<span class="keyword">self</span>.playAndStopButton setImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"player_play"</span>] forState:<span class="built_in">UIControlStateSelected</span>];</span><br><span class="line">    </span><br><span class="line">    [<span class="built_in">NSTimer</span> scheduledTimerWithTimeInterval:<span class="number">0.1</span> target:<span class="keyword">self</span> selector:<span class="keyword">@selector</span>(playing) userInfo:<span class="literal">nil</span> repeats:<span class="literal">YES</span>];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">AVPlayerItem</span> *)createAVPlayerItem</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 根据获取的位置信息找到歌曲模型</span></span><br><span class="line">    Music *music = <span class="keyword">self</span>.dataArr[<span class="keyword">self</span>.playIndex];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSString</span> *path = [[<span class="built_in">NSBundle</span> mainBundle] pathForResource:music.name ofType:<span class="string">@"mp3"</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">NSURL</span> *url = [<span class="built_in">NSURL</span> fileURLWithPath:path];</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">AVPlayerItem</span> *item = [[<span class="built_in">AVPlayerItem</span> alloc] initWithURL: url];</span><br><span class="line">    </span><br><span class="line">    [<span class="keyword">self</span> setMusic:music];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> item;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setMusic:(Music *)music</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span>.iconImageView.image = [<span class="built_in">UIImage</span> imageNamed:music.pic];</span><br><span class="line">    <span class="keyword">self</span>.musicNameLabel.text = music.name;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)playing</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 判断是否存在播放资源, 加载播放资源是否已经完毕, 如果完毕, 执行 playing 方法, 否则不执行</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.player.currentItem.currentTime.timescale == <span class="number">0</span> || <span class="keyword">self</span>.player.currentItem.duration.timescale == <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="comment">// 获取总时间</span></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> <span class="keyword">int</span> allTime = <span class="keyword">self</span>.player.currentItem.duration.value / <span class="keyword">self</span>.player.currentItem.duration.timescale;</span><br><span class="line">    <span class="keyword">self</span>.progressBarSlider.maximumValue = allTime;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 获取当前时间</span></span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> <span class="keyword">int</span> currentTime = <span class="keyword">self</span>.player.currentTime.value / <span class="keyword">self</span>.player.currentTime.timescale;</span><br><span class="line">    <span class="keyword">self</span>.progressBarSlider.value = currentTime;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 当进度条到最后时, 自动播放下一首</span></span><br><span class="line">    <span class="keyword">if</span> (currentTime == allTime) &#123;</span><br><span class="line">        [<span class="keyword">self</span> nextMusic:<span class="literal">nil</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 计算得到剩余时间</span></span><br><span class="line">    <span class="keyword">self</span>.currentTimeLabel.text = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%02lld:%02lld"</span>, (allTime - currentTime) / <span class="number">60</span>, (allTime - currentTime) % <span class="number">60</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 如果播放器正在播放音乐, 才执行图像动画</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.player.rate == <span class="number">1.0</span>) &#123;</span><br><span class="line">        [<span class="built_in">UIView</span> beginAnimations:<span class="string">@"change"</span> context:<span class="literal">nil</span>];</span><br><span class="line">        [<span class="built_in">UIView</span> setAnimationDuration:<span class="number">0.1</span>];</span><br><span class="line">        [<span class="built_in">UIView</span> setAnimationCurve:<span class="built_in">UIViewAnimationCurveLinear</span>];</span><br><span class="line">        <span class="keyword">self</span>.iconImageView.transform = <span class="built_in">CGAffineTransformRotate</span>(<span class="keyword">self</span>.iconImageView.transform, <span class="number">0.05</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">IBAction</span>)changeProgress:(<span class="built_in">UISlider</span> *)sender</span><br><span class="line">&#123;</span><br><span class="line">    <span class="built_in">CMTime</span> currentTime = <span class="keyword">self</span>.player.currentTime;</span><br><span class="line">    currentTime.value = currentTime.timescale * sender.value;</span><br><span class="line">    [<span class="keyword">self</span>.player seekToTime:currentTime];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">IBAction</span>)playAndStop:(<span class="built_in">UIButton</span> *)sender</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span>.playAndStopButton.selected = !<span class="keyword">self</span>.playAndStopButton.selected;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.player.rate == <span class="number">1.0</span>) &#123;</span><br><span class="line">        [<span class="keyword">self</span>.playAndStopButton setImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"player_play_hl"</span>] forState:<span class="built_in">UIControlStateHighlighted</span>];</span><br><span class="line">        [<span class="keyword">self</span>.player pause];</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        [<span class="keyword">self</span>.playAndStopButton setImage:[<span class="built_in">UIImage</span> imageNamed:<span class="string">@"player_pause_hl"</span>] forState:<span class="built_in">UIControlStateHighlighted</span>];</span><br><span class="line">        [<span class="keyword">self</span>.player play];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">IBAction</span>)nextMusic:(<span class="built_in">UIButton</span> *)sender</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span>.playIndex++;</span><br><span class="line">    <span class="built_in">AVPlayerItem</span> *item = [<span class="keyword">self</span> createAVPlayerItem];</span><br><span class="line">    [<span class="keyword">self</span>.player replaceCurrentItemWithPlayerItem: item];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">IBAction</span>)previousMusic:(<span class="built_in">UIButton</span> *)sender</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">self</span>.playIndex--;</span><br><span class="line">    <span class="built_in">AVPlayerItem</span> *item = [<span class="keyword">self</span> createAVPlayerItem];</span><br><span class="line">    [<span class="keyword">self</span>.player replaceCurrentItemWithPlayerItem: item];</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>
<p>视屏播放使用的也是 <code>AVPlayer</code>, 除了创建方式与音频不同, 其他方法基本相同.</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取网络连接字符串</span></span><br><span class="line"><span class="built_in">NSString</span> *str = <span class="string">@"http://122.228.237.104/ws.acgvideo.com/3/50/6319180-1hd.mp4?wsTime=1458315227&amp;wsSecret2=9242f16dd0079f5e9f46cb3ef76360d7&amp;oi=2015071171&amp;internal=1&amp;or=2061576138&amp;wshc_tag=0&amp;wsts_tag=56ebe88d&amp;wsid_tag=655f8d06&amp;wsiphost=ipdbm"</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSURL</span> *url = [<span class="built_in">NSURL</span> URLWithString:str];</span><br><span class="line"></span><br><span class="line"><span class="built_in">AVPlayerItem</span> *item = [[<span class="built_in">AVPlayerItem</span> alloc] initWithURL: url];</span><br><span class="line"></span><br><span class="line"><span class="keyword">self</span>.player = [[<span class="built_in">AVPlayer</span> alloc] initWithPlayerItem: item];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建图层, 作为视频播放的载体</span></span><br><span class="line"><span class="built_in">AVPlayerLayer</span> *layer = [<span class="built_in">AVPlayerLayer</span> playerLayerWithPlayer:<span class="keyword">self</span>.player];</span><br><span class="line">layer.frame = <span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>, [<span class="built_in">UIScreen</span> mainScreen].bounds.size.width, <span class="number">300</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使播放内容适应播放窗口的大小</span></span><br><span class="line">layer.videoGravity = <span class="built_in">AVLayerVideoGravityResizeAspect</span>;</span><br><span class="line">layer.backgroundColor = [<span class="built_in">UIColor</span> blackColor].CGColor;</span><br><span class="line"></span><br><span class="line">[<span class="keyword">self</span>.view.layer addSublayer:layer];</span><br><span class="line"></span><br><span class="line">[<span class="keyword">self</span>.player play];</span><br></pre></td></tr></table></figure>
<p>拖动进度条方法</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 拖动进度条方法</span></span><br><span class="line">- (<span class="keyword">IBAction</span>)changeProgress:(<span class="built_in">UISlider</span> *)sender &#123;</span><br><span class="line">    [<span class="keyword">self</span>.player seekToTime:<span class="built_in">CMTimeMake</span>(<span class="keyword">self</span>.progressSlider.value * <span class="keyword">self</span>.player.currentItem.duration.value, <span class="keyword">self</span>.player.currentItem.duration.timescale) completionHandler:^(<span class="built_in">BOOL</span> finished) &#123;</span><br><span class="line">        [<span class="keyword">self</span>.player play];</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/03/17/OC_review/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZeroJi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZeroJi's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/03/17/OC_review/" itemprop="url">OC review</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-03-17T11:50:00+08:00">
                2016-03-17
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-04-28T17:02:17+08:00">
                2018-04-28
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="面向对象和面向过程"><a href="#面向对象和面向过程" class="headerlink" title="面向对象和面向过程"></a>面向对象和面向过程</h2><p><code>OC</code> 是一门面向对象的语言, 在学习之前, 应该先了解面向对象的概念.</p>
<p>面向对象:</p>
<ul>
<li>特点: 分析解决问题的步骤, 实现函数, 依次调用函数.</li>
<li>侧重点: 实现功能.</li>
<li>语言: <code>OC</code>, <code>C++</code>, <code>Java</code> 等.</li>
</ul>
<p>面向过程:</p>
<ul>
<li>特点: 分析该问题需要参与的对象, 各个对象的功能, 完成该事件需要多个对象协同完成任务.</li>
<li>侧重点: 对象的设计.</li>
<li>语言: <code>C</code>.</li>
</ul>
<p>面向对象的优点:</p>
<ul>
<li>面向对象具有良好的可扩展性和重用性.</li>
<li>面向对象可以降低代码的耦合度, 提高代码的可移植性.</li>
<li>面向对象接近于日常生活和自然的思考方式, 可以提高软件开发的效率和质量.</li>
</ul>
<h2 id="OC"><a href="#OC" class="headerlink" title="OC"></a>OC</h2><p><code>Objective-C</code> 简称 <code>OC</code>, <code>OC</code> 是 <code>C</code> 语言的扩充.</p>
<p><code>OC</code> 语言的特点:</p>
<ul>
<li><code>C</code> 语言的超集, 允许在 <code>OC</code> 中使用 <code>C</code> 语言代码, 编译器兼容 <code>C</code> 语言程序.</li>
<li>具备完善的面向对象特征: 封装, 继承, 多态.</li>
</ul>
<p><code>OC</code> 中使用的是消息发送机制: [receiver message].</p>
<p>消息发送机制: 给对象或者类发送方法名称以及携带的参数, 对象或类接收到到消息, 找到方法, 并且执行.</p>
<h2 id="类和对象"><a href="#类和对象" class="headerlink" title="类和对象"></a>类和对象</h2><p>类: 具有相同特征和行为的事物的抽象, 是对象的类型.</p>
<p>类的定义过程需要进行分文件放置, 分为 <code>.h</code> 和 <code>.m</code> 文件.</p>
<p><code>.h</code> 文件管理类的接口部分, <code>.m</code> 文件管理类的实现部分.</p>
<p>对象: 对象是类的实例, 万事万物皆对象.</p>
<p>对象的创建需要两部, 分配空间和初始化.</p>
<p>分配空间方法</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+ (<span class="keyword">instancetype</span>)alloc;</span><br></pre></td></tr></table></figure>
<p><code>+</code> 表示方法是类方法, 只能由类调用. 实例变量不能在类方法中使用.</p>
<p>初始化方法</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">instancetype</span>)init;</span><br></pre></td></tr></table></figure>
<p><code>-</code> 表示方法是对象方法, 只能由对象调用. 实例变量能在对象方法中使用.</p>
<blockquote>
<p>类中不能出现同名方法.</p>
</blockquote>
<h2 id="instancetype-和-id-的区别"><a href="#instancetype-和-id-的区别" class="headerlink" title="instancetype 和 id 的区别"></a>instancetype 和 id 的区别</h2><p><code>instancetype</code> 可以返回和方法所在类相同类型的对象, <code>id</code> 只能返回未知类型的对象.</p>
<p><code>instancetype</code> 只能作为返回值和参数, <code>id</code> 还可以用来定义变量.</p>
<h2 id="实例变量三种可见度的区别"><a href="#实例变量三种可见度的区别" class="headerlink" title="实例变量三种可见度的区别"></a>实例变量三种可见度的区别</h2><ul>
<li><p><code>@public</code> : 本类可以访问, 子类可以访问, 其他类可以访问.</p>
</li>
<li><p><code>@private</code> : 本类可以访问, 子类不可以访问, 其他类不可以访问.</p>
</li>
<li><p><code>@protected</code> : 本类可以访问, 子类可以访问, 其他类不可以访问.</p>
</li>
</ul>
<p>以上的可以访问或不可以访问, 是指可以直接访问或不可以直接访问.</p>
<h2 id="setter-和-getter"><a href="#setter-和-getter" class="headerlink" title="setter 和 getter"></a>setter 和 getter</h2><p><code>setter</code> : 为单一实例变量赋值的方法</p>
<p><code>getter</code> : 获取单一实例变量值得方法</p>
<p><code>OC</code> 中规定了 <code>setter</code> 和 <code>getter</code> 的书写格式</p>
<p><code>setter</code> : <code>set</code> + 首字母大写的实例变量名</p>
<p><code>getter</code> : 方法名与变量名相同</p>
<h2 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h2><p>继承既能保证类的完整, 又能简化代码.</p>
<p>继承自其他类的叫子类, 被继承的叫超类(父类), 一个类只能有一个超类, 可以有多个子类.</p>
<p>如果需要创建多个有一些相同方法或者实例变量的类, 只需要把公共的方法写在一个类里面, 其他类继承这个超类, 各自实现自己的独有的方法和实例变量即可.</p>
<blockquote>
<p><code>NSObject</code> 有一个 <code>isa</code> 属性, 因为每个类的始祖类都是 <code>NSObject</code>, 所以都继承了 <code>isa</code> 属性. <code>isa</code> 属性是一个指针类型, 指向自己的父类, 也就是说. 因为 <code>NSObject</code> 为基类, 所以它的 <code>isa</code> 指针指向 <code>nil</code>.</p>
</blockquote>
<blockquote>
<p>还需要注意一点的是,  使用 <code>runtime</code> 时, 可以发现, 在一个类中不止指针 <code>isa</code>, 还有一个为 <code>Class</code> 的变量 <code>isa</code>. 变量 <code>isa</code> 指向的是当前类的实际类型.</p>
</blockquote>
<h2 id="super-和-self"><a href="#super-和-self" class="headerlink" title="super 和 self"></a>super 和 self</h2><p><code>self</code> : 如果在类方法中, 即指这个类. 如果在实例方法中, 即指这个实例.</p>
<p><code>super</code> : 不是一个对象, 只是一个编译器指令, 特指超类.</p>
<h2 id="初始化方法"><a href="#初始化方法" class="headerlink" title="初始化方法"></a>初始化方法</h2><p>需要先初始化超类中继承的实例变量, 再初始化自身的实例变量, 才能完全初始化自身的所有实例变量.</p>
<h2 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h2><p><code>@property</code> 用来声明属性.</p>
<p>提供 <code>setter</code> 和 <code>getter</code> 方法的声明, 即声明了属性, 编译器会自动完成 <code>setter</code> 和 <code>getter</code> 方法的声明.</p>
<p><code>@synthesize</code> 用来实现属性.</p>
<p>提供 <code>setter</code> 和 <code>getter</code> 方法的实现, 即实现了属性, 编译器会自动完成 <code>setter</code> 和 <code>getter</code> 方法的实现.</p>
<p>注: 在 <code>Xcode4.5</code> 以及之后的版本中, <code>@synthesize</code> 可以省略, 只使用 <code>@property</code> 声明属性.</p>
<p><code>@dynamic</code> 用来表示 <code>setter</code> 和 <code>getter</code> 方法由自己实现.</p>
<blockquote>
<ul>
<li>属性的作用是生成 <code>setter</code> 和 <code>getter</code>, 如果方法内部操作的实例变量未定义, 系统会自动生成一个<code>_</code>属性名的实例变量, 但是生成的实例变量的可见度是私有的, 子类不可访问.</li>
<li>一旦同时重写了 <code>setter</code> 和 <code>getter</code> 方法, 并且没有实现 <code>@synthesize</code>, <code>@synthesize</code> 就不再生成实例变量.</li>
</ul>
</blockquote>
<ol>
<li>同时重写了 <code>setter</code> 和 <code>getter</code> 方法时, 需要用 <code>@synthesize</code> 来关联实例变量和方法.</li>
<li>重写了只读属性的 <code>getter</code> 时, 也需要使用 <code>@synthesize</code> 来关联实例变量和方法.</li>
<li>使用了 <code>@dynamic</code>, 需要用户去自己实现 <code>setter</code> 和 <code>getter</code> 方法时, 需要使用 <code>@synthesize</code> 来关联实例变量和方法.</li>
</ol>
<h2 id="属性特征"><a href="#属性特征" class="headerlink" title="属性特征"></a>属性特征</h2><p>读写性:</p>
<ul>
<li><code>readonly</code>: 只读状态, 只生成 <code>getter</code> 方法.</li>
<li><code>readwrite</code>: 读写状态, 生成 <code>setter</code> 和 <code>getter</code> 方法.</li>
<li><code>setter</code>: 指定属性生成的 <code>setter</code> 方法的名字.</li>
<li><code>getter</code>: 指定属性生成的 <code>getter</code> 方法的名字.</li>
</ul>
<p>原子性:</p>
<ul>
<li><code>atomic</code>: <code>setter</code> 和 <code>getter</code> 方法在多线程访问下是绝对安全的. 如果不声明, 系统默认选择.</li>
<li><code>nonatomic</code>: <code>setter</code> 和 <code>getter</code> 方法内部不会做多线程访问处理.</li>
</ul>
<p>语义特性:</p>
<ul>
<li><code>assgin</code>: 属性是非对象类型时使用, 不更改引用计数.</li>
<li><code>retain</code>: 属性是对象类型时使用. 指向的内存区域引用计数加一.原内存地址引用计数减一, 属于浅拷贝, 即内存地址拷贝.</li>
<li><code>copy</code>: 属性是对象类型时使用, 深拷贝得到对象的副本, 指针指向副本的地址, 而不是原内存地址. 副本内存地址引用计数加一. <code>setter</code> 方法中执行 <code>copy</code> 方法.</li>
</ul>
<blockquote>
<p>如果想要自己的类使用 <code>copy</code> 修饰符, 应该遵从 <code>NSCoping</code> 协议, 并且实现 <code>- (id)copyWithZone:(NSZone *)zone;</code> 方法.</p>
</blockquote>
<p>ARC下的新特性:</p>
<ul>
<li><code>strong</code>: 类似于 <code>retain</code> , 当声明 <code>strong</code> 的指针指向一个内存区域时, 这个内存区域的<em>引用计数+ 1</em>.</li>
<li><code>weak</code>: <code>weak</code> 指向内存区域时, 这个内存区域的<em>引用计数不会加一</em>, 而且当指向的内存区域被释放掉的时候, <code>weak</code> 的指针自动赋值为 <code>nil</code>.</li>
<li><code>unsafe_unretained</code>: 这个修饰的指针, 也不会使指向的内存区域引用计数增加, 但是当指向的内存区域被释放时, 指针不会自动赋值为 <code>nil</code>, 所以很容易造成空指针.</li>
</ul>
<h2 id="点语法"><a href="#点语法" class="headerlink" title="点语法"></a>点语法</h2><ul>
<li>赋值: 调用 <code>setter</code> 方法.</li>
<li>取值: 调用 <code>getter</code> 方法.</li>
</ul>
<h2 id="常用类型"><a href="#常用类型" class="headerlink" title="常用类型"></a>常用类型</h2><p><code>NSString</code>: 字符串类型, 有可变类型.<br><code>NSArray</code>: 数组类型, 排列有序, 有可变类型.<br><code>NSDictionary</code>: 字典类型, 排列无序, 有可变类型.<br><code>NSSet</code>: 集合类型, 排列无序, 用于计算对象的个数. 在集合中不能有相同的对象.<br><code>NSNumber</code>: 对象数值类型, 将非对象数值转换为对象类型.<br><code>NSValue</code>: 对象结构体类型, 将非对象结构体转换为对象类型.</p>
<h2 id="集合遍历"><a href="#集合遍历" class="headerlink" title="集合遍历"></a>集合遍历</h2><ul>
<li><code>for</code> 循环遍历</li>
<li><code>NSNumerator</code> 枚举器遍历</li>
<li><code>for...in</code> 遍历, 是在枚举器的基础上封装的更简便的遍历, 在便利的过程中<em>不能改变元素的个数</em>.</li>
</ul>
<h2 id="数组排序"><a href="#数组排序" class="headerlink" title="数组排序"></a>数组排序</h2><ul>
<li><code>NSSortDescriptior</code> 实现排序, 把元素的某个属性作为 <code>key</code> 进行升序或降序的排序, 每个 <code>NSSortDescriptor</code> 对象就是一个排序条件.</li>
</ul>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 参数1: 属性名 参数2: YES 为升序, NO 为降序</span></span><br><span class="line">- (<span class="keyword">instancetype</span>)initWithKey:(<span class="built_in">NSString</span> *)key ascending:(<span class="built_in">BOOL</span>)ascending;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 数组根据排序条件进行排序, 得到排好序的新的数组对象.</span></span><br><span class="line">- (<span class="built_in">NSArray</span> *)sortedArrayUsingDescriptors:(<span class="built_in">NSArray</span> *)sortDescriptors;</span><br></pre></td></tr></table></figure>
<p>其他数组排序方法</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// SEL 类型的参数 comparator: 需要传入一个返回结果是 NSComparisionResult 的方法名</span></span><br><span class="line">- (<span class="built_in">NSArray</span> *)sortedArrayUsingSelector:(SEL)comparator;</span><br></pre></td></tr></table></figure>
<h2 id="内存管理方式"><a href="#内存管理方式" class="headerlink" title="内存管理方式"></a>内存管理方式</h2><ul>
<li><code>GC</code>: 垃圾回收机制</li>
<li><code>MRC</code>: 手动开辟内存空间, 手动释放内存空间.</li>
<li><code>ARC</code>: 手动开辟内存空间, 系统根据情况自动释放内存空间.</li>
</ul>
<p><code>ARC</code> 基于 <code>MRC</code>, <code>MRC</code> 使用引用计数机制管理内存, 之后当引用计数清零时, 内存空间才会释放.</p>
<p>引用计数机制, 当创建时, 内存空间的引用计数为1, 有指针指向这个内存空间时, 此内存空间引用计数加1, 当引用计数为零时, 内存空间释放(销毁).</p>
<p><code>autorelease</code> 标记的内存, 会随着自动释放池销毁而一起释放, 在没有声明自动释放池的情况下, 会在 <code>runloop</code> 一个运行周期结束后释放.</p>
<p>当两个对象都用 <code>strong</code> 或者 <code>retain</code> 声明的时候, 应该尽量避免循环引用, 从而发生互相都在等待释放.</p>
<ul>
<li>浅拷贝: 只拷贝内存地址, 不拷贝内容.</li>
<li>深拷贝: 重新开辟一个空间, 并将原空间内的内容拷贝一份到新空间.</li>
</ul>
<blockquote>
<p>注意! 当需要将一个可变数组直接赋值给不可变数组时, 最好将不可变数组声明中加上 <code>copy</code>, 这是为了使不可变数组不随着可变数组一起变化, 使两个数组成为独立的个体. 当容器执行深拷贝的时候, 容器中的元素, 即指针只会执行浅拷贝, 而不会开辟空间来储存元素.</p>
</blockquote>
<h2 id="协议"><a href="#协议" class="headerlink" title="协议"></a>协议</h2><p>协议是一套标准, 或者一堆方法的声明.</p>
<p>接收协议的方式为指定代理对象.</p>
<p>代理对象用 <code>assign</code> 或者 <code>weak</code> 修饰, 防止循环引用.</p>
<p>协议声明用 <code>@protocol</code>, 必须实现的方法用 <code>@required</code> 声明, 可选择实现的方法用 <code>@optional</code> 声明.</p>
<h2 id="KVC"><a href="#KVC" class="headerlink" title="KVC"></a>KVC</h2><p><code>Key Value Coding</code> 键值编码, 是一种简介访问实例变量的方法.</p>
<p><code>KVC</code> 中常用的方法:</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">id</span>)valueForKey:(<span class="built_in">NSString</span> *)key;</span><br><span class="line">- (<span class="keyword">void</span>)setValue:(<span class="keyword">id</span>)value forKey:(<span class="built_in">NSString</span> *)key;</span><br><span class="line">- (<span class="keyword">id</span>)valueForKeyPath:(<span class="built_in">NSString</span> *)keyPath;</span><br><span class="line">- (<span class="keyword">void</span>)setValue:(<span class="keyword">id</span>)value forKeyPath:(<span class="built_in">NSString</span> *)keyPath;</span><br><span class="line">- (<span class="keyword">void</span>)setValuesForKeysWithDictionary:(<span class="built_in">NSDictionary</span> *)keyedValues;</span><br></pre></td></tr></table></figure>
<h2 id="类扩展"><a href="#类扩展" class="headerlink" title="类扩展"></a>类扩展</h2><p><code>category</code> 也叫类目</p>
<ul>
<li>是为没有源代码的类扩充功能.</li>
<li>扩充的功能会成为原有类的一部分, 可以通过原有类或者原有类的对象直接调用, 并且可以继承.</li>
<li>只扩充方法, 不能扩充实例变量.</li>
</ul>
<p><code>Extension</code> 也叫延展</p>
<ul>
<li>为能够获得源代码的类添加私有的实例变量和方法.</li>
<li>操作的类必须是能够获得源代码的类.</li>
</ul>
<h2 id="设计模式"><a href="#设计模式" class="headerlink" title="设计模式"></a>设计模式</h2><ul>
<li><code>MVC</code> 框架级设计模式</li>
<li><code>ViewController</code> 中介者模式</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/03/17/iOS_八_PHP后台开发/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZeroJi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZeroJi's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/03/17/iOS_八_PHP后台开发/" itemprop="url">iOS进阶（八）PHP后台开发</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-03-17T11:30:00+08:00">
                2016-03-17
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-04-28T17:02:03+08:00">
                2018-04-28
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="PHP-基本语法"><a href="#PHP-基本语法" class="headerlink" title="PHP 基本语法"></a>PHP 基本语法</h2><p>在’XAMPP’的根目录下的 <code>htcdocs</code> 文件夹中创建一个文件夹 <code>phpTest</code>.</p>
<p>使用文本编辑器创建一个文件 <code>apiTest.php</code>.</p>
<p>在其中编写 <code>PHP</code> 语句.</p>
<p>记得要在标签 <code>&lt;?php?&gt;</code> 的第二个问号前编写语句, 否则浏览器不识别.</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// php 输出函数</span></span><br><span class="line"><span class="keyword">echo</span>(rand(<span class="number">1</span>, <span class="number">10</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 输出换行</span></span><br><span class="line"><span class="keyword">echo</span> (<span class="string">"&lt;br&gt;"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// gettype 获取变量的类型, 返回类型是字符串.</span></span><br><span class="line"><span class="keyword">echo</span>(gettype($i).<span class="string">"&lt;br&gt;"</span>); <span class="comment">// php 中拼接字符串使用.号</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// strlen 获取字符串的长度</span></span><br><span class="line"><span class="keyword">echo</span>(strlen(<span class="string">"name"</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// substr 从下标n的位置向后截取字符串</span></span><br><span class="line"><span class="keyword">echo</span>(substr(<span class="string">"name"</span>, <span class="number">2</span>));</span><br><span class="line"></span><br><span class="line"><span class="comment">// 分支</span></span><br><span class="line">$a = <span class="number">5</span>;</span><br><span class="line">$b = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">if</span> ($a &gt; $b) &#123;</span><br><span class="line">    <span class="keyword">echo</span>($a.<span class="string">"&lt;br&gt;"</span>);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span>($b.<span class="string">"&lt;br&gt;"</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 数组</span></span><br><span class="line">$array = <span class="keyword">array</span>(<span class="number">4</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">3</span>);</span><br><span class="line"><span class="comment">// 数组排序</span></span><br><span class="line">sort($array);</span><br><span class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; <span class="number">4</span>; $i++) &#123;</span><br><span class="line">    <span class="keyword">echo</span>($array[$i].<span class="string">"&lt;br&gt;"</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 字符串改值</span></span><br><span class="line">$array[<span class="number">2</span>] = <span class="number">10</span>;</span><br><span class="line"><span class="keyword">unset</span>($array[<span class="number">2</span>]);</span><br><span class="line"><span class="comment">// json_encode 以json格式输出, 重要方法</span></span><br><span class="line"><span class="keyword">echo</span>(json_encode($array).<span class="string">"&lt;br&gt;"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 字典</span></span><br><span class="line">$person = <span class="keyword">array</span>(<span class="string">"name"</span> =&gt; <span class="string">"张三"</span>, <span class="string">"sex"</span> =&gt; <span class="string">"男"</span>, <span class="string">"age"</span> =&gt; <span class="number">30</span>);</span><br><span class="line"><span class="keyword">echo</span>(json_encode($person));</span><br><span class="line"></span><br><span class="line">$data = $_GET; <span class="comment">// get 处理请求数据的方式</span></span><br><span class="line">$data = $_POST; <span class="comment">// post 处理请求数据的方法</span></span><br><span class="line">$data = $_REQUEST; <span class="comment">// get 和 post 请求都可以处理</span></span><br></pre></td></tr></table></figure>
<p>建立与服务器交互, 并编写登录请求页面.</p>
<blockquote>
<p>切记, 在返回结果的时候, 一定不能有额外的字符串, 只能有 <code>json</code> 数据格式的数据.</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 与服务器本地服务器交互</span></span><br><span class="line"></span><br><span class="line">$data = $_REQUEST; 先选定处理请求数据的方式</span><br><span class="line"></span><br><span class="line">$name = $data[<span class="string">"name"</span>]; <span class="comment">// 从数据中提取 name</span></span><br><span class="line">$password = $data[<span class="string">"password"</span>]; <span class="comment">// 从数据中提取 password</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 登录服务器, 参数1:服务器 ip 地址, 参数2: 连接服务器使用的用户名, 参数3: 密码</span></span><br><span class="line">$connect = mysql_connect(<span class="string">"127.0.0.1"</span>, <span class="string">"root"</span>, <span class="string">""</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 选择数据库</span></span><br><span class="line">mysql_select_db(<span class="string">"Person"</span>, $connect);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取语句执行结果</span></span><br><span class="line">$result = mysql_query(<span class="string">"select * frome REgister where username = '$name'"</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 从结果中逐行获取数据</span></span><br><span class="line">$row = mysql_fetch-<span class="keyword">array</span>($result);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断密码是否相同</span></span><br><span class="line"><span class="keyword">if</span> ($row[<span class="string">"password"</span>] == $password) &#123;</span><br><span class="line">    $array[<span class="string">"result"</span>] = <span class="string">"success"</span>;</span><br><span class="line">    <span class="comment">// 返回给 app 是否登录成功</span></span><br><span class="line">    <span class="keyword">echo</span>(json_encode($array));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>记得在服务器中创建要用来存储的数据库.</p>
<p>注册请求页面</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">$datat = $POST;</span><br><span class="line"></span><br><span class="line">$name = $data[<span class="string">"name"</span>];</span><br><span class="line">$password = $data[<span class="string">"password"</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 登录服务器数据库 参数1: 数据库服务器地址 参数2: 服务器用户名 参数3: 密码</span></span><br><span class="line">$connect = mysql_connect(<span class="string">"127.0.0.1"</span>, <span class="string">"root"</span>, <span class="string">""</span>);</span><br><span class="line"><span class="keyword">if</span>($connect) &#123;</span><br><span class="line">    <span class="comment">//echo('链接服务器成功'.'&lt;br&gt;');</span></span><br><span class="line">    $array[<span class="string">"connect"</span>] = <span class="string">"success"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">//echo('连接服务器失败'.'&lt;br&gt;');</span></span><br><span class="line">    $array[<span class="string">"connect"</span>] = <span class="string">"error"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 选择数据库</span></span><br><span class="line">mysql_select_db(<span class="string">"Person"</span>, $connect);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将用户名.密码插入到数据库中</span></span><br><span class="line"><span class="keyword">if</span> (mysql_query(<span class="string">"INSERT INTO Register(username, password) VALUES ('$name', '$password')"</span>)) &#123;</span><br><span class="line">    <span class="comment">//echo "插入成功";</span></span><br><span class="line">    $array[<span class="string">"result"</span>] = <span class="string">"success"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="comment">//echo "插入失败";</span></span><br><span class="line">    $array[<span class="string">"result"</span>] = <span class="string">"error"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 返回是否注册成功</span></span><br><span class="line"><span class="keyword">echo</span>(json_encode($array));</span><br></pre></td></tr></table></figure>
<h2 id="iOS-请求方式"><a href="#iOS-请求方式" class="headerlink" title="iOS 请求方式"></a>iOS 请求方式</h2><p>登录请求</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// get 请求</span></span><br><span class="line"><span class="built_in">NSURLSession</span> *session = [<span class="built_in">NSURLSession</span> sharedSession];</span><br><span class="line"><span class="built_in">NSURL</span> *url = [<span class="built_in">NSURL</span> URLWithString:[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"http://127.0.0.1/phpTest/apiTest.php?name=%@&amp;password=%@"</span>, _usernameTextField.text, _passwordTextField.text]];</span><br><span class="line"><span class="built_in">NSURLSessionTask</span> *task = [session dataTaskWithURL:url completionHandler:^(<span class="built_in">NSData</span> * _Nullable data, <span class="built_in">NSURLResponse</span> * _Nullable response, <span class="built_in">NSError</span> * _Nullable error) &#123;</span><br><span class="line">    <span class="built_in">NSDictionary</span> *dic = [<span class="built_in">NSJSONSerialization</span> JSONObjectWithData:data options:<span class="built_in">NSJSONReadingMutableContainers</span> error:<span class="literal">nil</span>];</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@"</span>, dic[<span class="string">@"result"</span>]);</span><br><span class="line">&#125;];</span><br><span class="line">[task resume];</span><br><span class="line">                     </span><br><span class="line"><span class="comment">// post 请求</span></span><br><span class="line"><span class="built_in">NSURL</span> *url = [<span class="built_in">NSURL</span> URLWithString:<span class="string">@"http://127.0.0.1/phpTest/apiTest.php"</span>];</span><br><span class="line"><span class="built_in">NSMutableURLRequest</span> *request = [<span class="built_in">NSMutableURLRequest</span> requestWithURL:url];</span><br><span class="line">request.HTTPMethod = <span class="string">@"POST"</span>;</span><br><span class="line">request.HTTPBody = [[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"name=%@&amp;password=%@"</span>, _usernameTextField.text, _passwordTextField.text] dataUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line"><span class="built_in">NSURLSession</span> *session = [<span class="built_in">NSURLSession</span> sharedSession];</span><br><span class="line"><span class="built_in">NSURLSessionTask</span> *task = [session dataTaskWithRequest:request completionHandler:^(<span class="built_in">NSData</span> *data, <span class="built_in">NSURLResponse</span> *response, <span class="built_in">NSError</span> *error) &#123;</span><br><span class="line">    <span class="built_in">NSDictionary</span> *dic = [<span class="built_in">NSJSONSerialization</span> JSONObjectWithData:data options:<span class="built_in">NSJSONReadingMutableContainers</span> error:<span class="literal">nil</span>];</span><br><span class="line">    <span class="comment">//NSLog(@"%@", dic);</span></span><br><span class="line">    <span class="keyword">if</span> ([dic[<span class="string">@"result"</span>] isEqualToString:<span class="string">@"success"</span>]) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"登录成功"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;];</span><br><span class="line">[task resume];</span><br></pre></td></tr></table></figure>
<p>注册请求</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// post 请求</span></span><br><span class="line"><span class="built_in">NSURL</span> *url = [<span class="built_in">NSURL</span> URLWithString:<span class="string">@"http://127.0.0.1/phpTest/register.php"</span>];</span><br><span class="line"><span class="built_in">NSMutableURLRequest</span> *request = [<span class="built_in">NSMutableURLRequest</span> requestWithURL:url];</span><br><span class="line">request.HTTPMethod = <span class="string">@"POST"</span>;</span><br><span class="line">request.HTTPBody = [[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"name=%@&amp;password=%@"</span>, _usernameTextField.text, _passwordTextField.text] dataUsingEncoding:<span class="built_in">NSUTF8StringEncoding</span>];</span><br><span class="line"><span class="built_in">NSURLSession</span> *session = [<span class="built_in">NSURLSession</span> sharedSession];</span><br><span class="line"><span class="built_in">NSURLSessionTask</span> *task = [session dataTaskWithRequest:request completionHandler:^(<span class="built_in">NSData</span> *data, <span class="built_in">NSURLResponse</span> *response, <span class="built_in">NSError</span> *error) &#123;</span><br><span class="line">    <span class="built_in">NSDictionary</span> *dic = [<span class="built_in">NSJSONSerialization</span> JSONObjectWithData:data options:<span class="built_in">NSJSONReadingMutableContainers</span> error:<span class="literal">nil</span>];</span><br><span class="line">    <span class="comment">// 判断登录</span></span><br><span class="line">    <span class="keyword">if</span> ([dic[<span class="string">@"result"</span>] isEqualToString:<span class="string">@"success"</span>]) &#123;</span><br><span class="line">        <span class="comment">// 如果成功, 返回登录页面</span></span><br><span class="line">        [<span class="keyword">self</span>.navigationController popViewControllerAnimated:<span class="literal">YES</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;];</span><br><span class="line">[task resume];</span><br></pre></td></tr></table></figure>
<blockquote>
<p>注意, 尽量不要用 <code>GET</code> 请求, 因为 <code>GET</code> 请求会把账号密码或者数据暴露出来, 容易让人获取, 而 <code>POST</code> 请求会把数据打包, 很难直接捕获.</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/03/16/iOS进阶_十六_动画/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZeroJi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZeroJi's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/03/16/iOS进阶_十六_动画/" itemprop="url">iOS进阶（十六）动画</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-03-16T11:50:00+08:00">
                2016-03-16
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-04-28T17:01:57+08:00">
                2018-04-28
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="头尾式动画"><a href="#头尾式动画" class="headerlink" title="头尾式动画"></a>头尾式动画</h2><p>iOS 4.0之前, 如果想要实现动画, 采用的都是类方法.</p>
<p>除了需要设定改变视图的是哪个属性做动画之外, 还需要实现方法, 来标记动画的开始和结束.</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">UIView</span> *v = [<span class="built_in">UIView</span>]alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">100</span>, <span class="number">100</span>, <span class="number">100</span>, <span class="number">100</span>)];</span><br><span class="line">v.backgroundColor = [<span class="built_in">UIColor</span> redColor];</span><br><span class="line">[<span class="keyword">self</span>.view addSubview:v];</span><br><span class="line">            </span><br><span class="line"><span class="comment">// 开始设置 UIView 基础动画</span></span><br><span class="line">[<span class="built_in">UIView</span> beginAnimations:<span class="string">@"strenth"</span> context:<span class="literal">nil</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置动画时长为2s</span></span><br><span class="line">[<span class="built_in">UIView</span> setAnimationDuration:<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置重复次数</span></span><br><span class="line">[<span class="built_in">UIView</span> setAnimationRepeatCount:<span class="number">3</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置动画播放的回调对象</span></span><br><span class="line"><span class="comment">//    [UIView setAnimationDelegate:self];</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置动画过渡方式</span></span><br><span class="line">[<span class="built_in">UIView</span> setAnimationCurve:<span class="built_in">UIViewAnimationCurveEaseInOut</span>];</span><br><span class="line"><span class="comment">// 第一个参数设定动画执行方向, 第二个参数制定动画视图, 第三个参数制定是否使用图片缓存, 如果是YES, 效果更佳</span></span><br><span class="line">[<span class="built_in">UIView</span> setAnimationTransition:<span class="built_in">UIViewAnimationTransitionFlipFromLeft</span> forView:v cache:<span class="literal">YES</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 设置开始方法和结束方法</span></span><br><span class="line"><span class="comment">//    [UIView setAnimationWillStartSelector:@selector(animationDidStart: context:)];</span></span><br><span class="line"><span class="comment">//    [UIView setAnimationDidStopSelector:@selector(animationDidStop:finished:context:)];</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 改变它的 frame 的 x, y 的值, 即设置动画的最终值</span></span><br><span class="line"><span class="comment">//    v.frame = CGRectMake(200, 200, 100, 100);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 改变颜色</span></span><br><span class="line"><span class="comment">//    v.backgroundColor = [UIColor blueColor];</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 改变透明度</span></span><br><span class="line"><span class="comment">//    v.alpha = 0.0;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//v.transform = CGAffineTransformMakeScale(2, 0.5);</span></span><br><span class="line"><span class="comment">//    v.transform = CGAffineTransformMakeRotation(M_PI);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 开始播放动画</span></span><br><span class="line">[<span class="built_in">UIView</span> commitAnimations];</span><br></pre></td></tr></table></figure>
<p>因为设置了开始方法和结束方法, 所以要实现开始结束方法.</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)animationDidStart:(<span class="built_in">NSString</span> *)animationID context:(<span class="keyword">void</span> *)context &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@ %@"</span>, animationID, context);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)animationDidStop:(<span class="built_in">NSString</span> *)animationID finished:(<span class="built_in">NSNumber</span> *)finished context:(<span class="keyword">void</span> *)context &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"%@ %@"</span>, animationID, context);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="block动画"><a href="#block动画" class="headerlink" title="block动画"></a>block动画</h2><p>简单动画</p>
<p>参数1: 动画持续时间, 参数2: 动画执行体, 参数3: 动画结束时执行的block</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[<span class="built_in">UIView</span> animateWithDuration:<span class="number">3</span> animations:^&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"start"</span>);</span><br><span class="line">    v.center = <span class="keyword">self</span>.view.center;</span><br><span class="line">&#125; completion:^(<span class="built_in">BOOL</span> finished) &#123;</span><br><span class="line">    <span class="keyword">if</span> (finished) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"stop"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<p>复杂动画</p>
<p>参数1: 动画持续时间, 参数2: 动画执行前延迟的时间, 参数3: 动画执行方式, 参数4: 动画执行体, 参数5: 动画结束时执行的<code>block</code>.</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[<span class="built_in">UIView</span> animateWithDuration:<span class="number">0.5</span> delay:<span class="number">3</span> options:<span class="built_in">UIViewAnimationOptionRepeat</span> animations:^&#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"start"</span>);</span><br><span class="line">    v.center = <span class="keyword">self</span>.view.center;</span><br><span class="line">&#125; completion:^(<span class="built_in">BOOL</span> finished) &#123;</span><br><span class="line">    <span class="keyword">if</span> (finished) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"stop"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<p>关键帧动画</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[<span class="built_in">UIView</span> animateKeyframesWithDuration:<span class="number">3</span> delay:<span class="number">0.0</span> options:<span class="built_in">UIViewKeyframeAnimationOptionAutoreverse</span> animations:^&#123;</span><br><span class="line">    <span class="comment">// startTime 和 relativeDuration 都是相对于整个关键帧动画的持续时间的百分比</span></span><br><span class="line">    [<span class="built_in">UIView</span> addKeyframeWithRelativeStartTime:<span class="number">0.0</span> relativeDuration:<span class="number">0.25</span> animations:^&#123;</span><br><span class="line">        v.center = <span class="keyword">self</span>.view.center;</span><br><span class="line">    &#125;];</span><br><span class="line">&#125; completion:^(<span class="built_in">BOOL</span> finished) &#123;</span><br><span class="line">    <span class="keyword">if</span> (finished) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"finished"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure>
<p>spring动画</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[<span class="built_in">UIView</span> animateWithDuration:<span class="number">3.0</span> <span class="comment">// 动画时长</span></span><br><span class="line">                      delay:<span class="number">0.0</span> <span class="comment">// 动画延迟</span></span><br><span class="line">     usingSpringWithDamping:<span class="number">0.5</span> <span class="comment">// 类似弹簧效果 0~1</span></span><br><span class="line">      initialSpringVelocity:<span class="number">15.0</span> <span class="comment">// 初始速度</span></span><br><span class="line">                     options:<span class="built_in">UIViewAnimationOptionCurveEaseOut</span> <span class="comment">// 动画过度效果</span></span><br><span class="line">                  animations:^&#123; <span class="comment">// 执行的block</span></span><br><span class="line">                        v.center = <span class="keyword">self</span>.view.center;</span><br><span class="line">                    &#125; completion:^(<span class="built_in">BOOL</span> finished) &#123; <span class="comment">// 结束后执行的block</span></span><br><span class="line">                        <span class="keyword">if</span> (finished) &#123;</span><br><span class="line">                            <span class="built_in">NSLog</span>(<span class="string">@"finished"</span>);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;];</span><br></pre></td></tr></table></figure>
<h2 id="CoreAnimation动画"><a href="#CoreAnimation动画" class="headerlink" title="CoreAnimation动画"></a>CoreAnimation动画</h2><p>CoreAnimation 基本介绍</p>
<ul>
<li><code>CoreAnimation</code> 动画位于 <code>iOS</code> 框架的 <code>Media</code> 层</li>
<li><code>CoreAnimation</code> 动画实现需要添加 <code>QuartzCore.Framework</code></li>
<li><code>CoreAnimation</code> 基本上是 <code>layer Animation</code></li>
</ul>
<p>CALayer 基本介绍</p>
<ul>
<li><code>CALayer</code> 负责绘制, 提供 <code>UIView</code> 需要展示的内容, 不能交互.</li>
<li><code>UIView</code> 负责交互, 显示 <code>CALayer</code> 绘制的内容.</li>
</ul>
<p><code>CALayer</code> 层是屏幕上的一个矩形区域, 在每一个 <code>UIView</code> 中都包含一个根<code>CALayer</code>, 在 <code>UIView</code> 上的所有视觉效果都是在这个 <code>Layer</code> 上进行的.</p>
<p><code>CALayer</code> 外形特征主要包括:</p>
<ol>
<li>层的大小尺寸</li>
<li>背景颜色</li>
<li>内容(可以填充图片或者使用 <code>Core Graphics</code> 绘制的内容)</li>
<li>矩形是否使用圆角</li>
<li>矩形是否有阴影</li>
</ol>
<p><code>Layer</code> 有很多种, 最常用也是最基本的是 <code>CALayer</code>, 当然还包括其他子类:</p>
<ul>
<li><code>CAScrollerLayer</code> 简化显示层的一部分</li>
<li><code>CATextLayer</code> 文本层</li>
<li><code>CAGradientLayer</code> <code>CAShapeLayer</code> 等等</li>
</ul>
<p><code>UIView</code> 是 <code>iOS</code> 系统中界面元素的基础, 所有的界面元素都是继承自它. 它本身完全是由 <code>CoreAnimation</code> 来实现的. 它真正的绘制部分, 是由一个 <code>CALayer</code> 类来管理的. <code>UIView</code> 本身更像是一个 <code>CALayer</code> 的管理器, 访问它的跟绘图和跟坐标有关的属性, 例如 <code>frame</code>, <code>bounds</code> 等, 实际上内部都是在访问它所包含的 <code>CALayer</code> 的相关属性.</p>
<p><code>UIView</code> 有个重要属性 <code>layer</code>, 可以返回它的主 <code>CALayer</code> 实例.</p>
<p><code>UIView</code> 的 <code>CALayer</code> 类似 <code>UIView</code> 的子 <code>View</code> 树形结构, 也可以向它的 <code>layer</code> 上添加子 <code>layer</code>, 来完成某些特殊的表示. 即 <code>CALayer</code> 层是可以嵌套的.</p>
<p><code>CALayer</code> 的常用属性:</p>
<ul>
<li><code>cornerRadius</code> 圆角</li>
<li><code>shadowColor</code> 阴影颜色</li>
<li><code>shadowOffset</code> 阴影偏移距离</li>
<li><code>shadowRadius</code> 阴影模糊程度</li>
<li><code>shadowOpacity</code> 阴影透明度</li>
<li><code>borderWidth</code> 边框宽度</li>
<li><code>borderColor</code> 边框颜色</li>
<li><code>anchorPoint</code> 锚点</li>
<li><code>position</code> 当前位置信息</li>
<li><code>transfrom</code> 使 <code>CALayer</code> 产生3D空间内的平移, 缩放, 旋转等变化</li>
</ul>
<p><code>CABasicAnimation</code> 动画</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建一个 basic 动画</span></span><br><span class="line"><span class="comment">// keyPath 必须填写 CALayer 能做动画的属性, 或者这些属性中的值.</span></span><br><span class="line"><span class="comment">//    CABasicAnimation *basic = [CABasicAnimation animationWithKeyPath:@"position.y"];</span></span><br><span class="line"><span class="comment">//    CABasicAnimation *basic = [CABasicAnimation animationWithKeyPath:@"cornerRadius"];</span></span><br><span class="line"><span class="built_in">CABasicAnimation</span> *basic = [<span class="built_in">CABasicAnimation</span> animationWithKeyPath:<span class="string">@"backgroundColor"</span>];</span><br><span class="line">basic.toValue = (__bridge <span class="keyword">id</span> _Nullable)([<span class="built_in">UIColor</span> redColor].CGColor);</span><br><span class="line"></span><br><span class="line"><span class="comment">// NSNumber 这个类的作用是将基本数据类型与对象类型实现互转</span></span><br><span class="line"><span class="comment">// NSValue 这个类的作用是将结构体与对象类型实现互转</span></span><br><span class="line"><span class="comment">//    basic.fromValue = @(self.imageView.layer.position.y);</span></span><br><span class="line"><span class="comment">//    basic.toValue = @400;</span></span><br><span class="line"><span class="comment">//    basic.byValue = @300;</span></span><br><span class="line"></span><br><span class="line">basic.duration = <span class="number">3</span>;</span><br><span class="line">basic.repeatCount = <span class="number">2</span>;</span><br><span class="line"><span class="comment">//    basic.delegate = self;</span></span><br><span class="line"></span><br><span class="line">[<span class="keyword">self</span>.imageView.layer addAnimation:basic forKey:<span class="string">@"y动画"</span>];</span><br></pre></td></tr></table></figure>
<p>如果想在动画之后保持动画动画结束的状态, 可以实现结束之后的代理方法, 来将状态保存, 直接修改 <code>layer</code> 的状态是不可取的.</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)animationDidStop:(<span class="built_in">CAAnimation</span> *)anim finished:(<span class="built_in">BOOL</span>)flag</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> (flag) &#123;</span><br><span class="line">        <span class="comment">// 保持动画最后的结束状态</span></span><br><span class="line">        <span class="built_in">CGPoint</span> position = <span class="keyword">self</span>.imageView.layer.position;</span><br><span class="line">        position.y = <span class="number">400</span>;</span><br><span class="line">        <span class="keyword">self</span>.imageView.layer.position = position;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>CAKeyframeAnimation</code> 动画</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">CAKeyframeAnimation</span> *keyFrame = [<span class="built_in">CAKeyframeAnimation</span> animationWithKeyPath:<span class="string">@"position.x"</span>];</span><br><span class="line"><span class="built_in">CGFloat</span> center = <span class="keyword">self</span>.imageView.layer.position.x;</span><br><span class="line"><span class="built_in">CGFloat</span> left = center - <span class="number">5</span>;</span><br><span class="line"><span class="built_in">CGFloat</span> right = center + <span class="number">5</span>;</span><br><span class="line"><span class="comment">// 转换为对象</span></span><br><span class="line"><span class="built_in">NSNumber</span> *c = [<span class="built_in">NSNumber</span> numberWithFloat:center];</span><br><span class="line"><span class="built_in">NSNumber</span> *l = [<span class="built_in">NSNumber</span> numberWithFloat:left];</span><br><span class="line"><span class="built_in">NSNumber</span> *r = [<span class="built_in">NSNumber</span> numberWithFloat:right];</span><br><span class="line">keyFrame.values = @[c, l, c, r, c, l, c, r, c, l, c, r, c, l, c];</span><br><span class="line">keyFrame.duration = <span class="number">0.1</span>;</span><br><span class="line">keyFrame.repeatCount = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">[<span class="keyword">self</span>.imageView.layer addAnimation:keyFrame forKey:<span class="string">@"晃动"</span>];</span><br></pre></td></tr></table></figure>
<p><code>CAAnimationGroup</code> 动画</p>
<figure class="highlight objc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建组动画</span></span><br><span class="line"><span class="built_in">CAAnimationGroup</span> *group = [<span class="built_in">CAAnimationGroup</span> animation];</span><br><span class="line">group.duration = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 开始创建内部动画</span></span><br><span class="line"><span class="built_in">CABasicAnimation</span> *basic = [<span class="built_in">CABasicAnimation</span> animationWithKeyPath:<span class="string">@"position.y"</span>];</span><br><span class="line">basic.duration = <span class="number">2</span>;</span><br><span class="line">basic.toValue = @<span class="number">400</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 第二个动画</span></span><br><span class="line"><span class="built_in">CABasicAnimation</span> *basic1 = [<span class="built_in">CABasicAnimation</span> animationWithKeyPath:<span class="string">@"opacity"</span>];</span><br><span class="line">basic1.duration = <span class="number">3</span>;</span><br><span class="line">basic1.toValue = @<span class="number">0.3</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 将创建的内部动画加入组动画中</span></span><br><span class="line">group.animations = @[basic, basic1];</span><br><span class="line"></span><br><span class="line">[<span class="keyword">self</span>.imageView.layer addAnimation:group forKey:<span class="string">@"屌爆"</span>];</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/03/14/Swift_十四_析构过程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZeroJi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZeroJi's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/03/14/Swift_十四_析构过程/" itemprop="url">Swift (十四) 析构过程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-03-14T01:40:00+08:00">
                2016-03-14
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-04-28T17:04:59+08:00">
                2018-04-28
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="析构过程原理"><a href="#析构过程原理" class="headerlink" title="析构过程原理"></a>析构过程原理</h2><p>析构器只使用于类类型,当一个类的实例被释放之前,析构器会被立即调用.</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Deinit</span> </span>&#123;</span><br><span class="line">    <span class="keyword">deinit</span> &#123; <span class="comment">// 固定方法</span></span><br><span class="line">        <span class="comment">// 执行析构过程</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>// 析构器实践</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bank</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> coinsInBank = <span class="number">10_000</span></span><br><span class="line">        <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">venCoins</span><span class="params">(<span class="keyword">var</span> numberOfCoinsToVend: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">            numberOfCoinsToVend = <span class="built_in">min</span>(numberOfCoinsToVend, coinsInBank)</span><br><span class="line">            coinsInBank -= numberOfCoinsToVend</span><br><span class="line">            <span class="keyword">return</span> numberOfCoinsToVend</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">receiverCoins</span><span class="params">(coins: Int)</span></span> &#123;</span><br><span class="line">        coinsInBank += coins</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Player</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> coinsInPurse: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">init</span>(coins: <span class="type">Int</span>) &#123;</span><br><span class="line">        coinsInPurse = <span class="type">Bank</span>.vendCoins(coins)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">winCoins</span><span class="params">(coins: Int)</span></span> &#123;</span><br><span class="line">        coinInpurse += <span class="type">Bank</span>.venCoins(coins)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">deinit</span> &#123;</span><br><span class="line">        <span class="type">Bank</span>.receiverCoins(coinsInPurse)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> playerOne: <span class="type">Player</span>? = <span class="type">Player</span>(coins:<span class="number">100</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"A new player has joined the game with \(playerOne!.coinsInPurse) conins"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"There are now \(Bank.coinsInBank) coins left in the bank"</span>)</span><br><span class="line"></span><br><span class="line">playerOne!.winCoins(<span class="number">2_000</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"PlayerOne won 2000 coins &amp; now has \(playerOne!.coinsInPurse) coins"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"The bank now only has \(Bank.coinsInBank) coins left"</span>)</span><br><span class="line"></span><br><span class="line">playerOne = <span class="literal">nil</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"PlayerOne has left the game"</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"The bank now has \(Bank.coinsInBank) coins"</span>)</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/03/13/Swift_十三_构造过程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZeroJi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZeroJi's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/03/13/Swift_十三_构造过程/" itemprop="url">Swift (十三) 构造过程</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-03-13T12:30:00+08:00">
                2016-03-13
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-04-28T17:04:54+08:00">
                2018-04-28
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="储存属性的初始赋值"><a href="#储存属性的初始赋值" class="headerlink" title="储存属性的初始赋值"></a>储存属性的初始赋值</h2><p>类和结构体在创建实例时,必须为所有储存型属性设置合适的初始值</p>
<h2 id="构造器"><a href="#构造器" class="headerlink" title="构造器"></a>构造器</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Fahrenheit</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> temperature: <span class="type">Double</span> </span><br><span class="line">    <span class="keyword">init</span>() &#123;</span><br><span class="line">        temperature = <span class="number">32.0</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> f = <span class="type">Fahrenheit</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"The default temperature is \(f.temperature)° Fahrenheit"</span>)</span><br></pre></td></tr></table></figure>
<h2 id="默认属性值"><a href="#默认属性值" class="headerlink" title="默认属性值"></a>默认属性值</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Fahrenheit</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> temperature = <span class="number">32.0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> f = <span class="type">Fahrenheit</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"The default temperature is \(f.temperature)° Fahrenheit"</span>)</span><br></pre></td></tr></table></figure>
<h2 id="构造参数"><a href="#构造参数" class="headerlink" title="构造参数"></a>构造参数</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Celsius</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> temperatureInCelsius: <span class="type">Double</span></span><br><span class="line">    <span class="keyword">init</span>(formFahrenheit fahrenheit: <span class="type">Double</span>) &#123;</span><br><span class="line">        temperatureInCelsius = (fahrenheit - <span class="number">32.0</span>) / <span class="number">1.8</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">init</span>(formKelvin kelvin: <span class="type">Double</span>) &#123;</span><br><span class="line">        temperatureInCelsius = kelvin  - <span class="number">273.15</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> boilingPointOfWater = <span class="type">Celsius</span>(formFahrenheit: <span class="number">212.0</span>)</span><br><span class="line"><span class="built_in">print</span>(boilingPointOfWater.temperatureInCelsius)</span><br><span class="line"><span class="keyword">let</span> freezingPointOfWater = <span class="type">Celsius</span>(formKelvin: <span class="number">273.15</span>)</span><br><span class="line"><span class="built_in">print</span>(freezingPointOfWater.temperatureInCelsius)</span><br></pre></td></tr></table></figure>
<h2 id="参数内部名称和外部名称"><a href="#参数内部名称和外部名称" class="headerlink" title="参数内部名称和外部名称"></a>参数内部名称和外部名称</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Color</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> red, green, blue: <span class="type">Double</span></span><br><span class="line">    <span class="keyword">init</span>(red: <span class="type">Double</span>, green: <span class="type">Double</span>, blue: <span class="type">Double</span>) &#123; <span class="comment">// 如果没有给构造器第一个参数指定外部名称,则内部名称即为外部名称</span></span><br><span class="line">        <span class="keyword">self</span>.red = red</span><br><span class="line">        <span class="keyword">self</span>.green = green</span><br><span class="line">        <span class="keyword">self</span>.blue = blue</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">init</span>(white: <span class="type">Double</span>) &#123;</span><br><span class="line">        red = white</span><br><span class="line">        green = white</span><br><span class="line">        blue = white</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> magenta = <span class="type">Color</span>(red: <span class="number">1.0</span>, green: <span class="number">0.0</span>, blue: <span class="number">1.0</span>)</span><br><span class="line"><span class="keyword">let</span> halfGray = <span class="type">Color</span>(white: <span class="number">0.5</span>)</span><br><span class="line"><span class="comment">// let veryGreen = Color(0.0, 1.0, 0.0) // 如果不通过外部参数名字传值,是没法使用这个构造器的</span></span><br></pre></td></tr></table></figure>
<h2 id="不带外部名的构造器参数"><a href="#不带外部名的构造器参数" class="headerlink" title="不带外部名的构造器参数"></a>不带外部名的构造器参数</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NewCelsius</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> temperatureInCelsius: <span class="type">Double</span></span><br><span class="line">    <span class="keyword">init</span>(framFahrenheit fahrenheit: <span class="type">Double</span>) &#123;</span><br><span class="line">        temperatureInCelsius = (fahrenheit - <span class="number">32.0</span>) / <span class="number">1.8</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">init</span>(fromKelvin kelvin: <span class="type">Double</span>) &#123;</span><br><span class="line">        temperatureInCelsius = kelvin - <span class="number">273.15</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">init</span>(<span class="number">_</span> celsius: <span class="type">Double</span>) &#123; <span class="comment">// 如果用_当外部名,则外部名为空</span></span><br><span class="line">        temperatureInCelsius = celsius</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> bodyTemperature = <span class="type">NewCelsius</span>(<span class="number">37.0</span>)</span><br><span class="line"><span class="built_in">print</span>(bodyTemperature.temperatureInCelsius)</span><br></pre></td></tr></table></figure>
<h2 id="可选属性类型"><a href="#可选属性类型" class="headerlink" title="可选属性类型"></a>可选属性类型</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SurveyQuestion</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> text: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> response: <span class="type">String</span>? <span class="comment">// 如果可选类型在初始化时没有赋值,则自动赋值为nil</span></span><br><span class="line">    <span class="keyword">init</span>(text: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.text = text</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">ask</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(text)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> cheeseQuestion = <span class="type">SurveyQuestion</span>(text: <span class="string">"Do you like cheese?"</span>)</span><br><span class="line">cheeseQuestion.ask()</span><br><span class="line">cheeseQuestion.response = <span class="string">"Yes, I do like cheese"</span></span><br></pre></td></tr></table></figure>
<h2 id="构造过程中常量属性的修改"><a href="#构造过程中常量属性的修改" class="headerlink" title="构造过程中常量属性的修改"></a>构造过程中常量属性的修改</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NewsurveyQuestion</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> text: <span class="type">String</span> <span class="comment">// 常量只能在实例化的构造过程中修改,一旦确定,之后就无法修改;不能再子类中修改</span></span><br><span class="line">    <span class="keyword">var</span> response: <span class="type">String</span>?</span><br><span class="line">    <span class="keyword">init</span>(text: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.text = text</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">ask</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(text)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="默认构造器"><a href="#默认构造器" class="headerlink" title="默认构造器"></a>默认构造器</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ShoppingListItem</span> </span>&#123; <span class="comment">// 如果所有属性都有默认值,则系统会默认提供一个构造器</span></span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span>?</span><br><span class="line">    <span class="keyword">var</span> quatity = <span class="number">1</span></span><br><span class="line">    <span class="keyword">var</span> purchased = <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> item = <span class="type">ShoppingListItem</span>()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 结构体的逐一成员构造器</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Size</span> </span>&#123; <span class="comment">// 如果结构体没有构造器,系统会提供一个逐一构造器,用来给所有属性赋值</span></span><br><span class="line">    <span class="keyword">var</span> width = <span class="number">0.0</span>, height = <span class="number">0.0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> twoByTwo = <span class="type">Size</span>(width: <span class="number">2.0</span>, height: <span class="number">2.0</span>)</span><br></pre></td></tr></table></figure>
<h2 id="结构体的逐一成员构造器"><a href="#结构体的逐一成员构造器" class="headerlink" title="结构体的逐一成员构造器"></a>结构体的逐一成员构造器</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span> </span>&#123;</span><br><span class="line">     <span class="keyword">var</span> x = <span class="number">0.0</span>, y = <span class="number">0.0</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Rect</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> origin = <span class="type">Point</span>()</span><br><span class="line">    <span class="keyword">var</span> size = <span class="type">Size</span>()</span><br><span class="line">    <span class="keyword">init</span>() &#123;&#125;</span><br><span class="line">    <span class="keyword">init</span>(origin: <span class="type">Point</span>, size: <span class="type">Size</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.origin = origin</span><br><span class="line">        <span class="keyword">self</span>.size = size</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">init</span>(center: <span class="type">Point</span>, size: <span class="type">Size</span>) &#123;</span><br><span class="line">        <span class="keyword">let</span> originX = center.x - (size.width / <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">let</span> originY = center.y - (size.height / <span class="number">2</span>)</span><br><span class="line">        <span class="keyword">self</span>.<span class="keyword">init</span>(origin: <span class="type">Point</span>(x: originX, y: originY), size: size) <span class="comment">// 可以用self.init来引用类型中的其他构造器</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> basicRect = <span class="type">Rect</span>() <span class="comment">// 第一个构造器</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> originRect = <span class="type">Rect</span>(origin: <span class="type">Point</span>(x: <span class="number">2.0</span>, y: <span class="number">2.0</span>), size: <span class="type">Size</span>(width: <span class="number">5.0</span>, height: <span class="number">5.0</span>)) <span class="comment">// 第二个构造器</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> centerRect = <span class="type">Rect</span>(center: <span class="type">Point</span>(x: <span class="number">4.0</span>, y: <span class="number">4.0</span>), size: <span class="type">Size</span>(width: <span class="number">3.0</span>, height: <span class="number">3.0</span>)) <span class="comment">// 第三个构造器</span></span><br></pre></td></tr></table></figure>
<h2 id="类的继承和构造过程"><a href="#类的继承和构造过程" class="headerlink" title="类的继承和构造过程"></a>类的继承和构造过程</h2><ul>
<li>类里面的所有储存型属性,包括继承自父类的属性,都必须在构造过程中设置初始值.</li>
<li>Swift为类类型提供了两种构造器来确保实例中所有储存型属性都能够获得初始值,它们分别是制定构造器和便利构造器.</li>
</ul>
<h2 id="构造器的继承和重写"><a href="#构造器的继承和重写" class="headerlink" title="构造器的继承和重写"></a>构造器的继承和重写</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vehicle</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> numberOfWheels = <span class="number">0</span></span><br><span class="line">    <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"\(numberOfWheels) wheel(s)"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> vehicle = <span class="type">Vehicle</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Vehicle: \(vehicle.description)"</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Bicycle</span>: <span class="title">Vehicle</span> </span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">init</span>() &#123; <span class="comment">// override关键字修饰的init,代表重写父类的init方法</span></span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>() <span class="comment">// super.init()表示调用父类的init()方法</span></span><br><span class="line">        numberOfWheels = <span class="number">2</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> bicycle = <span class="type">Bicycle</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Bicycle: \(bicycle.description)"</span>)</span><br></pre></td></tr></table></figure>
<h2 id="制定构造器和便利构造器实践"><a href="#制定构造器和便利构造器实践" class="headerlink" title="制定构造器和便利构造器实践"></a>制定构造器和便利构造器实践</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Food</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">init</span>(name: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.name = name</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">convenience</span> <span class="keyword">init</span>() &#123; <span class="comment">// convenience 关键字修饰便利构造器</span></span><br><span class="line">        <span class="keyword">self</span>.<span class="keyword">init</span>(name: <span class="string">"[Unnamed]"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> namedMeat = <span class="type">Food</span>(name: <span class="string">"Bacon"</span>)</span><br><span class="line"><span class="built_in">print</span>(namedMeat.name)</span><br><span class="line"><span class="keyword">let</span> mysteryMeat = <span class="type">Food</span>()</span><br><span class="line"><span class="built_in">print</span>(mysteryMeat.name)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RecipeIngredient</span>: <span class="title">Food</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> quantity: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">init</span>(name: <span class="type">String</span>, quantity: <span class="type">Int</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.quantity = quantity</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(name: name)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">convenience</span> <span class="keyword">init</span>(name: <span class="type">String</span>) &#123;</span><br><span class="line">       <span class="keyword">self</span>.<span class="keyword">init</span>(name: name, quantity: <span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> oneMysteryItem = <span class="type">RecipeIngredient</span>()</span><br><span class="line"><span class="keyword">let</span> oneBacon = <span class="type">RecipeIngredient</span>(name: <span class="string">"Bacon"</span>)</span><br><span class="line"><span class="keyword">let</span> sixEggs = <span class="type">RecipeIngredient</span>(name: <span class="string">"Eggs"</span>, quantity: <span class="number">6</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NewShoppingListItem</span>: <span class="title">RecipeIngredient</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> purchased = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">var</span> output = <span class="string">"\(quantity) x \(name)"</span></span><br><span class="line">        output += purchased ? <span class="string">"√"</span> : <span class="string">"×"</span></span><br><span class="line">        <span class="keyword">return</span> output</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> breakfastList = [</span><br><span class="line">    <span class="type">NewShoppingListItem</span>(),</span><br><span class="line">    <span class="type">NewShoppingListItem</span>(name: <span class="string">"Bacon"</span>),</span><br><span class="line">    <span class="type">NewShoppingListItem</span>(name: <span class="string">"Eggs"</span>, quantity: <span class="number">6</span>)</span><br><span class="line">]</span><br><span class="line">breakfastList[<span class="number">0</span>].name = <span class="string">"Orange juice"</span></span><br><span class="line">breakfastList[<span class="number">0</span>].purchased = <span class="literal">true</span></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> breakfastList &#123;</span><br><span class="line">    <span class="built_in">print</span>(item.description)</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="可失败构造器"><a href="#可失败构造器" class="headerlink" title="可失败构造器"></a>可失败构造器</h2><p>可失败构造器的参数名和参数类型,不能与其他非可失败构造器的参数名,以及参数类型相同</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">truct <span class="type">Animal</span> &#123;</span><br><span class="line">    <span class="keyword">let</span> species: <span class="type">String</span></span><br><span class="line">    <span class="keyword">init</span>?(species: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> species.isEmpty &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">self</span>.species = species</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> someCreature = <span class="type">Animal</span>(species: <span class="string">"Giraffe"</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> giraffe = someCreature &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"An animal was initialized with a species of \(giraffe.species)"</span>)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> anonymousCreature = <span class="type">Animal</span>(species: <span class="string">""</span>)</span><br><span class="line"><span class="keyword">if</span> anonymousCreature == <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"The anoymous creature counld not be initialized"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="枚举类型的可失败构造器"><a href="#枚举类型的可失败构造器" class="headerlink" title="枚举类型的可失败构造器"></a>枚举类型的可失败构造器</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">TemperatureUnit</span> </span>&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Kelvin</span>, <span class="type">Celsius</span>, <span class="type">Fahrenheit</span></span><br><span class="line">    <span class="keyword">init</span>?(symbol: <span class="type">Character</span>) &#123;</span><br><span class="line">        <span class="keyword">switch</span> symbol &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">"K"</span>:</span><br><span class="line">            <span class="keyword">self</span> = .<span class="type">Kelvin</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">"C"</span>:</span><br><span class="line">            <span class="keyword">self</span> = .<span class="type">Celsius</span></span><br><span class="line">        <span class="keyword">case</span> <span class="string">"F"</span>:</span><br><span class="line">            <span class="keyword">self</span> = .<span class="type">Fahrenheit</span></span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nil</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> fahrenheitUnit = <span class="type">TemperatureUnit</span>(symbol: <span class="string">"F"</span>)</span><br><span class="line"><span class="keyword">if</span> fahrenheitUnit != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"This is a deined temperature unit, so initialization succeeded."</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> unknownUnit = <span class="type">TemperatureUnit</span>(symbol: <span class="string">"X"</span>)</span><br><span class="line"><span class="keyword">if</span> unknownUnit == <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"This is not a defined temperature unit, so initialization failed."</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="带初始值的枚举类型的可失败构造器"><a href="#带初始值的枚举类型的可失败构造器" class="headerlink" title="带初始值的枚举类型的可失败构造器"></a>带初始值的枚举类型的可失败构造器</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">NewTemperatureUnit</span>: <span class="title">Character</span> </span>&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Kelvin</span> = <span class="string">"K"</span>, <span class="type">Celsius</span> = <span class="string">"C"</span>, <span class="type">Fahrenheit</span> = <span class="string">"F"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> newFahrenheitUnit = <span class="type">NewTemperatureUnit</span>(rawValue: <span class="string">"F"</span>)</span><br><span class="line"><span class="keyword">if</span> newFahrenheitUnit != <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"This is a defined temperature unit, so initialization succeeded."</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> newUnknownUnit = <span class="type">NewTemperatureUnit</span>(rawValue: <span class="string">"X"</span>)</span><br><span class="line"><span class="keyword">if</span> newUnknownUnit == <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"This is not a defined temperature unit, so initialization failed."</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="类的可失败构造器"><a href="#类的可失败构造器" class="headerlink" title="类的可失败构造器"></a>类的可失败构造器</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> name: <span class="type">String</span>!</span><br><span class="line">    <span class="keyword">init</span>?(name: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.name = name</span><br><span class="line">        <span class="keyword">if</span> name.isEmpty &#123; <span class="keyword">return</span> <span class="literal">nil</span>  &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> bowTie = <span class="type">Product</span>(name: <span class="string">"bow tie"</span>) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"The product's name is \(bowTie.name)"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="构造失败的传值"><a href="#构造失败的传值" class="headerlink" title="构造失败的传值"></a>构造失败的传值</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CartItem</span>: <span class="title">Product</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> quantity: <span class="type">Int</span>!</span><br><span class="line">    <span class="keyword">init</span>?(name: <span class="type">String</span>, quantity: <span class="type">Int</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.quantity = quantity</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(name: name)</span><br><span class="line">        <span class="keyword">if</span> quantity &lt; <span class="number">1</span> &#123; <span class="keyword">return</span> <span class="literal">nil</span>  &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> twoSocks = <span class="type">CartItem</span>(name: <span class="string">"sock"</span>, quantity: <span class="number">2</span>) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"item: \(twoSocks.name), quantity: \(twoSocks.quantity)"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> zeroShirts = <span class="type">CartItem</span>(name: <span class="string">"shirt"</span>, quantity: <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"item: \(zeroShirts.name), quantity: \(zeroShirts.quantity)"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Unable to initialize zero shirts"</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> oneUnnamed = <span class="type">CartItem</span>(name: <span class="string">""</span>, quantity: <span class="number">1</span>) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"item: \(oneUnnamed.name), quantity: \(oneUnnamed.quantity)"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"Unable to initialize zero shirts"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="重写一个可失败构造器"><a href="#重写一个可失败构造器" class="headerlink" title="重写一个可失败构造器"></a>重写一个可失败构造器</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Document</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span>?</span><br><span class="line">    <span class="keyword">init</span>()&#123;&#125; <span class="comment">// 该构造器构件了一个name属性的值为nil 的document实例</span></span><br><span class="line">    <span class="keyword">init</span>?(name: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.name = name</span><br><span class="line">        <span class="keyword">if</span> name.isEmpty &#123; <span class="keyword">return</span> <span class="literal">nil</span>  &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AutomaticallyNamedDocument</span>: <span class="title">Document</span> </span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">init</span>() &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>()</span><br><span class="line">        <span class="keyword">self</span>.name = <span class="string">"[Untitled]"</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">init</span>(name: <span class="type">String</span>) &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>()</span><br><span class="line">        <span class="keyword">if</span> name.isEmpty &#123;</span><br><span class="line">            <span class="keyword">self</span>.name = <span class="string">"[Untitled]"</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">self</span>.name = name</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UntitledDocument</span>: <span class="title">Document</span> </span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">init</span>() &#123;</span><br><span class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(name: <span class="string">"[Untitled]"</span>)!</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="可失败构造器init"><a href="#可失败构造器init" class="headerlink" title="可失败构造器init!"></a>可失败构造器init!</h2><p>通常来说我们通过在<code>init</code>关键字后面添加问号的方式来定义一个可失败构造器,但也可以通过在<code>init</code>后面添加感叹号的方式来定义一个可失败构造器(<code>init!</code>),该可失败构造器将会构建一个对应类型的隐式解包可选类型的对象.</p>
<h2 id="必要构造器"><a href="#必要构造器" class="headerlink" title="必要构造器"></a>必要构造器</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SomeClass</span> </span>&#123;</span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>() &#123; <span class="comment">// 在类的构造器前添加required修饰符表明所有该类的子类都必须实现该构造器</span></span><br><span class="line">             </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SomeSubclass</span>: <span class="title">SomeClass</span> </span>&#123;</span><br><span class="line">    <span class="keyword">required</span> <span class="keyword">init</span>() &#123;</span><br><span class="line">                </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NewSomeSubclass</span>: <span class="title">SomeClass</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 如果子类继承的构造器能满足必要构造器的要求,测无需再子类中显式提供必要构造器的实现</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="通过闭包或函数设置属性的默认值"><a href="#通过闭包或函数设置属性的默认值" class="headerlink" title="通过闭包或函数设置属性的默认值"></a>通过闭包或函数设置属性的默认值</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Checkerboard</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> boardColors: [<span class="type">Bool</span>] = &#123;</span><br><span class="line">        <span class="keyword">var</span> temporaryBoard = [<span class="type">Bool</span>]()</span><br><span class="line">        <span class="keyword">var</span> isBlack = <span class="literal">false</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>...<span class="number">10</span> &#123;</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="number">1</span>...<span class="number">10</span> &#123;</span><br><span class="line">                temporaryBoard.append(isBlack)</span><br><span class="line">                isBlack = !isBlack</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">print</span>(temporaryBoard)</span><br><span class="line">        <span class="keyword">return</span> temporaryBoard</span><br><span class="line">    &#125;()</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">squareIsBlackAtRow</span><span class="params">(row: Int, column: Int)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> boardColors[(row * <span class="number">10</span>) + column]</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> board = <span class="type">Checkerboard</span>()</span><br><span class="line"><span class="built_in">print</span>(board.squareIsBlackAtRow(<span class="number">0</span>, column: <span class="number">1</span>))</span><br><span class="line"><span class="built_in">print</span>(board.squareIsBlackAtRow(<span class="number">9</span>, column: <span class="number">8</span>))</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/03/13/Swift_十二_继承/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZeroJi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZeroJi's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/03/13/Swift_十二_继承/" itemprop="url">Swift (十二) 继承</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-03-13T07:30:00+08:00">
                2016-03-13
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-04-28T17:04:57+08:00">
                2018-04-28
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="定义一个基类"><a href="#定义一个基类" class="headerlink" title="定义一个基类"></a>定义一个基类</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vehicle</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> currentSpeed = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">var</span> description &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"traveling at \(currentSpeed) miles per hour"</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">makNoise</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="comment">// 什么也不做</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> someVehicle = <span class="type">Vehicle</span>()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Vehicle: \(someVehicle.description"</span>)</span><br></pre></td></tr></table></figure>
<h2 id="子类生成"><a href="#子类生成" class="headerlink" title="子类生成"></a>子类生成</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Biycle</span>: <span class="title">Bicycle</span>: <span class="title">Vehicle</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> hasBasket = <span class="literal">false</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> bicycle = <span class="type">Bicycle</span>()</span><br><span class="line">bicycle.hasBasket = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line">bicycle.currentSpeed = <span class="number">15.0</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Bicycle: \(bicycle.description"</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tandem</span>: <span class="title">Bicycle</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> currentNumberOfPassengers = <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> tandem = <span class="type">Tandem</span>()</span><br><span class="line">tandem.hasBasket = <span class="literal">true</span></span><br><span class="line">tandem.currentNumberOfPassengers = <span class="number">2</span></span><br><span class="line">tandem.currentSpeed = <span class="number">22.0</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Tandem: \(tandem.description"</span>)</span><br></pre></td></tr></table></figure>
<h2 id="重写"><a href="#重写" class="headerlink" title="重写"></a>重写</h2><p>重写关键字<code>override</code>, 表明是想提供一个重写版本,而非错误地提供了一个相同的定义</p>
<h2 id="访问超类的方法-属性和下标"><a href="#访问超类的方法-属性和下标" class="headerlink" title="访问超类的方法,属性和下标"></a>访问超类的方法,属性和下标</h2><ul>
<li>在方法<code>someMethod()</code>的重写实现中,可以通过<code>super.someMethod()</code>来调用超类版本的<code>someMethod()</code>方法</li>
<li>在属性<code>someProperty</code>的<code>getter</code>和<code>setter</code>的重写实现中,可以通过<code>super.someProperty</code>来访问超类版本的<code>someProperty</code>属性</li>
<li>在下标重写实现中,可以通过<code>supr[someIndex]</code>来访问超类版本中的相同下标</li>
</ul>
<h2 id="重写方法"><a href="#重写方法" class="headerlink" title="重写方法"></a>重写方法</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Train</span>: <span class="title">Vehicle</span> </span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">makeNoise</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">"Choo Choo"</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> train = <span class="type">Train</span>()</span><br><span class="line">train.makeNoise()</span><br></pre></td></tr></table></figure>
<h2 id="重写属性"><a href="#重写属性" class="headerlink" title="重写属性"></a>重写属性</h2><p>1.重写属性的<code>getter</code>和<code>setter</code>,无论继承来的属性是存储属性还是计算属性,子类只知道继承来的属性会有一个名字和类型</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Car</span>: <span class="title">Vehicle</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> gear = <span class="number">1</span></span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">var</span> description: <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">super</span>.description + <span class="string">"in gear \(gear)"</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> car = <span class="type">Car</span>()</span><br><span class="line">car.currentSpeed = <span class="number">25.0</span></span><br><span class="line">car.gear = <span class="number">3</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"Car: \(car.description"</span>)</span><br></pre></td></tr></table></figure>
<p>2.重写属性观察器</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AutomaticCar</span>: <span class="title">Car</span> </span>&#123;</span><br><span class="line">    <span class="keyword">override</span> <span class="keyword">var</span> currentSpeed: <span class="type">Double</span> &#123;</span><br><span class="line">        <span class="keyword">didSet</span> &#123;</span><br><span class="line">            gear = <span class="type">Int</span>(currentSpeed / <span class="number">10.0</span>) + <span class="number">1</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> automatic = <span class="type">AutomaticCar</span>()</span><br><span class="line">automatic.currentSpeed = <span class="number">35.0</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"AutomaticCar: \(automatic.description"</span>)</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/03/13/Swift_十一_下标/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZeroJi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZeroJi's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/03/13/Swift_十一_下标/" itemprop="url">Swift (十一) 下标</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-03-13T06:54:00+08:00">
                2016-03-13
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-04-28T17:04:51+08:00">
                2018-04-28
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="下标语法"><a href="#下标语法" class="headerlink" title="下标语法"></a>下标语法</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">struct someStructer &#123;</span><br><span class="line">    subscript(index: Int) -&gt; Int &#123; // subscript 用来定义下标</span><br><span class="line">        get &#123;</span><br><span class="line">            return 1 // 返回一个适当的Int类型的值</span><br><span class="line">        &#125;</span><br><span class="line">        set(newValue) &#123;</span><br><span class="line">            // 执行适当的赋值操作</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">struct TimesTable &#123;</span><br><span class="line">    let multiplier: Int</span><br><span class="line">    subscript(index: Int) -&gt; Int &#123;</span><br><span class="line">        return multiplier * index</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">let threeTimesTable = TimesTable(multiplier: 3)</span><br><span class="line">print(&quot;six imtes three is \(threeTimesTable[6]&quot;)</span><br><span class="line"></span><br><span class="line">var numberOfLegs = [&quot;spider&quot;: 8, &quot;ant&quot;: 6, &quot;cat&quot;: 4]</span><br><span class="line">numberOfLegs[&quot;bird&quot;] = 2</span><br><span class="line">print(numberOfLegs)</span><br></pre></td></tr></table></figure>
<h2 id="下标选项"><a href="#下标选项" class="headerlink" title="下标选项"></a>下标选项</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Matrix</span> </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> rows: <span class="type">Int</span>, columns: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">var</span> grid: [<span class="type">Double</span>]</span><br><span class="line">    <span class="keyword">init</span>(rows: <span class="type">Int</span>, columns: <span class="type">Int</span>) &#123;</span><br><span class="line">        <span class="keyword">self</span>.rows = rows</span><br><span class="line">        <span class="keyword">self</span>.columns = columns</span><br><span class="line">        grid = <span class="type">Array</span>(<span class="built_in">count</span>: rows * columns, repeatedValue: <span class="number">0.0</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">indexIsvalidForRow</span><span class="params">(row: Int, column: Int)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> row &gt;= <span class="number">0</span> &amp;&amp; row &lt; rows &amp;&amp; column &gt;= <span class="number">0</span> &amp;&amp; column &lt; columns</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">subscript</span>(row: <span class="type">Int</span>, column: <span class="type">Int</span>) -&gt; <span class="type">Double</span> &#123;</span><br><span class="line">        <span class="keyword">get</span> &#123;</span><br><span class="line">            <span class="built_in">assert</span>(indexIsvalidForRow(row, column: column), <span class="string">"index out of range"</span>)</span><br><span class="line">            <span class="keyword">return</span> grid[(row * columns) + column]</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">set</span> &#123;</span><br><span class="line">            <span class="built_in">assert</span>(indexIsvalidForRow(row, column: column), <span class="string">"Index out of range"</span>)</span><br><span class="line">            grid[(row * columns) + column] = newValue</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> matrix = <span class="type">Matrix</span>(rows: <span class="number">2</span>, columns: <span class="number">2</span>)</span><br><span class="line">matrix[<span class="number">0</span>, <span class="number">1</span>] = <span class="number">1.5</span></span><br><span class="line">matrix[<span class="number">1</span>, <span class="number">0</span>] = <span class="number">3.2</span></span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2016/03/12/Swift_十_方法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="ZeroJi">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/icon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="ZeroJi's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2016/03/12/Swift_十_方法/" itemprop="url">Swift (十) 类和结构体</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-03-12T08:50:00+08:00">
                2016-03-12
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2018-04-28T17:04:49+08:00">
                2018-04-28
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="实例方法"><a href="#实例方法" class="headerlink" title="实例方法"></a>实例方法</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Counter</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="built_in">count</span> = <span class="number">0</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">increment</span><span class="params">()</span></span> &#123;</span><br><span class="line">        ++<span class="built_in">count</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">incrementBy</span><span class="params">(amount: Int)</span></span> &#123;</span><br><span class="line">        <span class="built_in">count</span> += amount</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">reset</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="built_in">count</span> = <span class="number">0</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> counter = <span class="type">Counter</span>()</span><br><span class="line">counter.increment()</span><br><span class="line">counter.incrementBy(<span class="number">5</span>)</span><br><span class="line">counter.reset()</span><br></pre></td></tr></table></figure>
<h2 id="方法的局部参数名称和外部参数名称"><a href="#方法的局部参数名称和外部参数名称" class="headerlink" title="方法的局部参数名称和外部参数名称"></a>方法的局部参数名称和外部参数名称</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">NewCounter</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="built_in">count</span>: <span class="type">Int</span> = <span class="number">0</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">incrementBy</span><span class="params">(amount: Int, numberOfTimes: Int)</span></span> &#123;</span><br><span class="line">        <span class="built_in">count</span> += amount * numberOfTimes</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> newCounter = <span class="type">NewCounter</span>()</span><br><span class="line">newCounter.incrementBy(<span class="number">5</span>, numberOfTimes: <span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<h2 id="self属性"><a href="#self属性" class="headerlink" title="self属性"></a>self属性</h2><p>用以区分参数名称和属性名称</p>
<p>self 等同于该实例本身</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Point</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> x = <span class="number">0.0</span>, y = <span class="number">0.0</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">isToTheRightOfX</span><span class="params">(x: Double)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>.x &gt; x</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> somePoint = <span class="type">Point</span>(x: <span class="number">4.0</span>, y: <span class="number">5.0</span>)</span><br><span class="line"><span class="keyword">if</span> somePoint.isToTheRightOfX(<span class="number">1.0</span>) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"This point is to the right of the line where x == 1.0"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="在结构体的实例方法中修改值"><a href="#在结构体的实例方法中修改值" class="headerlink" title="在结构体的实例方法中修改值"></a>在结构体的实例方法中修改值</h2><p>在这个方法做的任何改变都会在方法执行结束时写回到原始结构中</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NewPoint</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> x = <span class="number">0.0</span>, y = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">moveByX</span><span class="params">(deltaX: Double, y deltaY: Double)</span></span> &#123; <span class="comment">// 方法定义时加上了mutationg关键字,从而允许修改属性</span></span><br><span class="line">        x += deltaX</span><br><span class="line">        y += deltaY</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> someNewPoint = <span class="type">NewPoint</span>(x: <span class="number">1.0</span>, y: <span class="number">1.0</span>)</span><br><span class="line">someNewPoint.moveByX(<span class="number">2.0</span>, y: <span class="number">3.0</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"The point is now at (\(someNewPoint.x), \(someNewPoint.y))"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> fixedPoint = <span class="type">NewPoint</span>(x: <span class="number">3.0</span>, y: <span class="number">3.0</span>)</span><br><span class="line"><span class="comment">//fixedPoint.moveByX(2.0, y: 3.0) // 不能再结构体类型的常量上调用可变方法,因为其属性不能被修改,即时属性是变量属性</span></span><br></pre></td></tr></table></figure>
<h2 id="在可变方法中给self赋值"><a href="#在可变方法中给self赋值" class="headerlink" title="在可变方法中给self赋值"></a>在可变方法中给self赋值</h2><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">NewNewPoint</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> x = <span class="number">0.0</span>, y = <span class="number">0.0</span></span><br><span class="line">    <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">moveByX</span><span class="params">(deltaX: Double, deltaY: Double)</span></span> &#123;</span><br><span class="line">        <span class="keyword">self</span> = <span class="type">NewNewPoint</span>(x: x + deltaX, y: y + deltaY)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> someNewNewPoint = <span class="type">NewNewPoint</span>(x: <span class="number">1.0</span>, y: <span class="number">1.0</span>)</span><br><span class="line">someNewNewPoint.moveByX(<span class="number">2.0</span>, deltaY: <span class="number">3.0</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"The point is now at (\(someNewNewPoint.x), \(someNewNewPoint.y))"</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">TriStateSwitch</span> </span>&#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Off</span>, <span class="type">Low</span>, <span class="type">High</span></span><br><span class="line">    <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">next</span><span class="params">()</span></span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="type">Off</span> :</span><br><span class="line">            <span class="keyword">self</span> = <span class="type">Low</span></span><br><span class="line">        <span class="keyword">case</span> <span class="type">Low</span>:</span><br><span class="line">            <span class="keyword">self</span> = <span class="type">High</span></span><br><span class="line">        <span class="keyword">case</span> <span class="type">High</span>:</span><br><span class="line">            <span class="keyword">self</span> = <span class="type">Off</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> ovenLight = <span class="type">TriStateSwitch</span>.<span class="type">Low</span></span><br><span class="line">ovenLight.next()</span><br><span class="line">ovenLight.next()</span><br></pre></td></tr></table></figure>
<h2 id="类型方法"><a href="#类型方法" class="headerlink" title="类型方法"></a>类型方法</h2><p>类型方法中的self指向这个类型本身,而不是类型的实例</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">SomeClass</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">someTypeMethod</span><span class="params">()</span></span> &#123; <span class="comment">// static 定义类方法</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">SomeClass</span>.someTypeMethod() <span class="comment">// 类方法只能由类型来调用</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">LevelTracker</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> highestUnlockedLevel = <span class="number">1</span></span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">unlockLevel</span><span class="params">(level: Int)</span></span> &#123;</span><br><span class="line">        <span class="keyword">if</span> level &gt; highestUnlockedLevel &#123; highestUnlockedLevel = level  &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">levelIsUnlocked</span><span class="params">(level: Int)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> level &lt;= highestUnlockedLevel</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> currentLevel = <span class="number">1</span></span><br><span class="line">    <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">advanceToLevel</span><span class="params">(level: Int)</span></span> -&gt; <span class="type">Bool</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="type">LevelTracker</span>.levelIsUnlocked(level) &#123;</span><br><span class="line">            currentLevel = level</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Player</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> tracker = <span class="type">LevelTracker</span>()</span><br><span class="line">    <span class="keyword">let</span> playerName: <span class="type">String</span></span><br><span class="line">    <span class="function"><span class="keyword">func</span> <span class="title">completedLevel</span><span class="params">(level: Int)</span></span> &#123;</span><br><span class="line">        <span class="type">LevelTracker</span>.unlockLevel(level + <span class="number">1</span>)</span><br><span class="line">        tracker.advanceToLevel(level + <span class="number">1</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">init</span>(name: <span class="type">String</span>) &#123; <span class="comment">// 只要类中有属性没有初始化,必须调用初始化方法对其进行初始化</span></span><br><span class="line">        playerName = name</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> player = <span class="type">Player</span>(name: <span class="string">"Argyrios"</span>)</span><br><span class="line">player.completedLevel(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"highest unlocked level is now \(LevelTracker.highestUnlockedLevel)"</span>)</span><br><span class="line"></span><br><span class="line">player = <span class="type">Player</span>(name: <span class="string">"Beto"</span>)</span><br><span class="line"><span class="keyword">if</span> player.tracker.advanceToLevel(<span class="number">6</span>) &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"player is now on level 6"</span>)</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">"level 6 has not yet been unlocked"</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/2/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/4/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/icon.jpg"
                alt="ZeroJi" />
            
              <p class="site-author-name" itemprop="name">ZeroJi</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">49</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">6</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">ZeroJi</span>

  
</div>









        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=5.1.4"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.4"></script>


  

</body>
</html>
